Date :01/09/2023, 10:37:23
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Val metric mean prob: 0.0458
Best metric at epoch 1: 0.1429 0.1090 0.5468
Cf: [[4636   30]
 [  90   10]]
Model improve: 0.0000 -> 0.1429
Epoch: 2/30
Date :01/09/2023, 11:12:30
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Val metric mean prob: 0.0690
Best metric at epoch 1: 0.2360 0.1450 0.5905
Cf: [[4624   42]
 [  81   19]]
Model improve: 0.0000 -> 0.2360
Epoch: 2/30
Val metric mean prob: 0.1181
Best metric at epoch 2: 0.2951 0.1660 0.6684
Cf: [[4558  108]
 [  64   36]]
Model improve: 0.2360 -> 0.2951
Epoch: 3/30
Val metric mean prob: 0.1508
Best metric at epoch 3: 0.3058 0.2490 0.6737
Cf: [[4561  105]
 [  63   37]]
Model improve: 0.2951 -> 0.3058
Val metric mean prob: 0.1775
Best metric at epoch 4: 0.3780 0.3370 0.6515
Cf: [[4633   33]
 [  69   31]]
Model improve: 0.3058 -> 0.3780
Epoch: 5/30
Val metric mean prob: 0.1798
Best metric at epoch 5: 0.3594 0.3820 0.6145
Cf: [[4661    5]
 [  77   23]]
Epoch: 6/30
Date :01/09/2023, 15:11:10
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Train loss:0.1720, Valid loss:0.1059
Val metric mean prob: 0.0347
Best metric at epoch 1: 0.0000 0.0000 0.0000
Cf: None
Epoch: 2/30
Train loss:0.1341, Valid loss:0.1000
Val metric mean prob: 0.0257
Best metric at epoch 2: 0.0000 0.0000 0.0000
Cf: None
Epoch: 3/30
Train loss:0.1291, Valid loss:0.0965
Val metric mean prob: 0.0342
Best metric at epoch 3: 0.0000 0.0000 0.0000
Cf: None
Epoch: 4/30
Train loss:0.1265, Valid loss:0.0941
Val metric mean prob: 0.0498
Best metric at epoch 4: 0.1549 0.1080 0.5517
Cf: [[4635   31]
 [  89   11]]
Model improve: 0.0000 -> 0.1549
Epoch: 5/30
Train loss:0.1187, Valid loss:0.0947
Val metric mean prob: 0.1036
Best metric at epoch 5: 0.2675 0.2290 0.6011
Cf: [[4630   36]
 [  79   21]]
Model improve: 0.1549 -> 0.2675
Epoch: 6/30
Train loss:0.1089, Valid loss:0.0921
Val metric mean prob: 0.1269
Best metric at epoch 6: 0.2722 0.2480 0.6101
Cf: [[4620   46]
 [  77   23]]
Model improve: 0.2675 -> 0.2722
Epoch: 7/30
Train loss:0.1083, Valid loss:0.0888
Val metric mean prob: 0.1375
Best metric at epoch 7: 0.2743 0.1260 0.6448
Cf: [[4571   95]
 [  69   31]]
Model improve: 0.2722 -> 0.2743
Epoch: 8/30
Train loss:0.1055, Valid loss:0.0896
Val metric mean prob: 0.1377
Best metric at epoch 8: 0.3069 0.1310 0.6386
Cf: [[4606   60]
 [  71   29]]
Model improve: 0.2743 -> 0.3069
Epoch: 9/30
Train loss:0.1001, Valid loss:0.0875
Val metric mean prob: 0.1448
Best metric at epoch 9: 0.2946 0.2110 0.5939
Cf: [[4656   10]
 [  81   19]]
Epoch: 10/30
Train loss:0.0943, Valid loss:0.1020
Val metric mean prob: 0.1696
Best metric at epoch 10: 0.3188 0.3290 0.6571
Cf: [[4592   74]
 [  67   33]]
Model improve: 0.3069 -> 0.3188
Epoch: 11/30
Train loss:0.0934, Valid loss:0.0907
Val metric mean prob: 0.1695
Best metric at epoch 11: 0.3117 0.3130 0.6168
Cf: [[4636   30]
 [  76   24]]
Epoch: 12/30
Train loss:0.0883, Valid loss:0.0915
Val metric mean prob: 0.1862
Best metric at epoch 12: 0.3364 0.1750 0.6761
Cf: [[4583   83]
 [  63   37]]
Model improve: 0.3188 -> 0.3364
Epoch: 13/30
Train loss:0.0866, Valid loss:0.0879
Val metric mean prob: 0.1780
Best metric at epoch 13: 0.3482 0.1670 0.6859
Cf: [[4581   85]
 [  61   39]]
Model improve: 0.3364 -> 0.3482
Epoch: 14/30
Date :01/09/2023, 22:37:59
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/10/2023, 00:01:52
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/10/2023, 00:12:03
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Train loss:0.1918, Valid loss:0.1063
Val metric mean prob: 0.0399
Best metric at epoch 1: 0.0923 0.1020 0.5358
Cf: [[4580   86]
 [  91    9]]
Model improve: 0.0000 -> 0.0923
Epoch: 2/30
Train loss:0.1604, Valid loss:0.1016
Val metric mean prob: 0.0868
Best metric at epoch 2: 0.2595 0.2190 0.6135
Cf: [[4605   61]
 [  76   24]]
Model improve: 0.0923 -> 0.2595
Epoch: 3/30
Train loss:0.1462, Valid loss:0.0930
Val metric mean prob: 0.1525
Best metric at epoch 3: 0.3220 0.2090 0.6795
Cf: [[4568   98]
 [  62   38]]
Model improve: 0.2595 -> 0.3220
Epoch: 4/30
Train loss:0.1369, Valid loss:0.0942
Val metric mean prob: 0.1398
Best metric at epoch 4: 0.3114 0.2980 0.6256
Cf: [[4625   41]
 [  74   26]]
Epoch: 5/30
Train loss:0.1252, Valid loss:0.0876
Val metric mean prob: 0.1606
Best metric at epoch 5: 0.3600 0.2290 0.6731
Cf: [[4602   64]
 [  64   36]]
Model improve: 0.3220 -> 0.3600
Epoch: 6/30
Train loss:0.1174, Valid loss:0.0889
Val metric mean prob: 0.1803
Best metric at epoch 6: 0.3649 0.3110 0.6327
Cf: [[4645   21]
 [  73   27]]
Model improve: 0.3600 -> 0.3649
Epoch: 7/30
Train loss:0.1102, Valid loss:0.0927
Val metric mean prob: 0.1663
Best metric at epoch 7: 0.3133 0.1510 0.6832
Cf: [[4556  110]
 [  61   39]]
Epoch: 8/30
Date :01/10/2023, 04:20:38
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :30
Epoch: 1/30
Train loss:0.2087, Valid loss:0.0992
Val metric mean prob: 0.0406
Best metric at epoch 1: 0.1270 0.1010 0.5381
Cf: [[4648   18]
 [  92    8]]
Model improve: 0.0000 -> 0.1270
Epoch: 2/30
Train loss:0.1516, Valid loss:0.0887
Val metric mean prob: 0.1097
Best metric at epoch 2: 0.3007 0.1930 0.6118
Cf: [[4636   30]
 [  77   23]]
Model improve: 0.1270 -> 0.3007
Epoch: 3/30
Train loss:0.1347, Valid loss:0.1108
Val metric mean prob: 0.1598
Best metric at epoch 3: 0.3953 0.4150 0.6659
Cf: [[4628   38]
 [  66   34]]
Model improve: 0.3007 -> 0.3953
Epoch: 4/30
Train loss:0.1214, Valid loss:0.0860
Val metric mean prob: 0.1786
Best metric at epoch 4: 0.3830 0.2450 0.6744
Cf: [[4614   52]
 [  64   36]]
Epoch: 5/30
Train loss:0.1088, Valid loss:0.0841
Val metric mean prob: 0.1921
Best metric at epoch 5: 0.3602 0.2760 0.6416
Cf: [[4634   32]
 [  71   29]]
Epoch: 6/30
Train loss:0.0970, Valid loss:0.0878
Val metric mean prob: 0.2121
Best metric at epoch 6: 0.4316 0.2170 0.6997
Cf: [[4617   49]
 [  59   41]]
Model improve: 0.3953 -> 0.4316
Epoch: 7/30
Train loss:0.0838, Valid loss:0.0957
Val metric mean prob: 0.2311
Best metric at epoch 7: 0.3895 0.2220 0.6793
Cf: [[4613   53]
 [  63   37]]
Epoch: 8/30
Train loss:0.0742, Valid loss:0.1096
Val metric mean prob: 0.2116
Best metric at epoch 8: 0.3455 0.2500 0.6588
Cf: [[4608   58]
 [  67   33]]
Epoch: 9/30
Date :01/10/2023, 07:41:44
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Train loss:0.2085, Valid loss:0.1010
Val metric mean prob: 0.0449
Best metric at epoch 1: 0.1679 0.1340 0.5529
Cf: [[4646   20]
 [  89   11]]
Model improve: 0.0000 -> 0.1679
Epoch: 2/30
Train loss:0.1528, Valid loss:0.0880
Val metric mean prob: 0.0980
Best metric at epoch 2: 0.3182 0.1280 0.6349
Cf: [[4618   48]
 [  72   28]]
Model improve: 0.1679 -> 0.3182
Epoch: 3/30
Train loss:0.1358, Valid loss:0.0993
Val metric mean prob: 0.1700
Best metric at epoch 3: 0.3404 0.3470 0.6540
Cf: [[4610   56]
 [  68   32]]
Model improve: 0.3182 -> 0.3404
Epoch: 4/30
Train loss:0.1248, Valid loss:0.0886
Val metric mean prob: 0.1700
Best metric at epoch 4: 0.3492 0.1840 0.7084
Cf: [[4558  108]
 [  56   44]]
Model improve: 0.3404 -> 0.3492
Epoch: 5/30
Train loss:0.1107, Valid loss:0.0852
Val metric mean prob: 0.2046
Best metric at epoch 5: 0.4046 0.2500 0.6709
Cf: [[4628   38]
 [  65   35]]
Model improve: 0.3492 -> 0.4046
Epoch: 6/30
Date :01/10/2023, 15:23:21
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 5)),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 5), sigma_limit=(0, 0)),
    GaussNoise(always_apply=False, p=0.5, var_limit=(5.0, 30.0), per_channel=True, mean=0),
  ], p=0.7),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.7),
  CLAHE(always_apply=False, p=0.7, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAAPiecewiseAffine(always_apply=False, p=0.2, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  RandomGamma(always_apply=False, p=0.3, gamma_limit=(70, 130), eps=None),
  RandomBrightnessContrast(always_apply=False, p=0.75, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  OneOf([
    ImageCompression(always_apply=False, p=0.5, quality_lower=99, quality_upper=100, compression_type=0),
    Downscale(always_apply=False, p=0.5, scale_min=0.7, scale_max=0.95),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Date :01/10/2023, 15:24:07
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 5)),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 5), sigma_limit=(0, 0)),
    GaussNoise(always_apply=False, p=0.5, var_limit=(5.0, 30.0), per_channel=True, mean=0),
  ], p=0.7),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.7),
  CLAHE(always_apply=False, p=0.7, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAAPiecewiseAffine(always_apply=False, p=0.2, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  RandomGamma(always_apply=False, p=0.3, gamma_limit=(70, 130), eps=None),
  RandomBrightnessContrast(always_apply=False, p=0.75, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  OneOf([
    ImageCompression(always_apply=False, p=0.5, quality_lower=99, quality_upper=100, compression_type=0),
    Downscale(always_apply=False, p=0.5, scale_min=0.7, scale_max=0.95),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Date :01/10/2023, 15:24:25
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 5)),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 5), sigma_limit=(0, 0)),
    GaussNoise(always_apply=False, p=0.5, var_limit=(5.0, 30.0), per_channel=True, mean=0),
  ], p=0.7),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.7),
  CLAHE(always_apply=False, p=0.7, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAAPiecewiseAffine(always_apply=False, p=0.2, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  RandomGamma(always_apply=False, p=0.3, gamma_limit=(70, 130), eps=None),
  RandomBrightnessContrast(always_apply=False, p=0.75, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  OneOf([
    ImageCompression(always_apply=False, p=0.5, quality_lower=99, quality_upper=100, compression_type=0),
    Downscale(always_apply=False, p=0.5, scale_min=0.7, scale_max=0.95),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/10/2023, 15:26:36
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  HueSaturationValue(always_apply=False, p=0.7, hue_shift_limit=(-10, 10), sat_shift_limit=(-10, 10), val_shift_limit=(-10, 10)),
  RandomBrightnessContrast(always_apply=False, p=0.7, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4), tile_grid_size=(8, 8)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  OneOf([
    JpegCompression(always_apply=False, p=0.5, quality_lower=99, quality_upper=100),
    Downscale(always_apply=False, p=0.5, scale_min=0.1, scale_max=0.15),
  ], p=0.2),
  IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Date :01/10/2023, 15:27:12
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  HueSaturationValue(always_apply=False, p=0.7, hue_shift_limit=(-10, 10), sat_shift_limit=(-10, 10), val_shift_limit=(-10, 10)),
  RandomBrightnessContrast(always_apply=False, p=0.7, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4), tile_grid_size=(8, 8)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  OneOf([
    JpegCompression(always_apply=False, p=0.5, quality_lower=99, quality_upper=100),
    Downscale(always_apply=False, p=0.5, scale_min=0.1, scale_max=0.15),
  ], p=0.2),
  IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Date :01/10/2023, 15:28:58
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  HueSaturationValue(always_apply=False, p=0.7, hue_shift_limit=(-10, 10), sat_shift_limit=(-10, 10), val_shift_limit=(-10, 10)),
  RandomBrightnessContrast(always_apply=False, p=0.7, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4), tile_grid_size=(8, 8)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Date :01/10/2023, 15:32:38
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  HueSaturationValue(always_apply=False, p=0.7, hue_shift_limit=(-10, 10), sat_shift_limit=(-10, 10), val_shift_limit=(-10, 10)),
  RandomBrightnessContrast(always_apply=False, p=0.7, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4), tile_grid_size=(8, 8)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Fold: 0
Len train df: 300
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Train loss:0.6311, Valid loss:0.5413
Val metric mean prob: 0.0730
Best metric at epoch 1: 0.0730 0.1010 0.5000
Cf: [[  0 127]
 [  0   5]]
Model improve: 0.0000 -> 0.0730
Epoch: 2/10
Train loss:0.3895, Valid loss:0.2399
Val metric mean prob: 0.0730
Best metric at epoch 2: 0.0730 0.1010 0.5000
Cf: [[  0 127]
 [  0   5]]
Epoch: 3/10
Train loss:0.2022, Valid loss:0.1850
Val metric mean prob: 0.0730
Best metric at epoch 3: 0.0730 0.1010 0.5000
Cf: [[  0 127]
 [  0   5]]
Epoch: 4/10
Train loss:0.1519, Valid loss:0.1703
Val metric mean prob: 0.0730
Best metric at epoch 4: 0.0730 0.1010 0.5000
Cf: [[  0 127]
 [  0   5]]
Epoch: 5/10
Train loss:0.1881, Valid loss:0.1652
Val metric mean prob: 0.0730
Best metric at epoch 5: 0.0730 0.1010 0.5000
Cf: [[  0 127]
 [  0   5]]
Epoch: 6/10
Date :01/10/2023, 15:41:14
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  HueSaturationValue(always_apply=False, p=0.7, hue_shift_limit=(-10, 10), sat_shift_limit=(-10, 10), val_shift_limit=(-10, 10)),
  RandomBrightnessContrast(always_apply=False, p=0.7, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4), tile_grid_size=(8, 8)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  OneOf([
    JpegCompression(always_apply=False, p=0.5, quality_lower=99, quality_upper=100),
    Downscale(always_apply=False, p=0.5, scale_min=0.1, scale_max=0.15),
  ], p=0.2),
  IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Date :01/10/2023, 15:43:24
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  HueSaturationValue(always_apply=False, p=0.7, hue_shift_limit=(-10, 10), sat_shift_limit=(-10, 10), val_shift_limit=(-10, 10)),
  RandomBrightnessContrast(always_apply=False, p=0.7, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4), tile_grid_size=(8, 8)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Date :01/10/2023, 15:44:19
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  HueSaturationValue(always_apply=False, p=0.7, hue_shift_limit=(-10, 10), sat_shift_limit=(-10, 10), val_shift_limit=(-10, 10)),
  RandomBrightnessContrast(always_apply=False, p=0.7, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4), tile_grid_size=(8, 8)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Train loss:0.1912, Valid loss:0.1049
Val metric mean prob: 0.0411
Best metric at epoch 1: 0.0411 0.1010 0.5000
Cf: [[   0 4666]
 [   0  100]]
Model improve: 0.0000 -> 0.0411
Epoch: 2/10
Train loss:0.1276, Valid loss:0.0947
Val metric mean prob: 0.0411
Best metric at epoch 2: 0.0411 0.1010 0.5000
Cf: [[   0 4666]
 [   0  100]]
Epoch: 3/10
Train loss:0.1226, Valid loss:0.0865
Val metric mean prob: 0.0411
Best metric at epoch 3: 0.0411 0.1010 0.5000
Cf: [[   0 4666]
 [   0  100]]
Epoch: 4/10
Train loss:0.1142, Valid loss:0.0951
Val metric mean prob: 0.0411
Best metric at epoch 4: 0.0411 0.1010 0.5000
Cf: [[   0 4666]
 [   0  100]]
Epoch: 5/10
Train loss:0.1018, Valid loss:0.0895
Val metric mean prob: 0.0411
Best metric at epoch 5: 0.0411 0.1010 0.5000
Cf: [[   0 4666]
 [   0  100]]
Epoch: 6/10
Train loss:0.0956, Valid loss:0.0913
Val metric mean prob: 0.0411
Best metric at epoch 6: 0.0411 0.1010 0.5000
Cf: [[   0 4666]
 [   0  100]]
Epoch: 7/10
Train loss:0.0877, Valid loss:0.1011
Val metric mean prob: 0.0411
Best metric at epoch 7: 0.0411 0.1010 0.5000
Cf: [[   0 4666]
 [   0  100]]
Epoch: 8/10
Train loss:0.0823, Valid loss:0.0968
Val metric mean prob: 0.0411
Best metric at epoch 8: 0.0411 0.1010 0.5000
Cf: [[   0 4666]
 [   0  100]]
Epoch: 9/10
Date :01/10/2023, 23:44:11
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  HueSaturationValue(always_apply=False, p=0.7, hue_shift_limit=(-10, 10), sat_shift_limit=(-10, 10), val_shift_limit=(-10, 10)),
  RandomBrightnessContrast(always_apply=False, p=0.7, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4), tile_grid_size=(8, 8)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Date :01/10/2023, 23:45:18
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  HueSaturationValue(always_apply=False, p=0.7, hue_shift_limit=(-10, 10), sat_shift_limit=(-10, 10), val_shift_limit=(-10, 10)),
  RandomBrightnessContrast(always_apply=False, p=0.7, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4), tile_grid_size=(8, 8)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Valid loss:0.0968
Val metric mean prob: 0.1959
Best metric at epoch 1: 0.3314 0.2600 0.6401
Cf: [[4620   46]
 [  71   29]]
Model improve: 0.0000 -> 0.3314
Epoch: 2/10
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Valid loss:0.1011
Val metric mean prob: 0.1819
Best metric at epoch 1: 0.3086 0.3750 0.6210
Cf: [[4629   37]
 [  75   25]]
Model improve: 0.0000 -> 0.3086
Epoch: 2/10
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Valid loss:0.0913
Val metric mean prob: 0.1782
Best metric at epoch 1: 0.3300 0.1990 0.6578
Cf: [[4599   67]
 [  67   33]]
Model improve: 0.0000 -> 0.3300
Epoch: 2/10
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Valid loss:0.0951
Val metric mean prob: 0.1266
Best metric at epoch 1: 0.2874 0.2940 0.6154
Cf: [[4623   43]
 [  76   24]]
Model improve: 0.0000 -> 0.2874
Epoch: 2/10
Date :01/11/2023, 00:06:36
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Date :01/11/2023, 00:07:17
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :13
Epoch: 1/13
Valid loss:0.1008
Val metric mean prob: 0.0473
Best metric at epoch 1: 0.2031 0.1120 0.5634
Cf: [[4651   15]
 [  87   13]]
Model improve: 0.0000 -> 0.2031
Epoch: 2/13
Valid loss:0.0980
Val metric mean prob: 0.0709
Best metric at epoch 2: 0.2954 0.1180 0.6641
Cf: [[4564  102]
 [  65   35]]
Model improve: 0.2031 -> 0.2954
Epoch: 3/13
Valid loss:0.0916
Val metric mean prob: 0.1233
Best metric at epoch 3: 0.2915 0.1940 0.6375
Cf: [[4596   70]
 [  71   29]]
Epoch: 4/13
Valid loss:0.1240
Val metric mean prob: 0.1410
Best metric at epoch 4: 0.3033 0.3950 0.6735
Cf: [[4559  107]
 [  63   37]]
Model improve: 0.2954 -> 0.3033
Epoch: 5/13
Valid loss:0.0954
Val metric mean prob: 0.1667
Best metric at epoch 5: 0.3636 0.3710 0.6462
Cf: [[4631   35]
 [  70   30]]
Model improve: 0.3033 -> 0.3636
Epoch: 6/13
Valid loss:0.1239
Val metric mean prob: 0.1847
Best metric at epoch 6: 0.3716 0.4810 0.6647
Cf: [[4617   49]
 [  66   34]]
Model improve: 0.3636 -> 0.3716
Epoch: 7/13
Valid loss:0.1026
Val metric mean prob: 0.1768
Best metric at epoch 7: 0.3407 0.3780 0.6495
Cf: [[4615   51]
 [  69   31]]
Epoch: 8/13
Valid loss:0.0983
Val metric mean prob: 0.2139
Best metric at epoch 8: 0.3883 0.2740 0.6929
Cf: [[4600   66]
 [  60   40]]
Model improve: 0.3716 -> 0.3883
Epoch: 9/13
Date :01/11/2023, 07:08:21
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Valid loss:0.1395
Val metric mean prob: 0.0254
Best metric at epoch 1: 0.0173 0.1050 0.4670
Cf: [[4078  588]
 [  94    6]]
Model improve: 0.0000 -> 0.0173
Epoch: 2/30
Valid loss:0.0965
Val metric mean prob: 0.0913
Best metric at epoch 2: 0.1966 0.1430 0.6031
Cf: [[4555  111]
 [  77   23]]
Model improve: 0.0173 -> 0.1966
Epoch: 3/30
Valid loss:0.0906
Val metric mean prob: 0.0815
Best metric at epoch 3: 0.2252 0.1050 0.5814
Cf: [[4632   34]
 [  83   17]]
Model improve: 0.1966 -> 0.2252
Epoch: 4/30
Valid loss:0.0880
Val metric mean prob: 0.1617
Best metric at epoch 4: 0.3431 0.2000 0.6676
Cf: [[4597   69]
 [  65   35]]
Model improve: 0.2252 -> 0.3431
Epoch: 5/30
Valid loss:0.0908
Val metric mean prob: 0.1717
Best metric at epoch 5: 0.3459 0.2730 0.6543
Cf: [[4613   53]
 [  68   32]]
Model improve: 0.3431 -> 0.3459
Epoch: 6/30
Valid loss:0.0898
Val metric mean prob: 0.1943
Best metric at epoch 6: 0.3804 0.2280 0.6697
Cf: [[4617   49]
 [  65   35]]
Model improve: 0.3459 -> 0.3804
Epoch: 7/30
Valid loss:0.1005
Val metric mean prob: 0.1868
Best metric at epoch 7: 0.3433 0.4740 0.6138
Cf: [[4655   11]
 [  77   23]]
Epoch: 8/30
Date :01/11/2023, 15:46:53
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 1e-05
    lr: 1e-05
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :30
Epoch: 1/30
Date :01/11/2023, 15:48:49
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 12
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 1e-05
    lr: 1e-05
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :30
Epoch: 1/30
Fold: 0
Len train df: 43727
Train bs: 12
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 1e-05
    lr: 1e-05
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :30
Epoch: 1/30
Fold: 0
Len train df: 43727
Train bs: 12
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 1e-05
    lr: 1e-05
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :30
Epoch: 1/30
Valid loss:0.1112
Val metric mean prob: 0.0292
Best metric at epoch 1: 0.0000 0.0000 0.0000
Cf: None
Epoch: 2/30
Valid loss:0.1034
Val metric mean prob: 0.0273
Best metric at epoch 2: 0.0000 0.0000 0.0000
Cf: None
Epoch: 3/30
Valid loss:0.1117
Val metric mean prob: 0.0302
Best metric at epoch 3: 0.0000 0.0000 0.0000
Cf: None
Epoch: 4/30
Valid loss:0.1144
Val metric mean prob: 0.0325
Best metric at epoch 4: 0.0175 0.1030 0.5036
Cf: [[4653   13]
 [  99    1]]
Model improve: 0.0000 -> 0.0175
Epoch: 5/30
Valid loss:0.1089
Val metric mean prob: 0.0276
Best metric at epoch 5: 0.0000 0.0000 0.0000
Cf: None
Epoch: 6/30
Valid loss:0.1093
Val metric mean prob: 0.0320
Best metric at epoch 6: 0.0000 0.0000 0.0000
Cf: None
Epoch: 7/30
Valid loss:0.1099
Val metric mean prob: 0.0292
Best metric at epoch 7: 0.0000 0.0000 0.0000
Cf: None
Epoch: 8/30
Valid loss:0.1112
Val metric mean prob: 0.0302
Best metric at epoch 8: 0.0000 0.0000 0.0000
Cf: None
Epoch: 9/30
Date :01/12/2023, 00:00:27
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 2000
Train bs: 12
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 1e-05
    lr: 1e-05
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :30
Epoch: 1/30
Valid loss:0.2887
Val metric mean prob: 0.0600
Best metric at epoch 1: 0.0769 0.1950 0.5260
Cf: [[32 95]
 [ 1  4]]
Model improve: 0.0000 -> 0.0769
Epoch: 2/30
Fold: 0
Len train df: 200
Train bs: 12
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 1e-05
    lr: 1e-05
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :30
Epoch: 1/30
Valid loss:0.6155
Val metric mean prob: 0.0705
Best metric at epoch 1: 0.1017 0.4600 0.5992
Cf: [[76 51]
 [ 2  3]]
Model improve: 0.0000 -> 0.1017
Epoch: 2/30
Valid loss:0.5517
Val metric mean prob: 0.0691
Best metric at epoch 2: 0.0862 0.3990 0.5827
Cf: [[ 21 106]
 [  0   5]]
Epoch: 3/30
Valid loss:0.2682
Val metric mean prob: 0.0529
Best metric at epoch 3: 0.0746 0.1260 0.5118
Cf: [[  3 124]
 [  0   5]]
Epoch: 4/30
Valid loss:0.1969
Val metric mean prob: 0.0408
Best metric at epoch 4: 0.0000 0.0000 0.0000
Cf: None
Epoch: 5/30
Fold: 0
Len train df: 200
Train bs: 12
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 1e-05
    lr: 1e-05
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :30
Epoch: 2/30
Valid loss:0.6155
Val metric mean prob: 0.0705
Best metric at epoch 2: 0.1017 0.4600 0.5992
Cf: [[76 51]
 [ 2  3]]
Model improve: 0.0000 -> 0.1017
Epoch: 3/30
Valid loss:0.5517
Val metric mean prob: 0.0691
Best metric at epoch 3: 0.0862 0.3990 0.5827
Cf: [[ 21 106]
 [  0   5]]
Epoch: 4/30
Valid loss:0.2682
Val metric mean prob: 0.0529
Best metric at epoch 4: 0.0746 0.1260 0.5118
Cf: [[  3 124]
 [  0   5]]
Epoch: 5/30
Valid loss:0.1969
Val metric mean prob: 0.0408
Best metric at epoch 5: 0.0000 0.0000 0.0000
Cf: None
Epoch: 6/30
Date :01/12/2023, 00:09:32
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 200
Train bs: 12
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :10
Epoch: 2/10
Date :01/12/2023, 00:09:59
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 12
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :10
Epoch: 2/10
Date :01/12/2023, 00:12:54
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 12
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :10
Epoch: 1/10
Date :01/12/2023, 00:13:32
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 12
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :10
Epoch: 1/10
Valid loss:0.1918
Val metric mean prob: 0.0433
Best metric at epoch 1: 0.0593 0.2390 0.5421
Cf: [[4079  587]
 [  79   21]]
Model improve: 0.0000 -> 0.0593
Epoch: 2/10
Valid loss:0.1053
Val metric mean prob: 0.0257
Best metric at epoch 2: 0.0000 0.0000 0.0000
Cf: None
Epoch: 3/10
Valid loss:0.1030
Val metric mean prob: 0.0261
Best metric at epoch 3: 0.0000 0.0000 0.0000
Cf: None
Epoch: 4/10
Fold: 0
Len train df: 43727
Train bs: 12
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :10
Epoch: 1/10
Valid loss:0.1030
Val metric mean prob: 0.0261
Best metric at epoch 1: 0.0690 0.0360 0.5708
Cf: [[3927  739]
 [  70   30]]
Model improve: 0.0000 -> 0.0690
Epoch: 2/10
Date :01/12/2023, 03:31:33
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 12
optimizer: AdamP (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0
    nesterov: False
    wd_ratio: 0.1
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Fold: 1
Len train df: 43827
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Date :01/12/2023, 03:45:25
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.003
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Date :01/12/2023, 03:48:24
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: SAM (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0
    nesterov: True
    rho: 0.05
    wd_ratio: 0.1
    weight_decay: 0.0
)
total_epoch :10
Epoch: 1/10
Valid loss:0.1969
Val metric mean prob: 0.0385
Best metric at epoch 1: 0.0715 0.1630 0.5552
Cf: [[4171  491]
 [  80   22]]
Model improve: 0.0000 -> 0.0715
Epoch: 2/10
Valid loss:0.5435
Val metric mean prob: 0.0376
Best metric at epoch 2: 0.0438 0.7890 0.5119
Cf: [[4362  300]
 [  93    9]]
Epoch: 3/10
Valid loss:0.1541
Val metric mean prob: 0.0278
Best metric at epoch 3: 0.0623 0.0410 0.5735
Cf: [[3519 1143]
 [  62   40]]
Epoch: 4/10
Valid loss:0.1260
Val metric mean prob: 0.0341
Best metric at epoch 4: 0.0676 0.0800 0.5293
Cf: [[4478  184]
 [  92   10]]
Epoch: 5/10
Date :01/12/2023, 07:44:06
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Fold: 1
Len train df: 1000
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    swa_lr: 0.0001
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Valid loss:0.1112
Val metric mean prob: 0.0277
Best metric at epoch 1: 0.0625 0.0570 0.5547
Cf: [[97 28]
 [ 2  1]]
Model improve: 0.0000 -> 0.0625
Epoch: 2/10
Valid loss:1.5841
Val metric mean prob: 0.0376
Best metric at epoch 2: 0.1000 0.9040 0.6027
Cf: [[109  16]
 [  2   1]]
Model improve: 0.0625 -> 0.1000
Epoch: 3/10
Valid loss:2.7723
Val metric mean prob: 0.0371
Best metric at epoch 3: 0.1429 0.9840 0.6267
Cf: [[115  10]
 [  2   1]]
Model improve: 0.1000 -> 0.1429
Epoch: 4/10
Valid loss:0.2120
Val metric mean prob: 0.0400
Best metric at epoch 4: 0.0619 0.1450 0.6360
Cf: [[34 91]
 [ 0  3]]
Epoch: 5/10
Valid loss:0.1415
Val metric mean prob: 0.0313
Best metric at epoch 5: 0.0566 0.0440 0.6000
Cf: [[ 25 100]
 [  0   3]]
Epoch: 6/10
Fold: 1
Len train df: 100
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0001
    maximize: False
    swa_lr: 0.0001
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Valid loss:0.6048
Val metric mean prob: 0.0446
Best metric at epoch 1: 0.0952 0.4720 0.5987
Cf: [[108  17]
 [  2   1]]
Model improve: 0.0000 -> 0.0952
Epoch: 2/10
Valid loss:0.6452
Val metric mean prob: 0.0441
Best metric at epoch 2: 0.0714 0.4890 0.5707
Cf: [[101  24]
 [  2   1]]
Epoch: 3/10
Valid loss:0.6009
Val metric mean prob: 0.0442
Best metric at epoch 3: 0.0690 0.4650 0.5667
Cf: [[100  25]
 [  2   1]]
Epoch: 4/10
Fold: 1
Len train df: 100
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0001
    maximize: False
    swa_lr: 0.0001
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Valid loss:0.6048
Val metric mean prob: 0.0446
Best metric at epoch 1: 0.0952 0.4720 0.5987
Cf: [[108  17]
 [  2   1]]
Model improve: 0.0000 -> 0.0952
Epoch: 2/10
Valid loss:0.4196
Val metric mean prob: 0.0437
Best metric at epoch 2: 0.2222 0.3850 0.6467
Cf: [[120   5]
 [  2   1]]
Model improve: 0.0952 -> 0.2222
Epoch: 3/10
Valid loss:0.2652
Val metric mean prob: 0.0434
Best metric at epoch 3: 0.2500 0.2850 0.6507
Cf: [[121   4]
 [  2   1]]
Model improve: 0.2222 -> 0.2500
Epoch: 4/10
Valid loss:0.1840
Val metric mean prob: 0.0413
Best metric at epoch 4: 0.2000 0.1700 0.6427
Cf: [[119   6]
 [  2   1]]
Epoch: 5/10
Valid loss:0.1461
Val metric mean prob: 0.0381
Best metric at epoch 5: 0.0800 0.0920 0.7240
Cf: [[56 69]
 [ 0  3]]
Epoch: 6/10
Valid loss:0.1412
Val metric mean prob: 0.0377
Best metric at epoch 6: 0.1000 0.0980 0.6933
Cf: [[90 35]
 [ 1  2]]
Epoch: 7/10
Valid loss:0.1347
Val metric mean prob: 0.0368
Best metric at epoch 7: 0.1000 0.0880 0.6933
Cf: [[90 35]
 [ 1  2]]
Epoch: 8/10
Valid loss:0.1269
Val metric mean prob: 0.0349
Best metric at epoch 8: 0.1000 0.0650 0.6933
Cf: [[90 35]
 [ 1  2]]
Epoch: 9/10
Date :01/12/2023, 07:56:58
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0001
    maximize: False
    swa_lr: 0.0001
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Valid loss:0.0952
Val metric mean prob: 0.0680
Best metric at epoch 1: 0.2400 0.1180 0.6221
Cf: [[4566   96]
 [  75   27]]
Model improve: 0.0000 -> 0.2400
Epoch: 2/10
Valid loss:0.0879
Val metric mean prob: 0.1156
Best metric at epoch 2: 0.2879 0.1170 0.6687
Cf: [[4544  118]
 [  65   37]]
Model improve: 0.2400 -> 0.2879
Epoch: 3/10
Valid loss:0.0851
Val metric mean prob: 0.1530
Best metric at epoch 3: 0.3704 0.1610 0.6660
Cf: [[4610   52]
 [  67   35]]
Model improve: 0.2879 -> 0.3704
Epoch: 4/10
Valid loss:0.0813
Val metric mean prob: 0.1929
Best metric at epoch 4: 0.4331 0.2390 0.6644
Cf: [[4641   21]
 [  68   34]]
Model improve: 0.3704 -> 0.4331
Epoch: 5/10
Date :01/12/2023, 11:19:52
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0001
    maximize: False
    swa_lr: 0.0001
    weight_decay: 0.01
)
total_epoch :15
Epoch: 2/15
Date :01/12/2023, 11:20:42
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0001
    maximize: False
    swa_lr: 0.0001
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Valid loss:0.1045
Val metric mean prob: 0.0303
Best metric at epoch 2: 0.0877 0.0650 0.5366
Cf: [[4546  116]
 [  92   10]]
Model improve: 0.0000 -> 0.0877
Epoch: 2/15
Valid loss:0.0922
Val metric mean prob: 0.0737
Best metric at epoch 3: 0.2691 0.1220 0.6373
Cf: [[4571   91]
 [  72   30]]
Model improve: 0.0877 -> 0.2691
Epoch: 3/15
Valid loss:0.0883
Val metric mean prob: 0.1277
Best metric at epoch 4: 0.3205 0.1710 0.6194
Cf: [[4633   29]
 [  77   25]]
Model improve: 0.2691 -> 0.3205
Epoch: 4/15
Valid loss:0.0820
Val metric mean prob: 0.1541
Best metric at epoch 5: 0.3924 0.1780 0.6493
Cf: [[4637   25]
 [  71   31]]
Model improve: 0.3205 -> 0.3924
Epoch: 5/15
Valid loss:0.0861
Val metric mean prob: 0.2016
Best metric at epoch 6: 0.4216 0.1770 0.6865
Cf: [[4618   44]
 [  63   39]]
Model improve: 0.3924 -> 0.4216
Epoch: 6/15
Valid loss:0.0862
Val metric mean prob: 0.2073
Best metric at epoch 7: 0.3867 0.2700 0.6668
Cf: [[4618   44]
 [  67   35]]
Epoch: 7/15
Valid loss:0.0864
Val metric mean prob: 0.1997
Best metric at epoch 8: 0.3900 0.1950 0.6848
Cf: [[4603   59]
 [  63   39]]
Epoch: 8/15
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0003
    lr: 0.0003
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Date :01/12/2023, 14:14:03
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0003
    lr: 0.0003
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Date :01/12/2023, 15:19:34
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0003
    lr: 0.0003
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Valid loss:0.1024
Val metric mean prob: 0.0323
Best metric at epoch 2: 0.1043 0.0600 0.5641
Cf: [[4437  225]
 [  84   18]]
Model improve: 0.0000 -> 0.1043
Epoch: 2/15
Date :01/12/2023, 15:49:11
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Date :01/12/2023, 15:51:04
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Date :01/12/2023, 15:53:25
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0
)
total_epoch :15
Epoch: 1/15
Date :01/12/2023, 16:01:55
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0
)
total_epoch :15
Epoch: 1/15
Date :01/12/2023, 16:02:24
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 16
optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0
)
total_epoch :15
Epoch: 1/15
Valid loss:0.1042
Val metric mean prob: 0.0291
Best metric at epoch 2: 0.0731 0.0470 0.5503
Cf: [[4263  399]
 [  83   19]]
Model improve: 0.0000 -> 0.0731
Epoch: 2/15
Valid loss:0.1060
Val metric mean prob: 0.0322
Best metric at epoch 3: 0.0739 0.0570 0.5383
Cf: [[4425  237]
 [  89   13]]
Model improve: 0.0731 -> 0.0739
Epoch: 3/15
Valid loss:0.1000
Val metric mean prob: 0.0389
Best metric at epoch 4: 0.1063 0.0420 0.6605
Cf: [[3873  789]
 [  52   50]]
Model improve: 0.0739 -> 0.1063
Epoch: 4/15
Valid loss:0.1069
Val metric mean prob: 0.0487
Best metric at epoch 5: 0.1353 0.1040 0.6068
Cf: [[4378  284]
 [  74   28]]
Model improve: 0.1063 -> 0.1353
Epoch: 5/15
Valid loss:0.0967
Val metric mean prob: 0.0780
Best metric at epoch 6: 0.1852 0.0910 0.7227
Cf: [[4225  437]
 [  47   55]]
Model improve: 0.1353 -> 0.1852
Epoch: 6/15
Valid loss:0.0908
Val metric mean prob: 0.0817
Best metric at epoch 7: 0.2973 0.1130 0.6524
Cf: [[4575   87]
 [  69   33]]
Model improve: 0.1852 -> 0.2973
Epoch: 7/15
Valid loss:0.0876
Val metric mean prob: 0.1302
Best metric at epoch 8: 0.3757 0.1990 0.6618
Cf: [[4617   45]
 [  68   34]]
Model improve: 0.2973 -> 0.3757
Epoch: 8/15
Valid loss:0.0827
Val metric mean prob: 0.1632
Best metric at epoch 9: 0.3625 0.2120 0.6390
Cf: [[4633   29]
 [  73   29]]
Epoch: 9/15
Valid loss:0.0939
Val metric mean prob: 0.1641
Best metric at epoch 10: 0.3282 0.2940 0.6503
Cf: [[4601   61]
 [  70   32]]
Epoch: 10/15
Valid loss:0.0833
Val metric mean prob: 0.2076
Best metric at epoch 11: 0.4353 0.2520 0.6780
Cf: [[4631   31]
 [  65   37]]
Model improve: 0.3757 -> 0.4353
Epoch: 11/15
Valid loss:0.0846
Val metric mean prob: 0.1694
Best metric at epoch 12: 0.4074 0.1170 0.7082
Cf: [[4592   70]
 [  58   44]]
Epoch: 12/15
Valid loss:0.0883
Val metric mean prob: 0.2261
Best metric at epoch 13: 0.4431 0.3660 0.6784
Cf: [[4634   28]
 [  65   37]]
Model improve: 0.4353 -> 0.4431
Epoch: 13/15
Date :01/12/2023, 22:35:28
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0
)
total_epoch :15
Epoch: 1/15
Valid loss:0.1034
Val metric mean prob: 0.0264
Best metric at epoch 2: 0.0816 0.0460 0.5300
Cf: [[4576   86]
 [  94    8]]
Model improve: 0.0000 -> 0.0816
Epoch: 2/15
Valid loss:0.1029
Val metric mean prob: 0.0356
Best metric at epoch 3: 0.0908 0.0420 0.6486
Cf: [[3671  991]
 [  50   52]]
Model improve: 0.0816 -> 0.0908
Epoch: 3/15
Valid loss:0.0969
Val metric mean prob: 0.0558
Best metric at epoch 4: 0.1728 0.1220 0.5901
Cf: [[4542  120]
 [  81   21]]
Model improve: 0.0908 -> 0.1728
Epoch: 4/15
Valid loss:0.1069
Val metric mean prob: 0.0725
Best metric at epoch 5: 0.2804 0.1730 0.6383
Cf: [[4580   82]
 [  72   30]]
Model improve: 0.1728 -> 0.2804
Epoch: 5/15
Valid loss:0.0840
Val metric mean prob: 0.1048
Best metric at epoch 6: 0.3636 0.1430 0.6524
Cf: [[4620   42]
 [  70   32]]
Model improve: 0.2804 -> 0.3636
Epoch: 6/15
Valid loss:0.0866
Val metric mean prob: 0.1307
Best metric at epoch 7: 0.3268 0.1890 0.6198
Cf: [[4636   26]
 [  77   25]]
Epoch: 7/15
Valid loss:0.0831
Val metric mean prob: 0.1452
Best metric at epoch 8: 0.4135 0.1660 0.7040
Cf: [[4599   63]
 [  59   43]]
Model improve: 0.3636 -> 0.4135
Epoch: 8/15
Valid loss:0.0838
Val metric mean prob: 0.1519
Best metric at epoch 9: 0.3571 0.1320 0.6432
Cf: [[4626   36]
 [  72   30]]
Epoch: 9/15
Valid loss:0.0815
Val metric mean prob: 0.2057
Best metric at epoch 10: 0.4409 0.1630 0.6964
Cf: [[4619   43]
 [  61   41]]
Model improve: 0.4135 -> 0.4409
Epoch: 10/15
Valid loss:0.0844
Val metric mean prob: 0.1988
Best metric at epoch 11: 0.3897 0.2060 0.6804
Cf: [[4607   55]
 [  64   38]]
Epoch: 11/15
Valid loss:0.0828
Val metric mean prob: 0.2023
Best metric at epoch 12: 0.4505 0.2090 0.6968
Cf: [[4623   39]
 [  61   41]]
Model improve: 0.4409 -> 0.4505
Epoch: 12/15
Valid loss:0.0821
Val metric mean prob: 0.2332
Best metric at epoch 13: 0.4615 0.1890 0.7291
Cf: [[4604   58]
 [  54   48]]
Model improve: 0.4505 -> 0.4615
Epoch: 13/15
Valid loss:0.0836
Val metric mean prob: 0.2390
Best metric at epoch 14: 0.4656 0.2230 0.7111
Cf: [[4619   43]
 [  58   44]]
Model improve: 0.4615 -> 0.4656
Epoch: 14/15
Valid loss:0.0850
Val metric mean prob: 0.2479
Best metric at epoch 15: 0.4731 0.2690 0.7114
Cf: [[4622   40]
 [  58   44]]
Model improve: 0.4656 -> 0.4731
Epoch: 15/15
Valid loss:0.0846
Val metric mean prob: 0.2442
Best metric at epoch 16: 0.4600 0.2250 0.7199
Cf: [[4610   52]
 [  56   46]]
Fold: 2
Len train df: 43694
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0
)
total_epoch :15
Epoch: 1/15
Date :01/13/2023, 04:56:33
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Date :01/13/2023, 04:58:55
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0
)
total_epoch :30
Epoch: 1/30
Train loss:0.1369, Valid loss:0.1031
Val metric mean prob: 0.0249
Best metric at epoch 2: 0.0804 0.0280 0.5882
Cf: [[3976  686]
 [  69   33]]
Model improve: 0.0000 -> 0.0804
Epoch: 2/30
Train loss:0.1329, Valid loss:0.0964
Val metric mean prob: 0.0717
Best metric at epoch 3: 0.2086 0.1230 0.6463
Cf: [[4472  190]
 [  68   34]]
Model improve: 0.0804 -> 0.2086
Epoch: 3/30
Train loss:0.1269, Valid loss:0.0899
Val metric mean prob: 0.0940
Best metric at epoch 4: 0.2983 0.1480 0.6268
Cf: [[4610   52]
 [  75   27]]
Model improve: 0.2086 -> 0.2983
Epoch: 4/30
Train loss:0.1189, Valid loss:0.0907
Val metric mean prob: 0.1052
Best metric at epoch 5: 0.3522 0.2130 0.6341
Cf: [[4633   29]
 [  74   28]]
Model improve: 0.2983 -> 0.3522
Epoch: 5/30
Train loss:0.1208, Valid loss:0.0862
Val metric mean prob: 0.1455
Best metric at epoch 6: 0.3571 0.2720 0.6212
Cf: [[4649   13]
 [  77   25]]
Model improve: 0.3522 -> 0.3571
Epoch: 6/30
Train loss:0.1152, Valid loss:0.0837
Val metric mean prob: 0.1622
Best metric at epoch 7: 0.4000 0.1490 0.6854
Cf: [[4608   54]
 [  63   39]]
Model improve: 0.3571 -> 0.4000
Epoch: 7/30
Train loss:0.1116, Valid loss:0.0831
Val metric mean prob: 0.1771
Best metric at epoch 8: 0.4134 0.2320 0.6771
Cf: [[4622   40]
 [  65   37]]
Model improve: 0.4000 -> 0.4134
Epoch: 8/30
Train loss:0.1133, Valid loss:0.0851
Val metric mean prob: 0.1677
Best metric at epoch 9: 0.3467 0.2520 0.6251
Cf: [[4640   22]
 [  76   26]]
Epoch: 9/30
Train loss:0.1118, Valid loss:0.0865
Val metric mean prob: 0.2013
Best metric at epoch 10: 0.3750 0.2490 0.6574
Cf: [[4621   41]
 [  69   33]]
Epoch: 10/30
Train loss:0.1106, Valid loss:0.0887
Val metric mean prob: 0.2098
Best metric at epoch 11: 0.4183 0.4010 0.6548
Cf: [[4643   19]
 [  70   32]]
Model improve: 0.4134 -> 0.4183
Epoch: 11/30
Train loss:0.1055, Valid loss:0.0850
Val metric mean prob: 0.2039
Best metric at epoch 12: 0.3732 0.1760 0.6839
Cf: [[4594   68]
 [  63   39]]
Epoch: 12/30
Date :01/13/2023, 10:42:54
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0
)
total_epoch :30
Epoch: 1/30
Train loss:0.1591, Valid loss:0.1048
Val metric mean prob: 0.0269
Best metric at epoch 1: 0.0653 0.0420 0.5351
Cf: [[4349  313]
 [  88   14]]
Model improve: 0.0000 -> 0.0653
Epoch: 2/30
Train loss:0.1377, Valid loss:0.1001
Val metric mean prob: 0.0278
Best metric at epoch 2: 0.1108 0.0290 0.6246
Cf: [[4133  529]
 [  65   37]]
Model improve: 0.0653 -> 0.1108
Epoch: 3/30
Train loss:0.1341, Valid loss:0.0974
Val metric mean prob: 0.0393
Best metric at epoch 3: 0.1638 0.0510 0.6330
Cf: [[4394  268]
 [  69   33]]
Model improve: 0.1108 -> 0.1638
Epoch: 4/30
Train loss:0.1289, Valid loss:0.0951
Val metric mean prob: 0.0484
Best metric at epoch 4: 0.2194 0.0640 0.6158
Cf: [[4553  109]
 [  76   26]]
Model improve: 0.1638 -> 0.2194
Epoch: 5/30
Train loss:0.1315, Valid loss:0.0949
Val metric mean prob: 0.0513
Best metric at epoch 5: 0.2459 0.0780 0.6350
Cf: [[4550  112]
 [  72   30]]
Model improve: 0.2194 -> 0.2459
Epoch: 6/30
Train loss:0.1264, Valid loss:0.0921
Val metric mean prob: 0.0595
Best metric at epoch 6: 0.2303 0.0950 0.5884
Cf: [[4618   44]
 [  83   19]]
Epoch: 7/30
Date :01/13/2023, 13:17:47
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0
)
total_epoch :30
Epoch: 1/30
Train loss:0.1595, Valid loss:0.1034
Val metric mean prob: 0.0264
Best metric at epoch 1: 0.0816 0.0460 0.5300
Cf: [[4576   86]
 [  94    8]]
Model improve: 0.0000 -> 0.0816
Epoch: 2/30
Train loss:0.1378, Valid loss:0.1029
Val metric mean prob: 0.0356
Best metric at epoch 2: 0.0908 0.0420 0.6486
Cf: [[3671  991]
 [  50   52]]
Model improve: 0.0816 -> 0.0908
Epoch: 3/30
Date :01/13/2023, 15:18:44
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0
)
total_epoch :30
Epoch: 1/30
Train loss:0.1595, Valid loss:0.1034
Val metric mean prob: 0.0264
Best metric at epoch 1: 0.0816 0.0460 0.5300
Cf: [[4576   86]
 [  94    8]]
Model improve: 0.0000 -> 0.0816
Epoch: 2/30
Train loss:0.1378, Valid loss:0.1029
Val metric mean prob: 0.0356
Best metric at epoch 2: 0.0908 0.0420 0.6486
Cf: [[3671  991]
 [  50   52]]
Model improve: 0.0816 -> 0.0908
Epoch: 3/30
Train loss:0.1327, Valid loss:0.0969
Val metric mean prob: 0.0558
Best metric at epoch 3: 0.1728 0.1220 0.5901
Cf: [[4542  120]
 [  81   21]]
Model improve: 0.0908 -> 0.1728
Epoch: 4/30
Train loss:0.1263, Valid loss:0.1119
Val metric mean prob: 0.0625
Best metric at epoch 4: 0.2839 0.1710 0.6045
Cf: [[4631   31]
 [  80   22]]
Model improve: 0.1728 -> 0.2839
Epoch: 5/30
Train loss:0.1262, Valid loss:0.0858
Val metric mean prob: 0.0966
Best metric at epoch 5: 0.3214 0.1410 0.6282
Cf: [[4623   39]
 [  75   27]]
Model improve: 0.2839 -> 0.3214
Epoch: 6/30
Train loss:0.1201, Valid loss:0.0841
Val metric mean prob: 0.1540
Best metric at epoch 6: 0.3665 0.1800 0.6658
Cf: [[4608   54]
 [  67   35]]
Model improve: 0.3214 -> 0.3665
Epoch: 7/30
Train loss:0.1158, Valid loss:0.0843
Val metric mean prob: 0.1356
Best metric at epoch 7: 0.3842 0.1510 0.6845
Cf: [[4600   62]
 [  63   39]]
Model improve: 0.3665 -> 0.3842
Epoch: 8/30
Train loss:0.1172, Valid loss:0.0865
Val metric mean prob: 0.1521
Best metric at epoch 8: 0.3700 0.1180 0.6748
Cf: [[4601   61]
 [  65   37]]
Epoch: 9/30
Train loss:0.1160, Valid loss:0.0835
Val metric mean prob: 0.2075
Best metric at epoch 9: 0.4021 0.1800 0.6810
Cf: [[4613   49]
 [  64   38]]
Model improve: 0.3842 -> 0.4021
Epoch: 10/30
Train loss:0.1135, Valid loss:0.0830
Val metric mean prob: 0.1914
Best metric at epoch 10: 0.4222 0.1890 0.6820
Cf: [[4622   40]
 [  64   38]]
Model improve: 0.4021 -> 0.4222
Epoch: 11/30
Train loss:0.1093, Valid loss:0.0865
Val metric mean prob: 0.1893
Best metric at epoch 11: 0.4000 0.1850 0.7167
Cf: [[4580   82]
 [  56   46]]
Epoch: 12/30
Train loss:0.1069, Valid loss:0.0803
Val metric mean prob: 0.1970
Best metric at epoch 12: 0.4279 0.1680 0.7183
Cf: [[4595   67]
 [  56   46]]
Model improve: 0.4222 -> 0.4279
Epoch: 13/30
Train loss:0.1014, Valid loss:0.0850
Val metric mean prob: 0.2137
Best metric at epoch 13: 0.4245 0.1760 0.7136
Cf: [[4597   65]
 [  57   45]]
Epoch: 14/30
Train loss:0.0992, Valid loss:0.0867
Val metric mean prob: 0.2076
Best metric at epoch 14: 0.4608 0.1910 0.7245
Cf: [[4607   55]
 [  55   47]]
Model improve: 0.4279 -> 0.4608
Epoch: 15/30
Train loss:0.0981, Valid loss:0.0941
Val metric mean prob: 0.2094
Best metric at epoch 15: 0.3830 0.3070 0.6711
Cf: [[4612   50]
 [  66   36]]
Epoch: 16/30
Train loss:0.0984, Valid loss:0.0904
Val metric mean prob: 0.2213
Best metric at epoch 16: 0.3951 0.2910 0.6539
Cf: [[4634   28]
 [  70   32]]
Epoch: 17/30
Train loss:0.0976, Valid loss:0.0948
Val metric mean prob: 0.2225
Best metric at epoch 17: 0.4277 0.3960 0.6777
Cf: [[4628   34]
 [  65   37]]
Epoch: 18/30
Train loss:0.0905, Valid loss:0.1040
Val metric mean prob: 0.2646
Best metric at epoch 18: 0.4194 0.2240 0.7448
Cf: [[4568   94]
 [  50   52]]
Epoch: 19/30
Train loss:0.0893, Valid loss:0.0941
Val metric mean prob: 0.2677
Best metric at epoch 19: 0.4483 0.3400 0.6876
Cf: [[4629   33]
 [  63   39]]
Epoch: 20/30
Train loss:0.0879, Valid loss:0.0984
Val metric mean prob: 0.2709
Best metric at epoch 20: 0.4375 0.3890 0.6691
Cf: [[4639   23]
 [  67   35]]
Epoch: 21/30
Train loss:0.0864, Valid loss:0.0999
Val metric mean prob: 0.2510
Best metric at epoch 21: 0.4204 0.3140 0.6594
Cf: [[4640   22]
 [  69   33]]
Epoch: 22/30
Train loss:0.0804, Valid loss:0.0978
Val metric mean prob: 0.2580
Best metric at epoch 22: 0.4000 0.1960 0.6854
Cf: [[4608   54]
 [  63   39]]
Epoch: 23/30
Train loss:0.0781, Valid loss:0.1027
Val metric mean prob: 0.2649
Best metric at epoch 23: 0.4393 0.3710 0.6827
Cf: [[4629   33]
 [  64   38]]
Epoch: 24/30
Date :01/14/2023, 09:21:05
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/14/2023, 09:37:08
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/14/2023, 09:37:30
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Train loss:0.2518, Valid loss:0.1066
Val metric mean prob: 0.0616
Best metric at epoch 1: 0.2032 0.1750 0.5861
Cf: [[4596   66]
 [  83   19]]
Model improve: 0.0000 -> 0.2032
Epoch: 2/30
Train loss:0.1847, Valid loss:0.0887
Val metric mean prob: 0.1181
Best metric at epoch 2: 0.3094 0.1660 0.6318
Cf: [[4611   51]
 [  74   28]]
Model improve: 0.2032 -> 0.3094
Epoch: 3/30
Train loss:0.1648, Valid loss:0.1850
Val metric mean prob: 0.1578
Best metric at epoch 3: 0.3978 0.6760 0.6763
Cf: [[4615   47]
 [  65   37]]
Model improve: 0.3094 -> 0.3978
Epoch: 4/30
Train loss:0.1444, Valid loss:0.0944
Val metric mean prob: 0.2023
Best metric at epoch 4: 0.4393 0.3730 0.6827
Cf: [[4629   33]
 [  64   38]]
Model improve: 0.3978 -> 0.4393
Epoch: 5/30
Train loss:0.1212, Valid loss:0.0999
Val metric mean prob: 0.1901
Best metric at epoch 5: 0.4022 0.3620 0.6721
Cf: [[4621   41]
 [  66   36]]
Epoch: 6/30
Train loss:0.1054, Valid loss:0.0986
Val metric mean prob: 0.1966
Best metric at epoch 6: 0.3774 0.3310 0.6442
Cf: [[4635   27]
 [  72   30]]
Epoch: 7/30
Date :01/14/2023, 14:28:25
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/14/2023, 14:41:29
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/14/2023, 14:47:30
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Train loss:0.1781, Valid loss:0.1029
Val metric mean prob: 0.0300
Best metric at epoch 1: 0.0930 0.0490 0.5542
Cf: [[4436  226]
 [  86   16]]
Model improve: 0.0000 -> 0.0930
Epoch: 2/30
Train loss:0.1363, Valid loss:0.1009
Val metric mean prob: 0.0364
Best metric at epoch 2: 0.1176 0.0600 0.5938
Cf: [[4348  314]
 [  76   26]]
Model improve: 0.0930 -> 0.1176
Epoch: 3/30
Date :01/14/2023, 15:38:17
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4), tile_grid_size=(8, 8)),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  OneOf([
    JpegCompression(always_apply=False, p=0.5, quality_lower=99, quality_upper=100),
    Downscale(always_apply=False, p=0.5, scale_min=0.1, scale_max=0.15),
  ], p=0.2),
  IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  CoarseDropout(always_apply=False, p=0.5, max_holes=8, max_height=51, max_width=51, min_holes=5, min_height=51, min_width=51, fill_value=0, mask_fill_value=0),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Train loss:0.1829, Valid loss:0.1259
Val metric mean prob: 0.0443
Best metric at epoch 1: 0.1158 0.1160 0.6372
Cf: [[4113  549]
 [  62   40]]
Model improve: 0.0000 -> 0.1158
Epoch: 2/30
Train loss:0.1327, Valid loss:0.0961
Val metric mean prob: 0.0578
Best metric at epoch 2: 0.1984 0.1080 0.6091
Cf: [[4537  125]
 [  77   25]]
Model improve: 0.1158 -> 0.1984
Epoch: 3/30
Train loss:0.1264, Valid loss:0.0938
Val metric mean prob: 0.0887
Best metric at epoch 3: 0.2416 0.1920 0.5851
Cf: [[4633   29]
 [  84   18]]
Model improve: 0.1984 -> 0.2416
Epoch: 4/30
Date :01/14/2023, 23:35:39
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  CoarseDropout(always_apply=False, p=0.5, max_holes=8, max_height=51, max_width=51, min_holes=5, min_height=51, min_width=51, fill_value=0, mask_fill_value=0),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Train loss:0.3087, Valid loss:0.1438
Val metric mean prob: 0.1165
Best metric at epoch 1: 0.3442 0.4090 0.6732
Cf: [[4586   76]
 [  65   37]]
Model improve: 0.0000 -> 0.3442
Epoch: 2/30
Train loss:0.3219, Valid loss:0.2340
Val metric mean prob: 0.0682
Best metric at epoch 2: 0.1429 0.5980 0.5495
Cf: [[4621   41]
 [  91   11]]
Epoch: 3/30
Train loss:0.3140, Valid loss:0.1088
Val metric mean prob: 0.0689
Best metric at epoch 3: 0.1656 0.1550 0.6112
Cf: [[4465  197]
 [  75   27]]
Epoch: 4/30
Train loss:0.3044, Valid loss:0.1349
Val metric mean prob: 0.1072
Best metric at epoch 4: 0.2827 0.4120 0.6257
Cf: [[4600   62]
 [  75   27]]
Epoch: 5/30
Date :01/15/2023, 01:28:45
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  CoarseDropout(always_apply=False, p=0.5, max_holes=8, max_height=51, max_width=51, min_holes=5, min_height=51, min_width=51, fill_value=0, mask_fill_value=0),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/15/2023, 01:30:29
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  CoarseDropout(always_apply=False, p=0.5, max_holes=8, max_height=51, max_width=51, min_holes=5, min_height=51, min_width=51, fill_value=0, mask_fill_value=0),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/15/2023, 01:38:09
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  CoarseDropout(always_apply=False, p=0.5, max_holes=8, max_height=51, max_width=51, min_holes=5, min_height=51, min_width=51, fill_value=0, mask_fill_value=0),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Fold: 1
Len train df: 43827
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Fold: 1
Len train df: 2000
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Fold: 1
Len train df: 2000
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Train loss:0.6443, Valid loss:0.5538
Val metric mean prob: 0.0449
Best metric at epoch 1: 0.0480 0.5960 0.5240
Cf: [[  6 119]
 [  0   3]]
Model improve: 0.0000 -> 0.0480
Epoch: 2/10
Train loss:0.3790, Valid loss:0.1406
Val metric mean prob: 0.0448
Best metric at epoch 2: 0.0615 0.5220 0.5933
Cf: [[65 60]
 [ 1  2]]
Model improve: 0.0480 -> 0.0615
Epoch: 3/10
Fold: 1
Len train df: 2000
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Fold: 1
Len train df: 200
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Fold: 1
Len train df: 200
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Train loss:0.6841, Valid loss:0.6342
Val metric mean prob: 0.0441
Best metric at epoch 1: 0.2222 0.4940 0.6467
Cf: [[120   5]
 [  2   1]]
Model improve: 0.0000 -> 0.2222
Valid loss:0.6342
Val metric mean prob: 0.0000
Best metric at epoch 2: 0.0000 0.0000 0.0000
Cf: None
Epoch: 2/10
Train loss:0.6540, Valid loss:0.5993
Val metric mean prob: 0.0435
Best metric at epoch 2: 0.0492 0.4270 0.5360
Cf: [[  9 116]
 [  0   3]]
Valid loss:0.5993
Fold: 1
Len train df: 1000
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Train loss:0.6649, Valid loss:0.6171
Val metric mean prob: 0.0326
Best metric at epoch 1: 0.0400 0.4710 0.5322
Cf: [[125  46]
 [  2   1]]
Model improve: 0.0000 -> 0.0400
Valid loss:0.6171
Fold: 1
Len train df: 1000
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Train loss:0.6649, Valid loss:0.6171
Val metric mean prob: 0.0326
Best metric at epoch 1: 0.0400 0.4710 0.5322
Cf: [[125  46]
 [  2   1]]
Model improve: 0.0000 -> 0.0400
Valid loss:0.6171
Val metric mean prob: 0.0326
Best metric at epoch 2: 0.0400 0.4710 0.5322
Cf: [[125  46]
 [  2   1]]
Epoch: 2/10
Date :01/15/2023, 02:01:27
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  CoarseDropout(always_apply=False, p=0.5, max_holes=8, max_height=51, max_width=51, min_holes=5, min_height=51, min_width=51, fill_value=0, mask_fill_value=0),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Train loss:0.3705, Valid loss:0.1649
Val metric mean prob: 0.0415
Best metric at epoch 1: 0.0695 0.1780 0.5359
Cf: [[4403  259]
 [  89   13]]
Model improve: 0.0000 -> 0.0695
Valid loss:0.1649
Val metric mean prob: 0.0414
Best metric at epoch 2: 0.0705 0.1790 0.5365
Cf: [[4408  254]
 [  89   13]]
Model improve: 0.0695 -> 0.0705
Epoch: 2/10
Train loss:0.3021, Valid loss:0.1099
Val metric mean prob: 0.1351
Best metric at epoch 2: 0.3316 0.2960 0.6505
Cf: [[4603   59]
 [  70   32]]
Model improve: 0.0705 -> 0.3316
Valid loss:0.1099
Val metric mean prob: 0.1333
Best metric at epoch 3: 0.3087 0.4350 0.6102
Cf: [[4638   24]
 [  79   23]]
Epoch: 3/10
Train loss:0.2512, Valid loss:0.1334
Val metric mean prob: 0.1941
Best metric at epoch 3: 0.3676 0.5500 0.6614
Cf: [[4613   49]
 [  68   34]]
Model improve: 0.3316 -> 0.3676
Valid loss:0.1334
Val metric mean prob: 0.1708
Best metric at epoch 4: 0.3729 0.5550 0.6573
Cf: [[4620   42]
 [  69   33]]
Model improve: 0.3676 -> 0.3729
Epoch: 4/10
Train loss:0.2103, Valid loss:0.1801
Val metric mean prob: 0.1916
Best metric at epoch 4: 0.4216 0.6410 0.6865
Cf: [[4618   44]
 [  63   39]]
Model improve: 0.3729 -> 0.4216
Valid loss:0.1801
Val metric mean prob: 0.1535
Best metric at epoch 5: 0.3858 0.5890 0.6802
Cf: [[4605   57]
 [  64   38]]
Epoch: 5/10
Train loss:0.1632, Valid loss:0.1220
Val metric mean prob: 0.2320
Best metric at epoch 5: 0.3505 0.3080 0.6604
Cf: [[4604   58]
 [  68   34]]
Valid loss:0.1220
Val metric mean prob: 0.2007
Best metric at epoch 6: 0.3390 0.4600 0.6422
Cf: [[4617   45]
 [  72   30]]
Epoch: 6/10
Train loss:0.1270, Valid loss:0.1242
Val metric mean prob: 0.2560
Best metric at epoch 6: 0.3459 0.2450 0.6514
Cf: [[4611   51]
 [  70   32]]
Valid loss:0.1242
Val metric mean prob: 0.2251
Best metric at epoch 7: 0.3429 0.3640 0.6687
Cf: [[4590   72]
 [  66   36]]
Epoch: 7/10
Date :01/15/2023, 05:42:10
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  CoarseDropout(always_apply=False, p=0.5, max_holes=8, max_height=51, max_width=51, min_holes=5, min_height=51, min_width=51, fill_value=0, mask_fill_value=0),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Date :01/15/2023, 05:42:42
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  CoarseDropout(always_apply=False, p=0.5, max_holes=8, max_height=51, max_width=51, min_holes=5, min_height=51, min_width=51, fill_value=0, mask_fill_value=0),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 0.0
    weight_decay: 0
)
total_epoch :15
Epoch: 1/15
Date :01/15/2023, 05:50:53
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  CoarseDropout(always_apply=False, p=0.5, max_holes=8, max_height=51, max_width=51, min_holes=5, min_height=51, min_width=51, fill_value=0, mask_fill_value=0),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Date :01/15/2023, 05:51:25
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  CoarseDropout(always_apply=False, p=0.5, max_holes=8, max_height=51, max_width=51, min_holes=5, min_height=51, min_width=51, fill_value=0, mask_fill_value=0),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 0.0
    weight_decay: 0
)
total_epoch :15
Epoch: 1/15
Train loss:0.2329, Valid loss:0.1031
Val metric mean prob: 0.0291
Best metric at epoch 1: 0.0952 0.0560 0.5413
Cf: [[4544  118]
 [  91   11]]
Model improve: 0.0000 -> 0.0952
Valid loss:0.1031
Val metric mean prob: 0.0293
Best metric at epoch 2: 0.0960 0.0550 0.5442
Cf: [[4526  136]
 [  90   12]]
Model improve: 0.0952 -> 0.0960
Epoch: 2/15
Train loss:0.1285, Valid loss:0.0942
Val metric mean prob: 0.0739
Best metric at epoch 2: 0.2512 0.1250 0.6231
Cf: [[4576   86]
 [  75   27]]
Model improve: 0.0960 -> 0.2512
Valid loss:0.0942
Val metric mean prob: 0.0773
Best metric at epoch 3: 0.2556 0.1890 0.5818
Cf: [[4648   14]
 [  85   17]]
Model improve: 0.2512 -> 0.2556
Epoch: 3/15
Train loss:0.1156, Valid loss:0.0909
Val metric mean prob: 0.1061
Best metric at epoch 3: 0.3004 0.0670 0.6613
Cf: [[4566   96]
 [  67   35]]
Model improve: 0.2556 -> 0.3004
Valid loss:0.0909
Val metric mean prob: 0.1231
Best metric at epoch 4: 0.3069 0.1350 0.6359
Cf: [[4604   58]
 [  73   29]]
Model improve: 0.3004 -> 0.3069
Epoch: 4/15
Train loss:0.1033, Valid loss:0.0877
Val metric mean prob: 0.1549
Best metric at epoch 4: 0.3546 0.2030 0.6210
Cf: [[4648   14]
 [  77   25]]
Model improve: 0.3069 -> 0.3546
Valid loss:0.0877
Val metric mean prob: 0.1561
Best metric at epoch 5: 0.3223 0.1660 0.6586
Cf: [[4587   75]
 [  68   34]]
Epoch: 5/15
Train loss:0.1030, Valid loss:0.0898
Val metric mean prob: 0.1684
Best metric at epoch 5: 0.3506 0.2350 0.6297
Cf: [[4637   25]
 [  75   27]]
Valid loss:0.0898
Val metric mean prob: 0.1660
Best metric at epoch 6: 0.3567 0.3070 0.6344
Cf: [[4635   27]
 [  74   28]]
Model improve: 0.3546 -> 0.3567
Epoch: 6/15
Train loss:0.0935, Valid loss:0.0882
Val metric mean prob: 0.1886
Best metric at epoch 6: 0.3529 0.1070 0.6826
Cf: [[4582   80]
 [  63   39]]
Valid loss:0.0882
Val metric mean prob: 0.1895
Best metric at epoch 7: 0.3717 0.1610 0.6971
Cf: [[4580   82]
 [  60   42]]
Model improve: 0.3567 -> 0.3717
Epoch: 7/15
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Date :01/15/2023, 08:41:10
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Date :01/15/2023, 08:42:42
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Valid loss:0.1056
Val metric mean prob: 0.0276
Best metric at epoch 2: 0.0638 0.0370 0.5819
Cf: [[3460 1202]
 [  59   43]]
Model improve: 0.0000 -> 0.0638
Epoch: 2/10
Valid loss:0.1044
Val metric mean prob: 0.0354
Best metric at epoch 3: 0.0952 0.0740 0.5523
Cf: [[4464  198]
 [  87   15]]
Model improve: 0.0638 -> 0.0952
Epoch: 3/10
Valid loss:0.1023
Val metric mean prob: 0.0380
Best metric at epoch 4: 0.1081 0.0820 0.5654
Cf: [[4449  213]
 [  84   18]]
Model improve: 0.0952 -> 0.1081
Epoch: 4/10
Valid loss:0.1000
Val metric mean prob: 0.0405
Best metric at epoch 5: 0.1121 0.0840 0.5481
Cf: [[4562  100]
 [  90   12]]
Model improve: 0.1081 -> 0.1121
Epoch: 5/10
Date :01/15/2023, 11:00:05
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    weight_decay: 0
)
total_epoch :10
Epoch: 1/10
Valid loss:0.1041
Val metric mean prob: 0.0262
Best metric at epoch 2: 0.0658 0.0380 0.5390
Cf: [[4294  368]
 [  86   16]]
Model improve: 0.0000 -> 0.0658
Epoch: 2/10
Valid loss:0.1059
Val metric mean prob: 0.0372
Best metric at epoch 3: 0.1002 0.0750 0.5798
Cf: [[4309  353]
 [  78   24]]
Model improve: 0.0658 -> 0.1002
Epoch: 3/10
Valid loss:0.0989
Val metric mean prob: 0.0526
Best metric at epoch 4: 0.1500 0.1310 0.5646
Cf: [[4579   83]
 [  87   15]]
Model improve: 0.1002 -> 0.1500
Epoch: 4/10
Valid loss:0.0932
Val metric mean prob: 0.0656
Best metric at epoch 5: 0.2102 0.0910 0.6426
Cf: [[4483  179]
 [  69   33]]
Model improve: 0.1500 -> 0.2102
Epoch: 5/10
Date :01/15/2023, 13:11:41
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: Lookahead (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lookahead_alpha: 0.5
    lookahead_k: 5
    lookahead_step: 0
    lr: 1e-05
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Valid loss:0.1036
Val metric mean prob: 0.0258
Best metric at epoch 2: 0.0704 0.0370 0.5404
Cf: [[4353  309]
 [  87   15]]
Model improve: 0.0000 -> 0.0704
Epoch: 2/10
Valid loss:0.1037
Val metric mean prob: 0.0367
Best metric at epoch 3: 0.0916 0.0740 0.5616
Cf: [[4368  294]
 [  83   19]]
Model improve: 0.0704 -> 0.0916
Epoch: 3/10
Valid loss:0.0983
Val metric mean prob: 0.0443
Best metric at epoch 4: 0.1465 0.0830 0.5818
Cf: [[4511  151]
 [  82   20]]
Model improve: 0.0916 -> 0.1465
Epoch: 4/10
Date :01/15/2023, 15:01:52
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Date :01/15/2023, 15:30:13
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 8e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ColorJitter(always_apply=False, p=0.75, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ColorJitter(always_apply=False, p=0.75, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ColorJitter(always_apply=False, p=0.75, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.5),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ColorJitter(always_apply=False, p=0.75, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.5),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ColorJitter(always_apply=False, p=0.75, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.5),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-20, 20), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.5),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-20, 20), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.5),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-20, 20), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.5),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-20, 20), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-20, 20), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-20, 20), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Date :01/15/2023, 15:43:28
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-20, 20), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 8e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Valid loss:0.1028
Val metric mean prob: 0.0288
Best metric at epoch 2: 0.0775 0.0390 0.5714
Cf: [[4094  568]
 [  75   27]]
Model improve: 0.0000 -> 0.0775
Epoch: 2/15
Valid loss:0.1009
Val metric mean prob: 0.0422
Best metric at epoch 3: 0.1667 0.0880 0.5742
Cf: [[4577   85]
 [  85   17]]
Model improve: 0.0775 -> 0.1667
Epoch: 3/15
Valid loss:0.0975
Val metric mean prob: 0.0803
Best metric at epoch 4: 0.1888 0.1280 0.5962
Cf: [[4553  109]
 [  80   22]]
Model improve: 0.1667 -> 0.1888
Epoch: 4/15
Valid loss:0.0907
Val metric mean prob: 0.0955
Best metric at epoch 5: 0.2667 0.1720 0.5950
Cf: [[4634   28]
 [  82   20]]
Model improve: 0.1888 -> 0.2667
Epoch: 5/15
Valid loss:0.0892
Val metric mean prob: 0.1189
Best metric at epoch 6: 0.2876 0.1850 0.6047
Cf: [[4633   29]
 [  80   22]]
Model improve: 0.2667 -> 0.2876
Epoch: 6/15
Valid loss:0.0902
Val metric mean prob: 0.1245
Best metric at epoch 7: 0.3091 0.1060 0.6577
Cf: [[4578   84]
 [  68   34]]
Model improve: 0.2876 -> 0.3091
Epoch: 7/15
Valid loss:0.0939
Val metric mean prob: 0.1315
Best metric at epoch 8: 0.3372 0.2750 0.6378
Cf: [[4621   41]
 [  73   29]]
Model improve: 0.3091 -> 0.3372
Epoch: 8/15
Valid loss:0.0891
Val metric mean prob: 0.1673
Best metric at epoch 9: 0.3600 0.2800 0.6301
Cf: [[4641   21]
 [  75   27]]
Model improve: 0.3372 -> 0.3600
Epoch: 9/15
Valid loss:0.0910
Val metric mean prob: 0.1752
Best metric at epoch 10: 0.3593 0.2530 0.6433
Cf: [[4627   35]
 [  72   30]]
Epoch: 10/15
Valid loss:0.0944
Val metric mean prob: 0.1683
Best metric at epoch 11: 0.3645 0.2370 0.6833
Cf: [[4589   73]
 [  63   39]]
Model improve: 0.3600 -> 0.3645
Epoch: 11/15
Valid loss:0.0893
Val metric mean prob: 0.1670
Best metric at epoch 12: 0.3846 0.2950 0.6445
Cf: [[4638   24]
 [  72   30]]
Model improve: 0.3645 -> 0.3846
Epoch: 12/15
Valid loss:0.0880
Val metric mean prob: 0.1946
Best metric at epoch 13: 0.3896 0.3360 0.6447
Cf: [[4640   22]
 [  72   30]]
Model improve: 0.3846 -> 0.3896
Epoch: 13/15
Valid loss:0.0875
Val metric mean prob: 0.1944
Best metric at epoch 14: 0.4056 0.3660 0.6409
Cf: [[4650   12]
 [  73   29]]
Model improve: 0.3896 -> 0.4056
Epoch: 14/15
Date :01/15/2023, 22:53:13
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-20, 20), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Date :01/15/2023, 22:55:50
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-20, 20), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Valid loss:0.1032
Val metric mean prob: 0.0276
Best metric at epoch 2: 0.0713 0.0410 0.5429
Cf: [[4331  331]
 [  86   16]]
Model improve: 0.0000 -> 0.0713
Epoch: 2/15
Valid loss:0.1080
Val metric mean prob: 0.0309
Best metric at epoch 3: 0.0835 0.0520 0.5549
Cf: [[4351  311]
 [  84   18]]
Model improve: 0.0713 -> 0.0835
Epoch: 3/15
Valid loss:0.0985
Val metric mean prob: 0.0343
Best metric at epoch 4: 0.1269 0.0370 0.6503
Cf: [[4144  518]
 [  60   42]]
Model improve: 0.0835 -> 0.1269
Epoch: 4/15
Valid loss:0.0946
Val metric mean prob: 0.0676
Best metric at epoch 5: 0.2065 0.1390 0.5745
Cf: [[4625   37]
 [  86   16]]
Model improve: 0.1269 -> 0.2065
Epoch: 5/15
Valid loss:0.0911
Val metric mean prob: 0.0783
Best metric at epoch 6: 0.2597 0.1150 0.5946
Cf: [[4630   32]
 [  82   20]]
Model improve: 0.2065 -> 0.2597
Epoch: 6/15
Valid loss:0.0918
Val metric mean prob: 0.1023
Best metric at epoch 7: 0.3004 0.0650 0.6870
Cf: [[4532  130]
 [  61   41]]
Model improve: 0.2597 -> 0.3004
Epoch: 7/15
Valid loss:0.0945
Val metric mean prob: 0.1217
Best metric at epoch 8: 0.3006 0.2540 0.6226
Cf: [[4617   45]
 [  76   26]]
Model improve: 0.3004 -> 0.3006
Epoch: 8/15
Valid loss:0.0857
Val metric mean prob: 0.1627
Best metric at epoch 9: 0.3780 0.2270 0.6486
Cf: [[4631   31]
 [  71   31]]
Model improve: 0.3006 -> 0.3780
Epoch: 9/15
Valid loss:0.0877
Val metric mean prob: 0.1552
Best metric at epoch 10: 0.3205 0.2190 0.6194
Cf: [[4633   29]
 [  77   25]]
Epoch: 10/15
Valid loss:0.0939
Val metric mean prob: 0.1740
Best metric at epoch 11: 0.3896 0.4000 0.6447
Cf: [[4640   22]
 [  72   30]]
Model improve: 0.3780 -> 0.3896
Epoch: 11/15
Date :01/16/2023, 04:24:23
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Date :01/16/2023, 04:24:57
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Date :01/16/2023, 04:26:25
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Date :01/16/2023, 04:33:44
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Date :01/16/2023, 04:34:58
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Date :01/16/2023, 04:44:05
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Valid loss:0.1134
Val metric mean prob: 0.0381
Best metric at epoch 2: 0.1190 0.0870 0.5591
Cf: [[4527  135]
 [  87   15]]
Model improve: 0.0000 -> 0.1190
Epoch: 2/15
Valid loss:0.1053
Val metric mean prob: 0.0395
Best metric at epoch 3: 0.1939 0.0810 0.5734
Cf: [[4615   47]
 [  86   16]]
Model improve: 0.1190 -> 0.1939
Epoch: 3/15
Valid loss:0.0981
Val metric mean prob: 0.0776
Best metric at epoch 4: 0.2581 0.1600 0.6279
Cf: [[4575   87]
 [  74   28]]
Model improve: 0.1939 -> 0.2581
Epoch: 4/15
Valid loss:0.1114
Val metric mean prob: 0.1095
Best metric at epoch 5: 0.2778 0.3310 0.6169
Cf: [[4609   53]
 [  77   25]]
Model improve: 0.2581 -> 0.2778
Epoch: 5/15
Valid loss:0.0974
Val metric mean prob: 0.1001
Best metric at epoch 6: 0.2947 0.2030 0.6308
Cf: [[4602   60]
 [  74   28]]
Model improve: 0.2778 -> 0.2947
Epoch: 6/15
Date :01/16/2023, 07:56:45
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Date :01/16/2023, 08:21:00
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Date :01/16/2023, 09:23:59
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Date :01/16/2023, 09:24:27
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 200
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Valid loss:0.2257
Val metric mean prob: 0.0398
Best metric at epoch 2: 0.0714 0.1870 0.5707
Cf: [[101  24]
 [  2   1]]
Model improve: 0.0000 -> 0.0714
Date :01/16/2023, 09:25:20
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Valid loss:0.1011
Val metric mean prob: 0.0502
Best metric at epoch 2: 0.1633 0.1570 0.5553
Cf: [[4629   33]
 [  90   12]]
Model improve: 0.0000 -> 0.1633
Epoch: 2/15
Valid loss:0.0971
Val metric mean prob: 0.0851
Best metric at epoch 3: 0.2840 0.1620 0.6088
Cf: [[4625   37]
 [  79   23]]
Model improve: 0.1633 -> 0.2840
Epoch: 3/15
Valid loss:0.0988
Val metric mean prob: 0.1159
Best metric at epoch 4: 0.3291 0.2310 0.6242
Cf: [[4632   30]
 [  76   26]]
Model improve: 0.2840 -> 0.3291
Epoch: 4/15
Valid loss:0.0958
Val metric mean prob: 0.1393
Best metric at epoch 5: 0.3261 0.2100 0.6415
Cf: [[4610   52]
 [  72   30]]
Epoch: 5/15
Date :01/16/2023, 13:47:01
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.5),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0005
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Date :01/16/2023, 13:50:24
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.5),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0005
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Date :01/16/2023, 13:58:12
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  VerticalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.5),
  IAASharpen(always_apply=False, p=0.2, alpha=(0.2, 0.5), lightness=(0.5, 1.0)),
  JpegCompression(always_apply=False, p=0.2, quality_lower=99, quality_upper=100),
  Downscale(always_apply=False, p=0.5, scale_min=0.5, scale_max=0.75),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Train loss:0.3639, Valid loss:0.1737
Val metric mean prob: 0.0513
Best metric at epoch 2: 0.1573 0.2720 0.5620
Cf: [[4600   62]
 [  88   14]]
Model improve: 0.0000 -> 0.1573
Epoch: 2/15
Date :01/16/2023, 15:17:45
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  VerticalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Train loss:0.1499, Valid loss:0.1040
Val metric mean prob: 0.0248
Best metric at epoch 2: 0.0620 0.0290 0.5761
Cf: [[3452 1210]
 [  60   42]]
Model improve: 0.0000 -> 0.0620
Epoch: 2/15
Train loss:0.1382, Valid loss:0.1037
Val metric mean prob: 0.0247
Best metric at epoch 3: 0.0705 0.0310 0.5522
Cf: [[4189  473]
 [  81   21]]
Model improve: 0.0620 -> 0.0705
Epoch: 3/15
Train loss:0.1386, Valid loss:0.1046
Val metric mean prob: 0.0248
Best metric at epoch 4: 0.0569 0.0340 0.5184
Cf: [[4559  103]
 [  96    6]]
Epoch: 4/15
Train loss:0.1318, Valid loss:0.1037
Val metric mean prob: 0.0219
Best metric at epoch 5: 0.0564 0.0230 0.5581
Cf: [[3421 1241]
 [  63   39]]
Epoch: 5/15
Train loss:0.1408, Valid loss:0.1057
Val metric mean prob: 0.0281
Best metric at epoch 6: 0.0786 0.0400 0.5634
Cf: [[4202  460]
 [  79   23]]
Model improve: 0.0705 -> 0.0786
Epoch: 6/15
Train loss:0.1371, Valid loss:0.1084
Val metric mean prob: 0.0309
Best metric at epoch 7: 0.0819 0.0510 0.5898
Cf: [[3991  671]
 [  69   33]]
Model improve: 0.0786 -> 0.0819
Epoch: 7/15
Date :01/16/2023, 23:11:47
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Train loss:0.1684, Valid loss:0.1017
Val metric mean prob: 0.0273
Best metric at epoch 2: 0.1137 0.0340 0.6171
Cf: [[4200  462]
 [  68   34]]
Model improve: 0.0000 -> 0.1137
Epoch: 2/15
Train loss:0.1372, Valid loss:0.1026
Val metric mean prob: 0.0267
Best metric at epoch 3: 0.0801 0.0310 0.5972
Cf: [[3877  785]
 [  65   37]]
Epoch: 3/15
Date :01/17/2023, 02:26:23
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Date :01/17/2023, 02:29:26
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1280, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1280, min_width=1280, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=128, max_w_size=128),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Date :01/17/2023, 02:31:30
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1280, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1280, min_width=1280, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=128, max_w_size=128),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Date :01/17/2023, 02:35:59
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/17/2023, 02:56:45
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/17/2023, 02:59:18
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/17/2023, 03:01:15
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 32
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/17/2023, 03:01:40
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Train loss:0.1770, Valid loss:0.1115
Val metric mean prob: 0.0391
Best metric at epoch 2: 0.1098 0.1100 0.5384
Cf: [[4609   53]
 [  93    9]]
Model improve: 0.0000 -> 0.1098
Epoch: 2/30
Train loss:0.1287, Valid loss:0.0941
Val metric mean prob: 0.0967
Best metric at epoch 3: 0.3067 0.2090 0.6187
Cf: [[4626   36]
 [  77   25]]
Model improve: 0.1098 -> 0.3067
Epoch: 3/30
Train loss:0.1139, Valid loss:0.0884
Val metric mean prob: 0.1884
Best metric at epoch 4: 0.3936 0.2870 0.6761
Cf: [[4613   49]
 [  65   37]]
Model improve: 0.3067 -> 0.3936
Epoch: 4/30
Train loss:0.0991, Valid loss:0.0859
Val metric mean prob: 0.1842
Best metric at epoch 5: 0.3436 0.2850 0.6337
Cf: [[4629   33]
 [  74   28]]
Epoch: 5/30
Train loss:0.0956, Valid loss:0.0938
Val metric mean prob: 0.1987
Best metric at epoch 6: 0.3902 0.3140 0.6893
Cf: [[4599   63]
 [  62   40]]
Epoch: 6/30
Train loss:0.0891, Valid loss:0.0873
Val metric mean prob: 0.2101
Best metric at epoch 7: 0.4127 0.2070 0.6860
Cf: [[4614   48]
 [  63   39]]
Model improve: 0.3936 -> 0.4127
Epoch: 7/30
Train loss:0.0791, Valid loss:0.0884
Val metric mean prob: 0.2131
Best metric at epoch 8: 0.4045 0.2410 0.6722
Cf: [[4622   40]
 [  66   36]]
Epoch: 8/30
Train loss:0.0752, Valid loss:0.0899
Val metric mean prob: 0.2297
Best metric at epoch 9: 0.4550 0.3060 0.7061
Cf: [[4618   44]
 [  59   43]]
Model improve: 0.4127 -> 0.4550
Epoch: 9/30
Train loss:0.0686, Valid loss:0.0976
Val metric mean prob: 0.2390
Best metric at epoch 10: 0.4497 0.4130 0.6832
Cf: [[4633   29]
 [  64   38]]
Epoch: 10/30
Train loss:0.0604, Valid loss:0.0981
Val metric mean prob: 0.2533
Best metric at epoch 11: 0.4079 0.4420 0.6499
Cf: [[4643   19]
 [  71   31]]
Epoch: 11/30
Train loss:0.0545, Valid loss:0.1046
Val metric mean prob: 0.2357
Best metric at epoch 12: 0.4054 0.2870 0.6453
Cf: [[4646   16]
 [  72   30]]
Epoch: 12/30
Train loss:0.0509, Valid loss:0.1070
Val metric mean prob: 0.2705
Best metric at epoch 13: 0.4606 0.3680 0.6836
Cf: [[4637   25]
 [  64   38]]
Model improve: 0.4550 -> 0.4606
Epoch: 13/30
Train loss:0.0427, Valid loss:0.1084
Val metric mean prob: 0.2617
Best metric at epoch 14: 0.4192 0.3000 0.6684
Cf: [[4632   30]
 [  67   35]]
Epoch: 14/30
Date :01/17/2023, 08:30:44
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=640, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :13
Epoch: 1/13
Date :01/17/2023, 08:31:40
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=800, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :13
Epoch: 1/13
Date :01/17/2023, 08:32:50
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :13
Epoch: 1/13
Date :01/17/2023, 08:33:34
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=900, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :13
Epoch: 1/13
Date :01/17/2023, 08:35:30
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :13
Epoch: 1/13
Train loss:0.1791, Valid loss:0.1047
Val metric mean prob: 0.0274
Best metric at epoch 2: 0.0575 0.0280 0.5671
Cf: [[3277 1385]
 [  58   44]]
Model improve: 0.0000 -> 0.0575
Epoch: 2/13
Train loss:0.1277, Valid loss:0.0999
Val metric mean prob: 0.0474
Best metric at epoch 3: 0.1515 0.0600 0.6726
Cf: [[4215  447]
 [  57   45]]
Model improve: 0.0575 -> 0.1515
Epoch: 3/13
Train loss:0.1231, Valid loss:0.0869
Val metric mean prob: 0.1131
Best metric at epoch 4: 0.3584 0.1090 0.6477
Cf: [[4622   40]
 [  71   31]]
Model improve: 0.1515 -> 0.3584
Epoch: 4/13
Train loss:0.1166, Valid loss:0.0872
Val metric mean prob: 0.1610
Best metric at epoch 5: 0.3425 0.2270 0.6468
Cf: [[4614   48]
 [  71   31]]
Epoch: 5/13
Train loss:0.1040, Valid loss:0.0860
Val metric mean prob: 0.2083
Best metric at epoch 6: 0.4161 0.3490 0.6502
Cf: [[4646   16]
 [  71   31]]
Model improve: 0.3584 -> 0.4161
Epoch: 6/13
Train loss:0.1038, Valid loss:0.0865
Val metric mean prob: 0.1881
Best metric at epoch 7: 0.3742 0.2620 0.6396
Cf: [[4638   24]
 [  73   29]]
Epoch: 7/13
Date :01/17/2023, 13:53:43
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :13
Epoch: 1/13
Train loss:0.1693, Valid loss:0.1042
Val metric mean prob: 0.0379
Best metric at epoch 2: 0.0973 0.0950 0.5427
Cf: [[4551  115]
 [  89   11]]
Model improve: 0.0000 -> 0.0973
Epoch: 2/13
Train loss:0.1284, Valid loss:0.0949
Val metric mean prob: 0.0454
Best metric at epoch 3: 0.1710 0.0660 0.6379
Cf: [[4413  253]
 [  67   33]]
Model improve: 0.0973 -> 0.1710
Epoch: 3/13
Train loss:0.1265, Valid loss:0.0936
Val metric mean prob: 0.0609
Best metric at epoch 4: 0.2733 0.0680 0.6058
Cf: [[4627   39]
 [  78   22]]
Model improve: 0.1710 -> 0.2733
Epoch: 4/13
Train loss:0.1213, Valid loss:0.0955
Val metric mean prob: 0.1161
Best metric at epoch 5: 0.3092 0.2240 0.6520
Cf: [[4591   75]
 [  68   32]]
Model improve: 0.2733 -> 0.3092
Epoch: 5/13
Train loss:0.1094, Valid loss:0.0909
Val metric mean prob: 0.1409
Best metric at epoch 6: 0.2957 0.1510 0.6597
Cf: [[4570   96]
 [  66   34]]
Epoch: 6/13
Train loss:0.1063, Valid loss:0.0892
Val metric mean prob: 0.1583
Best metric at epoch 7: 0.3457 0.2870 0.6364
Cf: [[4632   34]
 [  72   28]]
Model improve: 0.3092 -> 0.3457
Epoch: 7/13
Train loss:0.1053, Valid loss:0.0895
Val metric mean prob: 0.1597
Best metric at epoch 8: 0.3571 0.1870 0.7135
Cf: [[4559  107]
 [  55   45]]
Model improve: 0.3457 -> 0.3571
Epoch: 8/13
Train loss:0.1002, Valid loss:0.0866
Val metric mean prob: 0.1779
Best metric at epoch 9: 0.3871 0.2510 0.6746
Cf: [[4616   50]
 [  64   36]]
Model improve: 0.3571 -> 0.3871
Epoch: 9/13
Train loss:0.0874, Valid loss:0.0840
Val metric mean prob: 0.2125
Best metric at epoch 10: 0.3713 0.1530 0.7100
Cf: [[4573   93]
 [  56   44]]
Epoch: 10/13
Train loss:0.0921, Valid loss:0.0865
Val metric mean prob: 0.2069
Best metric at epoch 11: 0.3842 0.2310 0.6654
Cf: [[4623   43]
 [  66   34]]
Epoch: 11/13
Train loss:0.0805, Valid loss:0.0858
Val metric mean prob: 0.2053
Best metric at epoch 12: 0.3923 0.1550 0.6977
Cf: [[4598   68]
 [  59   41]]
Model improve: 0.3871 -> 0.3923
Epoch: 12/13
Date :01/18/2023, 00:13:56
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Train loss:0.1863, Valid loss:0.1023
Val metric mean prob: 0.0329
Best metric at epoch 2: 0.0817 0.0500 0.5902
Cf: [[4015  651]
 [  68   32]]
Model improve: 0.0000 -> 0.0817
Epoch: 2/30
Train loss:0.1234, Valid loss:0.0895
Val metric mean prob: 0.0801
Best metric at epoch 3: 0.2763 0.1420 0.6017
Cf: [[4635   31]
 [  79   21]]
Model improve: 0.0817 -> 0.2763
Epoch: 3/30
Train loss:0.1186, Valid loss:0.0888
Val metric mean prob: 0.1008
Best metric at epoch 4: 0.3375 0.1090 0.6315
Cf: [[4633   33]
 [  73   27]]
Model improve: 0.2763 -> 0.3375
Epoch: 4/30
Train loss:0.1135, Valid loss:0.0844
Val metric mean prob: 0.1442
Best metric at epoch 5: 0.3388 0.1500 0.6494
Cf: [[4614   52]
 [  69   31]]
Model improve: 0.3375 -> 0.3388
Epoch: 5/30
Date :01/18/2023, 04:01:24
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/18/2023, 04:02:53
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/18/2023, 04:04:36
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/18/2023, 04:07:57
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Train loss:0.4985, Valid loss:0.2369
Val metric mean prob: 0.0715
Best metric at epoch 2: 0.2516 0.5240 0.5958
Cf: [[4627   39]
 [  80   20]]
Model improve: 0.0000 -> 0.2516
Epoch: 2/30
Train loss:0.2895, Valid loss:0.1443
Val metric mean prob: 0.1092
Best metric at epoch 3: 0.3311 0.4780 0.6222
Cf: [[4640   26]
 [  75   25]]
Model improve: 0.2516 -> 0.3311
Epoch: 3/30
Train loss:0.2435, Valid loss:0.1107
Val metric mean prob: 0.1357
Best metric at epoch 4: 0.3860 0.3800 0.6609
Cf: [[4628   38]
 [  67   33]]
Model improve: 0.3311 -> 0.3860
Epoch: 4/30
Train loss:0.2105, Valid loss:0.1218
Val metric mean prob: 0.1557
Best metric at epoch 5: 0.4000 0.5020 0.6570
Cf: [[4638   28]
 [  68   32]]
Model improve: 0.3860 -> 0.4000
Epoch: 5/30
Train loss:0.1874, Valid loss:0.1178
Val metric mean prob: 0.1802
Best metric at epoch 6: 0.3673 0.4610 0.6736
Cf: [[4606   60]
 [  64   36]]
Epoch: 6/30
Date :01/18/2023, 12:13:30
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 1e-05
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/18/2023, 12:14:06
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Train loss:0.6283, Valid loss:0.3965
Val metric mean prob: 0.0524
Best metric at epoch 2: 0.2207 0.5900 0.5769
Cf: [[4637   29]
 [  84   16]]
Model improve: 0.0000 -> 0.2207
Epoch: 2/30
Train loss:0.3591, Valid loss:0.1965
Val metric mean prob: 0.0945
Best metric at epoch 3: 0.2857 0.4820 0.6371
Cf: [[4592   74]
 [  71   29]]
Model improve: 0.2207 -> 0.2857
Epoch: 3/30
Train loss:0.2565, Valid loss:0.1154
Val metric mean prob: 0.1197
Best metric at epoch 4: 0.3057 0.4270 0.6165
Cf: [[4633   33]
 [  76   24]]
Model improve: 0.2857 -> 0.3057
Epoch: 4/30
Train loss:0.2165, Valid loss:0.1390
Val metric mean prob: 0.1575
Best metric at epoch 5: 0.3521 0.4320 0.7221
Cf: [[4546  120]
 [  53   47]]
Model improve: 0.3057 -> 0.3521
Epoch: 5/30
Train loss:0.1897, Valid loss:0.1136
Val metric mean prob: 0.1809
Best metric at epoch 6: 0.3592 0.4450 0.6776
Cf: [[4597   69]
 [  63   37]]
Model improve: 0.3521 -> 0.3592
Epoch: 6/30
Train loss:0.1674, Valid loss:0.1227
Val metric mean prob: 0.1863
Best metric at epoch 7: 0.3663 0.4790 0.6780
Cf: [[4601   65]
 [  63   37]]
Model improve: 0.3592 -> 0.3663
Epoch: 7/30
Train loss:0.1437, Valid loss:0.0992
Val metric mean prob: 0.1979
Best metric at epoch 8: 0.3858 0.3460 0.6837
Cf: [[4607   59]
 [  62   38]]
Model improve: 0.3663 -> 0.3858
Epoch: 8/30
Train loss:0.1190, Valid loss:0.1304
Val metric mean prob: 0.1962
Best metric at epoch 9: 0.3659 0.5180 0.6464
Cf: [[4632   34]
 [  70   30]]
Epoch: 9/30
Train loss:0.1026, Valid loss:0.1093
Val metric mean prob: 0.1969
Best metric at epoch 10: 0.3356 0.4830 0.6224
Cf: [[4642   24]
 [  75   25]]
Epoch: 10/30
Train loss:0.0912, Valid loss:0.1151
Val metric mean prob: 0.2184
Best metric at epoch 11: 0.3556 0.5840 0.6188
Cf: [[4655   11]
 [  76   24]]
Epoch: 11/30
Train loss:0.0783, Valid loss:0.1135
Val metric mean prob: 0.2174
Best metric at epoch 12: 0.3171 0.4490 0.6259
Cf: [[4628   38]
 [  74   26]]
Epoch: 12/30
Date :01/18/2023, 21:55:35
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :30
Epoch: 1/30
Date :01/18/2023, 21:56:06
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :13
Epoch: 1/13
Train loss:0.6328, Valid loss:0.3448
Val metric mean prob: 0.0445
Best metric at epoch 2: 0.0983 0.3390 0.6102
Cf: [[4108  558]
 [  66   34]]
Model improve: 0.0000 -> 0.0983
Epoch: 2/13
Train loss:0.3771, Valid loss:0.1442
Val metric mean prob: 0.0851
Best metric at epoch 3: 0.2400 0.3350 0.5992
Cf: [[4612   54]
 [  79   21]]
Model improve: 0.0983 -> 0.2400
Epoch: 3/13
Date :01/19/2023, 07:53:06
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :30
Epoch: 1/30
Train loss:0.6324, Valid loss:0.3389
Val metric mean prob: 0.0464
Best metric at epoch 2: 0.1271 0.4030 0.5894
Cf: [[4427  239]
 [  77   23]]
Model improve: 0.0000 -> 0.1271
Epoch: 2/30
Date :01/19/2023, 09:37:15
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :10
Epoch: 1/10
Train loss:0.3608, Valid loss:0.1325
Val metric mean prob: 0.0654
Best metric at epoch 2: 0.2484 0.2830 0.5914
Cf: [[4632   34]
 [  81   19]]
Model improve: 0.0000 -> 0.2484
Epoch: 2/10
Train loss:0.2913, Valid loss:0.1343
Val metric mean prob: 0.1237
Best metric at epoch 3: 0.3457 0.5060 0.6364
Cf: [[4632   34]
 [  72   28]]
Model improve: 0.2484 -> 0.3457
Epoch: 3/10
Train loss:0.2363, Valid loss:0.1201
Val metric mean prob: 0.1267
Best metric at epoch 4: 0.3195 0.4090 0.6305
Cf: [[4624   42]
 [  73   27]]
Epoch: 4/10
Train loss:0.1970, Valid loss:0.1507
Val metric mean prob: 0.1516
Best metric at epoch 5: 0.3028 0.4910 0.6559
Cf: [[4581   85]
 [  67   33]]
Epoch: 5/10
Train loss:0.1559, Valid loss:0.1087
Val metric mean prob: 0.2053
Best metric at epoch 6: 0.3182 0.3160 0.6659
Cf: [[4581   85]
 [  65   35]]
Epoch: 6/10
Train loss:0.1209, Valid loss:0.1404
Val metric mean prob: 0.1810
Best metric at epoch 7: 0.3234 0.4950 0.6307
Cf: [[4626   40]
 [  73   27]]
Epoch: 7/10
Date :01/19/2023, 16:46:21
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :10
Epoch: 1/10
Date :01/19/2023, 16:46:43
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Train loss:0.3523, Valid loss:0.1290
Val metric mean prob: 0.0679
Best metric at epoch 2: 0.1676 0.2990 0.5681
Cf: [[4602   64]
 [  85   15]]
Model improve: 0.0000 -> 0.1676
Epoch: 2/10
Train loss:0.2823, Valid loss:0.1256
Val metric mean prob: 0.1200
Best metric at epoch 3: 0.2471 0.3170 0.6464
Cf: [[4539  127]
 [  68   32]]
Model improve: 0.1676 -> 0.2471
Epoch: 3/10
Train loss:0.2535, Valid loss:0.1628
Val metric mean prob: 0.1587
Best metric at epoch 4: 0.3818 0.5400 0.7016
Cf: [[4588   78]
 [  58   42]]
Model improve: 0.2471 -> 0.3818
Epoch: 4/10
Train loss:0.2189, Valid loss:0.1085
Val metric mean prob: 0.1963
Best metric at epoch 5: 0.3704 0.3210 0.7145
Cf: [[4568   98]
 [  55   45]]
Epoch: 5/10
Train loss:0.1918, Valid loss:0.1343
Val metric mean prob: 0.1645
Best metric at epoch 6: 0.3665 0.4830 0.6690
Cf: [[4610   56]
 [  65   35]]
Epoch: 6/10
Train loss:0.1530, Valid loss:0.1313
Val metric mean prob: 0.1984
Best metric at epoch 7: 0.3529 0.4950 0.6592
Cf: [[4612   54]
 [  67   33]]
Epoch: 7/10
Train loss:0.1257, Valid loss:0.1149
Val metric mean prob: 0.2243
Best metric at epoch 8: 0.3758 0.3580 0.6514
Cf: [[4632   34]
 [  69   31]]
Epoch: 8/10
Train loss:0.1070, Valid loss:0.1329
Val metric mean prob: 0.2171
Best metric at epoch 9: 0.3750 0.4880 0.6468
Cf: [[4636   30]
 [  70   30]]
Epoch: 9/10
Date :01/20/2023, 00:23:32
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Train loss:0.1683, Valid loss:0.1022
Val metric mean prob: 0.0274
Best metric at epoch 2: 0.0647 0.0470 0.5358
Cf: [[4347  319]
 [  86   14]]
Model improve: 0.0000 -> 0.0647
Epoch: 2/10
Train loss:0.1300, Valid loss:0.0977
Val metric mean prob: 0.0341
Best metric at epoch 3: 0.0995 0.0450 0.6200
Cf: [[4059  607]
 [  63   37]]
Model improve: 0.0647 -> 0.0995
Epoch: 3/10
Train loss:0.1290, Valid loss:0.0939
Val metric mean prob: 0.0476
Best metric at epoch 4: 0.2083 0.0440 0.6739
Cf: [[4422  244]
 [  60   40]]
Model improve: 0.0995 -> 0.2083
Epoch: 4/10
Train loss:0.1249, Valid loss:0.0954
Val metric mean prob: 0.1009
Best metric at epoch 5: 0.2800 0.2630 0.6019
Cf: [[4637   29]
 [  79   21]]
Model improve: 0.2083 -> 0.2800
Epoch: 5/10
Train loss:0.1130, Valid loss:0.0855
Val metric mean prob: 0.1514
Best metric at epoch 6: 0.3699 0.2740 0.6330
Cf: [[4647   19]
 [  73   27]]
Model improve: 0.2800 -> 0.3699
Epoch: 6/10
Train loss:0.1070, Valid loss:0.0928
Val metric mean prob: 0.1700
Best metric at epoch 7: 0.3401 0.3760 0.6226
Cf: [[4644   22]
 [  75   25]]
Epoch: 7/10
Train loss:0.1068, Valid loss:0.0941
Val metric mean prob: 0.1860
Best metric at epoch 8: 0.3816 0.4040 0.6425
Cf: [[4643   23]
 [  71   29]]
Model improve: 0.3699 -> 0.3816
Epoch: 8/10
Date :01/20/2023, 07:37:09
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 44699
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Date :01/20/2023, 07:38:28
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 44699
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Fold: 4
Len train df: 44699
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Fold: 4
Len train df: 44699
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Fold: 4
Len train df: 43761
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :10
Epoch: 1/10
Date :01/20/2023, 07:43:00
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 44699
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0005
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Date :01/20/2023, 07:43:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 44699
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0005
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Train loss:0.1911, Valid loss:0.1064
Val metric mean prob: 0.0269
Best metric at epoch 1: 0.0429 0.0330 0.5484
Cf: [[1206 3467]
 [  15   78]]
Model improve: 0.0000 -> 0.0429
Epoch: 2/15
Train loss:0.1735, Valid loss:0.1172
Val metric mean prob: 0.0338
Best metric at epoch 2: 0.0874 0.0800 0.6101
Cf: [[4044  629]
 [  60   33]]
Model improve: 0.0429 -> 0.0874
Epoch: 3/15
Train loss:0.1734, Valid loss:0.1039
Val metric mean prob: 0.0315
Best metric at epoch 3: 0.0747 0.0630 0.5728
Cf: [[4147  526]
 [  69   24]]
Epoch: 4/15
Date :01/20/2023, 09:08:17
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 44699
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2118, Valid loss:0.1025
Val metric mean prob: 0.0353
Best metric at epoch 1: 0.0989 0.0990 0.5531
Cf: [[4516  157]
 [  80   13]]
Model improve: 0.0000 -> 0.0989
Epoch: 2/15
Train loss:0.1582, Valid loss:0.1052
Val metric mean prob: 0.0895
Best metric at epoch 2: 0.2798 0.2570 0.6374
Cf: [[4600   73]
 [  66   27]]
Model improve: 0.0989 -> 0.2798
Epoch: 3/15
Train loss:0.1413, Valid loss:0.0932
Val metric mean prob: 0.1477
Best metric at epoch 3: 0.3353 0.3110 0.6456
Cf: [[4627   46]
 [  65   28]]
Model improve: 0.2798 -> 0.3353
Epoch: 4/15
Train loss:0.1292, Valid loss:0.0895
Val metric mean prob: 0.1338
Best metric at epoch 4: 0.3768 0.2920 0.6378
Cf: [[4654   19]
 [  67   26]]
Model improve: 0.3353 -> 0.3768
Epoch: 5/15
Train loss:0.1215, Valid loss:0.0878
Val metric mean prob: 0.1606
Best metric at epoch 5: 0.3529 0.3060 0.6563
Cf: [[4626   47]
 [  63   30]]
Epoch: 6/15
Train loss:0.1132, Valid loss:0.0869
Val metric mean prob: 0.2060
Best metric at epoch 6: 0.3727 0.2790 0.6572
Cf: [[4635   38]
 [  63   30]]
Epoch: 7/15
Train loss:0.1015, Valid loss:0.0920
Val metric mean prob: 0.1788
Best metric at epoch 7: 0.3537 0.3080 0.6368
Cf: [[4645   28]
 [  67   26]]
Epoch: 8/15
Train loss:0.0886, Valid loss:0.0954
Val metric mean prob: 0.2020
Best metric at epoch 8: 0.3537 0.3270 0.6514
Cf: [[4631   42]
 [  64   29]]
Epoch: 9/15
Date :01/20/2023, 13:27:49
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 43761
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/20/2023, 13:48:02
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/20/2023, 13:49:23
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:1.2621, Valid loss:0.1040
Val metric mean prob: 0.0204
Best metric at epoch 1: 0.0572 0.0240 0.5530
Cf: [[3714  952]
 [  69   31]]
Model improve: 0.0000 -> 0.0572
Epoch: 2/15
Train loss:0.7845, Valid loss:0.1023
Val metric mean prob: 0.0224
Best metric at epoch 2: 0.0696 0.0180 0.6040
Cf: [[3490 1176]
 [  54   46]]
Model improve: 0.0572 -> 0.0696
Epoch: 3/15
Train loss:0.7701, Valid loss:0.0913
Val metric mean prob: 0.0633
Best metric at epoch 3: 0.2588 0.0640 0.6519
Cf: [[4544  122]
 [  67   33]]
Model improve: 0.0696 -> 0.2588
Epoch: 4/15
Train loss:0.6783, Valid loss:0.0914
Val metric mean prob: 0.0959
Best metric at epoch 4: 0.2591 0.1150 0.6477
Cf: [[4551  115]
 [  68   32]]
Model improve: 0.2588 -> 0.2591
Epoch: 5/15
Train loss:0.6759, Valid loss:0.0900
Val metric mean prob: 0.1530
Best metric at epoch 5: 0.2909 0.2630 0.6156
Cf: [[4625   41]
 [  76   24]]
Model improve: 0.2591 -> 0.2909
Epoch: 6/15
Date :01/20/2023, 16:08:32
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:1.7716, Valid loss:0.1006
Val metric mean prob: 0.0304
Best metric at epoch 1: 0.1207 0.0490 0.5807
Cf: [[4439  227]
 [  79   21]]
Model improve: 0.0000 -> 0.1207
Epoch: 2/15
Train loss:1.2450, Valid loss:0.1024
Val metric mean prob: 0.0931
Best metric at epoch 2: 0.2550 0.2760 0.5918
Cf: [[4636   30]
 [  81   19]]
Model improve: 0.1207 -> 0.2550
Epoch: 3/15
Train loss:1.1060, Valid loss:0.0891
Val metric mean prob: 0.1412
Best metric at epoch 3: 0.3077 0.2230 0.6342
Cf: [[4612   54]
 [  72   28]]
Model improve: 0.2550 -> 0.3077
Epoch: 4/15
Train loss:1.0069, Valid loss:0.0915
Val metric mean prob: 0.1734
Best metric at epoch 4: 0.3146 0.2760 0.6346
Cf: [[4616   50]
 [  72   28]]
Model improve: 0.3077 -> 0.3146
Epoch: 5/15
Train loss:0.9313, Valid loss:0.0895
Val metric mean prob: 0.1936
Best metric at epoch 5: 0.3349 0.1810 0.6671
Cf: [[4592   74]
 [  65   35]]
Model improve: 0.3146 -> 0.3349
Epoch: 6/15
Train loss:0.8828, Valid loss:0.0878
Val metric mean prob: 0.2026
Best metric at epoch 6: 0.3822 0.3590 0.6471
Cf: [[4639   27]
 [  70   30]]
Model improve: 0.3349 -> 0.3822
Epoch: 7/15
Train loss:0.7466, Valid loss:0.1032
Val metric mean prob: 0.2211
Best metric at epoch 7: 0.3704 0.3230 0.6919
Cf: [[4590   76]
 [  60   40]]
Epoch: 8/15
Train loss:0.6962, Valid loss:0.1105
Val metric mean prob: 0.2213
Best metric at epoch 8: 0.4026 0.4900 0.6525
Cf: [[4643   23]
 [  69   31]]
Model improve: 0.3822 -> 0.4026
Epoch: 9/15
Train loss:0.6301, Valid loss:0.0958
Val metric mean prob: 0.2333
Best metric at epoch 9: 0.3875 0.3040 0.6519
Cf: [[4637   29]
 [  69   31]]
Epoch: 10/15
Train loss:0.5499, Valid loss:0.1076
Val metric mean prob: 0.2546
Best metric at epoch 10: 0.3946 0.4850 0.6431
Cf: [[4648   18]
 [  71   29]]
Epoch: 11/15
Train loss:0.4595, Valid loss:0.1144
Val metric mean prob: 0.2306
Best metric at epoch 11: 0.3368 0.3040 0.6538
Cf: [[4608   58]
 [  68   32]]
Epoch: 12/15
Train loss:0.4090, Valid loss:0.1206
Val metric mean prob: 0.2244
Best metric at epoch 12: 0.3453 0.4800 0.6184
Cf: [[4651   15]
 [  76   24]]
Epoch: 13/15
Train loss:0.3838, Valid loss:0.1160
Val metric mean prob: 0.2310
Best metric at epoch 13: 0.3562 0.4030 0.6279
Cf: [[4646   20]
 [  74   26]]
Epoch: 14/15
Train loss:0.3556, Valid loss:0.1182
Val metric mean prob: 0.2333
Best metric at epoch 14: 0.3497 0.4330 0.6231
Cf: [[4648   18]
 [  75   25]]
Epoch: 15/15
Train loss:0.3321, Valid loss:0.1170
Val metric mean prob: 0.2351
Best metric at epoch 15: 0.3537 0.4580 0.6277
Cf: [[4645   21]
 [  74   26]]
Fold: 1
Len train df: 43827
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/20/2023, 22:51:25
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Date :01/20/2023, 22:51:51
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:1.7875, Valid loss:0.1009
Val metric mean prob: 0.0278
Best metric at epoch 1: 0.1538 0.0440 0.5627
Cf: [[4598   68]
 [  86   14]]
Model improve: 0.0000 -> 0.1538
Epoch: 2/15
Train loss:1.2281, Valid loss:0.0889
Val metric mean prob: 0.0903
Best metric at epoch 2: 0.2902 0.1090 0.6330
Cf: [[4601   65]
 [  72   28]]
Model improve: 0.1538 -> 0.2902
Epoch: 3/15
Train loss:1.0939, Valid loss:0.0901
Val metric mean prob: 0.1500
Best metric at epoch 3: 0.3429 0.3490 0.6183
Cf: [[4650   16]
 [  76   24]]
Model improve: 0.2902 -> 0.3429
Epoch: 4/15
Train loss:1.0155, Valid loss:0.0872
Val metric mean prob: 0.1718
Best metric at epoch 4: 0.3333 0.4050 0.6089
Cf: [[4656   10]
 [  78   22]]
Epoch: 5/15
Train loss:0.9277, Valid loss:0.0911
Val metric mean prob: 0.1743
Best metric at epoch 5: 0.3396 0.2290 0.6719
Cf: [[4590   76]
 [  64   36]]
Epoch: 6/15
Date :01/21/2023, 01:17:00
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1280, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1280, min_width=1280, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=128, max_w_size=128),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/21/2023, 01:18:18
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1280, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1280, min_width=1280, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=128, max_w_size=128),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/21/2023, 01:19:06
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1440, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1440, min_width=1440, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=144, max_w_size=144),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/21/2023, 02:21:47
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1440, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1440, min_width=1440, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=144, max_w_size=144),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Fold: 0
Len train df: 100
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/21/2023, 02:22:38
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1440, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1440, min_width=1440, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=144, max_w_size=144),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 100
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.6361, Valid loss:0.4745
Val metric mean prob: 0.0689
Best metric at epoch 1: 0.1333 0.3960 0.6094
Cf: [[104  23]
 [  3   2]]
Model improve: 0.0000 -> 0.1333
Epoch: 2/15
Fold: 0
Len train df: 100
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.6361, Valid loss:0.4745
Val metric mean prob: 0.0689
Best metric at epoch 1: 0.1333 0.3960 0.6094
Cf: [[104  23]
 [  3   2]]
Model improve: 0.0000 -> 0.1333
Epoch: 2/15
Date :01/21/2023, 02:26:58
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1440, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1440, min_width=1440, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=144, max_w_size=144),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 43727
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/21/2023, 02:54:25
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1440, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1440, min_width=1440, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=144, max_w_size=144),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/21/2023, 04:09:04
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1440, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1440, min_width=1440, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=144, max_w_size=144),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.1585, Valid loss:0.1023
Val metric mean prob: 0.0329
Best metric at epoch 1: 0.0978 0.0440 0.6099
Cf: [[4105  561]
 [  66   34]]
Model improve: 0.0000 -> 0.0978
Epoch: 2/15
Train loss:0.1294, Valid loss:0.0979
Val metric mean prob: 0.0401
Best metric at epoch 2: 0.1212 0.0620 0.5641
Cf: [[4518  148]
 [  84   16]]
Model improve: 0.0978 -> 0.1212
Epoch: 3/15
Train loss:0.1197, Valid loss:0.1097
Val metric mean prob: 0.1098
Best metric at epoch 3: 0.2564 0.3590 0.5961
Cf: [[4630   36]
 [  80   20]]
Model improve: 0.1212 -> 0.2564
Epoch: 4/15
Train loss:0.1151, Valid loss:0.0888
Val metric mean prob: 0.1625
Best metric at epoch 4: 0.3436 0.1920 0.6856
Cf: [[4578   88]
 [  61   39]]
Model improve: 0.2564 -> 0.3436
Epoch: 5/15
Date :01/21/2023, 08:29:38
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1024, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/21/2023, 08:30:36
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1024, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2070, Valid loss:0.0995
Val metric mean prob: 0.0448
Best metric at epoch 1: 0.1311 0.0790 0.6184
Cf: [[4324  342]
 [  69   31]]
Model improve: 0.0000 -> 0.1311
Epoch: 2/15
Train loss:0.1521, Valid loss:0.0885
Val metric mean prob: 0.1047
Best metric at epoch 2: 0.2759 0.1910 0.6146
Cf: [[4616   50]
 [  76   24]]
Model improve: 0.1311 -> 0.2759
Epoch: 3/15
Train loss:0.1346, Valid loss:0.0909
Val metric mean prob: 0.1971
Best metric at epoch 3: 0.3358 0.4640 0.6135
Cf: [[4652   14]
 [  77   23]]
Model improve: 0.2759 -> 0.3358
Epoch: 4/15
Train loss:0.1245, Valid loss:0.0922
Val metric mean prob: 0.1789
Best metric at epoch 4: 0.3125 0.2530 0.6655
Cf: [[4577   89]
 [  65   35]]
Epoch: 5/15
Train loss:0.1134, Valid loss:0.0924
Val metric mean prob: 0.1937
Best metric at epoch 5: 0.3421 0.3990 0.6272
Cf: [[4640   26]
 [  74   26]]
Model improve: 0.3358 -> 0.3421
Epoch: 6/15
Train loss:0.0999, Valid loss:0.0887
Val metric mean prob: 0.2100
Best metric at epoch 6: 0.4192 0.3130 0.6716
Cf: [[4634   32]
 [  65   35]]
Model improve: 0.3421 -> 0.4192
Epoch: 7/15
Train loss:0.0841, Valid loss:0.0970
Val metric mean prob: 0.2096
Best metric at epoch 7: 0.3688 0.4380 0.6284
Cf: [[4651   15]
 [  74   26]]
Epoch: 8/15
Train loss:0.0674, Valid loss:0.1222
Val metric mean prob: 0.2039
Best metric at epoch 8: 0.3514 0.4130 0.6861
Cf: [[4583   83]
 [  61   39]]
Epoch: 9/15
Date :01/21/2023, 12:02:37
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1024, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 45577
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2630, Valid loss:0.1150
Val metric mean prob: 0.0467
Best metric at epoch 1: 0.1328 0.1510 0.5736
Cf: [[4513  153]
 [  82   18]]
Model improve: 0.0000 -> 0.1328
Epoch: 2/15
Train loss:0.2020, Valid loss:0.1158
Val metric mean prob: 0.1061
Best metric at epoch 2: 0.3483 0.2810 0.6679
Cf: [[4600   66]
 [  65   35]]
Model improve: 0.1328 -> 0.3483
Epoch: 3/15
Train loss:0.1752, Valid loss:0.1006
Val metric mean prob: 0.1532
Best metric at epoch 3: 0.3415 0.3240 0.6675
Cf: [[4596   70]
 [  65   35]]
Epoch: 4/15
Train loss:0.1548, Valid loss:0.0917
Val metric mean prob: 0.1946
Best metric at epoch 4: 0.3285 0.2950 0.6622
Cf: [[4593   73]
 [  66   34]]
Epoch: 5/15
Train loss:0.1378, Valid loss:0.0857
Val metric mean prob: 0.1943
Best metric at epoch 5: 0.3952 0.1950 0.6614
Cf: [[4632   34]
 [  67   33]]
Model improve: 0.3483 -> 0.3952
Epoch: 6/15
Train loss:0.1201, Valid loss:0.1015
Val metric mean prob: 0.2052
Best metric at epoch 6: 0.4064 0.3950 0.6847
Cf: [[4617   49]
 [  62   38]]
Model improve: 0.3952 -> 0.4064
Epoch: 7/15
Train loss:0.1049, Valid loss:0.0965
Val metric mean prob: 0.2268
Best metric at epoch 7: 0.3953 0.3830 0.6659
Cf: [[4628   38]
 [  66   34]]
Epoch: 8/15
Train loss:0.0861, Valid loss:0.1072
Val metric mean prob: 0.2294
Best metric at epoch 8: 0.3585 0.2180 0.6821
Cf: [[4592   74]
 [  62   38]]
Epoch: 9/15
Date :01/21/2023, 15:44:28
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1280, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1280, min_width=1280, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=128, max_w_size=128),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Date :01/21/2023, 15:44:46
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1280, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1280, min_width=1280, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=128, max_w_size=128),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Train loss:0.1995, Valid loss:0.1041
Val metric mean prob: 0.0345
Best metric at epoch 1: 0.0780 0.0570 0.5863
Cf: [[3978  688]
 [  68   32]]
Model improve: 0.0000 -> 0.0780
Epoch: 2/10
Train loss:0.1680, Valid loss:0.0990
Val metric mean prob: 0.0541
Best metric at epoch 2: 0.1437 0.0980 0.5939
Cf: [[4469  197]
 [  77   23]]
Model improve: 0.0780 -> 0.1437
Epoch: 3/10
Train loss:0.1585, Valid loss:0.1039
Val metric mean prob: 0.1280
Best metric at epoch 3: 0.2835 0.4700 0.5890
Cf: [[4657    9]
 [  82   18]]
Model improve: 0.1437 -> 0.2835
Epoch: 4/10
Train loss:0.1439, Valid loss:0.1000
Val metric mean prob: 0.1585
Best metric at epoch 4: 0.3205 0.4090 0.6217
Cf: [[4635   31]
 [  75   25]]
Model improve: 0.2835 -> 0.3205
Epoch: 5/10
Train loss:0.1326, Valid loss:0.0991
Val metric mean prob: 0.1706
Best metric at epoch 5: 0.3069 0.3120 0.6474
Cf: [[4595   71]
 [  69   31]]
Epoch: 6/10
Train loss:0.1229, Valid loss:0.0834
Val metric mean prob: 0.2017
Best metric at epoch 6: 0.4000 0.2480 0.6570
Cf: [[4638   28]
 [  68   32]]
Model improve: 0.3205 -> 0.4000
Epoch: 7/10
Train loss:0.1137, Valid loss:0.0864
Val metric mean prob: 0.2120
Best metric at epoch 7: 0.3895 0.2770 0.6793
Cf: [[4613   53]
 [  63   37]]
Epoch: 8/10
Train loss:0.1057, Valid loss:0.0877
Val metric mean prob: 0.2099
Best metric at epoch 8: 0.4145 0.2790 0.6943
Cf: [[4613   53]
 [  60   40]]
Model improve: 0.4000 -> 0.4145
Epoch: 9/10
Train loss:0.0992, Valid loss:0.0854
Val metric mean prob: 0.2252
Best metric at epoch 9: 0.4000 0.2870 0.6707
Cf: [[4626   40]
 [  65   35]]
Epoch: 10/10
Train loss:0.0962, Valid loss:0.0869
Val metric mean prob: 0.2228
Best metric at epoch 10: 0.3957 0.2690 0.6796
Cf: [[4616   50]
 [  63   37]]
Fold: 1
Len train df: 44750
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Date :01/22/2023, 00:11:43
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Train loss:0.2145, Valid loss:0.1046
Val metric mean prob: 0.0362
Best metric at epoch 1: 0.0886 0.0560 0.6290
Cf: [[3817  849]
 [  56   44]]
Model improve: 0.0000 -> 0.0886
Epoch: 2/10
Train loss:0.1609, Valid loss:0.0959
Val metric mean prob: 0.0938
Best metric at epoch 2: 0.2262 0.2090 0.6147
Cf: [[4570   96]
 [  75   25]]
Model improve: 0.0886 -> 0.2262
Epoch: 3/10
Train loss:0.1447, Valid loss:0.0963
Val metric mean prob: 0.1594
Best metric at epoch 3: 0.3949 0.3810 0.6522
Cf: [[4640   26]
 [  69   31]]
Model improve: 0.2262 -> 0.3949
Epoch: 4/10
Train loss:0.1322, Valid loss:0.0950
Val metric mean prob: 0.1732
Best metric at epoch 4: 0.3265 0.4840 0.6175
Cf: [[4643   23]
 [  76   24]]
Epoch: 5/10
Train loss:0.1213, Valid loss:0.0827
Val metric mean prob: 0.1870
Best metric at epoch 5: 0.3571 0.2570 0.6459
Cf: [[4628   38]
 [  70   30]]
Epoch: 6/10
Train loss:0.1099, Valid loss:0.0825
Val metric mean prob: 0.2035
Best metric at epoch 6: 0.4056 0.3230 0.6435
Cf: [[4652   14]
 [  71   29]]
Model improve: 0.3949 -> 0.4056
Epoch: 7/10
Train loss:0.1001, Valid loss:0.0864
Val metric mean prob: 0.2224
Best metric at epoch 7: 0.4000 0.3220 0.6524
Cf: [[4642   24]
 [  69   31]]
Epoch: 8/10
Date :01/22/2023, 00:12:01
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1024, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/22/2023, 00:22:36
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1024, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/22/2023, 00:25:52
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1024, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/22/2023, 00:26:24
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1024, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/22/2023, 00:40:12
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1024, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/22/2023, 00:41:04
train transformCompose([
  IsotropicResize(always_apply=False, p=1, max_side=1024, interpolation_down=3, interpolation_up=2),
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/22/2023, 00:44:24
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/22/2023, 00:44:53
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/22/2023, 00:45:34
train transformCompose([
  PadIfNeeded(always_apply=False, p=1.0, min_height=1024, min_width=1024, pad_height_divisor=None, pad_width_divisor=None, border_mode=0, value=None, mask_value=None),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:6.6803
Val metric mean prob: 0.0389
Fold: 0
Len train df: 44652
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0933
Val metric mean prob: 0.1706
Best metric at epoch 1: 0.3816 0.3760 0.6425
Cf: [[4643   23]
 [  71   29]]
Model improve: 0.0000 -> 0.3816
Date :01/22/2023, 06:37:40
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2087, Valid loss:0.1029
Val metric mean prob: 0.0408
Best metric at epoch 1: 0.1087 0.0750 0.6048
Cf: [[4244  422]
 [  70   30]]
Model improve: 0.0000 -> 0.1087
Fold: 0
Len train df: 100
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.6798, Valid loss:0.5635
Val metric mean prob: 0.0622
Best metric at epoch 1: 0.0816 0.4360 0.5454
Cf: [[128  41]
 [  4   2]]
Model improve: 0.0000 -> 0.0816
Epoch: 2/15
Date :01/22/2023, 08:04:35
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2087, Valid loss:0.1029
Val metric mean prob: 0.0408
Best metric at epoch 1: 0.1087 0.0750 0.6048
Cf: [[4244  422]
 [  70   30]]
Model improve: 0.0000 -> 0.1087
Epoch: 2/15
Train loss:0.1608, Valid loss:0.0966
Val metric mean prob: 0.1017
Best metric at epoch 2: 0.2158 0.1370 0.6341
Cf: [[4518  148]
 [  70   30]]
Model improve: 0.1087 -> 0.2158
Epoch: 3/15
Train loss:0.1442, Valid loss:0.0945
Val metric mean prob: 0.1681
Best metric at epoch 3: 0.3444 0.3170 0.6497
Cf: [[4617   49]
 [  69   31]]
Model improve: 0.2158 -> 0.3444
Epoch: 4/15
Date :01/22/2023, 13:47:15
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 4/15
Train loss:0.1314, Valid loss:0.0826
Val metric mean prob: 0.1935
Best metric at epoch 4: 0.4028 0.3290 0.6434
Cf: [[4651   15]
 [  71   29]]
Model improve: 0.0000 -> 0.4028
Date :01/22/2023, 18:33:01
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 4/15
Date :01/22/2023, 19:50:23
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2083, Valid loss:0.1014
Val metric mean prob: 0.0342
Best metric at epoch 1: 0.0873 0.0400 0.6327
Cf: [[3758  908]
 [  54   46]]
Model improve: 0.0000 -> 0.0873
Epoch: 2/15
Train loss:0.1646, Valid loss:0.0919
Val metric mean prob: 0.0741
Best metric at epoch 2: 0.2222 0.1320 0.6101
Cf: [[4574   92]
 [  76   24]]
Model improve: 0.0873 -> 0.2222
Epoch: 3/15
Train loss:0.1493, Valid loss:0.0984
Val metric mean prob: 0.1347
Best metric at epoch 3: 0.3669 0.3090 0.6509
Cf: [[4628   38]
 [  69   31]]
Model improve: 0.2222 -> 0.3669
Epoch: 4/15
Date :01/23/2023, 05:12:24
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 4/15
Date :01/23/2023, 05:14:44
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 4/15
Date :01/23/2023, 06:16:46
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 4/15
Train loss:0.1335, Valid loss:0.0799
Val metric mean prob: 0.1686
Best metric at epoch 4: 0.3689 0.1000 0.7144
Cf: [[4567   99]
 [  55   45]]
Model improve: 0.0000 -> 0.3689
Epoch: 5/15
Train loss:0.1174, Valid loss:0.0842
Val metric mean prob: 0.2191
Best metric at epoch 5: 0.4022 0.1770 0.6754
Cf: [[4623   43]
 [  64   36]]
Model improve: 0.3689 -> 0.4022
Epoch: 6/15
Date :01/23/2023, 07:55:54
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 4/15
Date :01/23/2023, 07:56:19
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 4/15
Train loss:0.2181, Valid loss:0.1136
Val metric mean prob: 0.0449
Best metric at epoch 4: 0.0964 0.1180 0.5771
Cf: [[4312  354]
 [  77   23]]
Model improve: 0.0000 -> 0.0964
Date :01/23/2023, 08:29:04
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2181, Valid loss:0.1136
Val metric mean prob: 0.0449
Best metric at epoch 1: 0.0964 0.1180 0.5771
Cf: [[4312  354]
 [  77   23]]
Model improve: 0.0000 -> 0.0964
Epoch: 2/15
Train loss:0.1571, Valid loss:0.0872
Val metric mean prob: 0.1265
Best metric at epoch 2: 0.3005 0.1650 0.6381
Cf: [[4602   64]
 [  71   29]]
Model improve: 0.0964 -> 0.3005
Epoch: 3/15
Train loss:0.1381, Valid loss:0.1040
Val metric mean prob: 0.1810
Best metric at epoch 3: 0.3846 0.4240 0.6700
Cf: [[4619   47]
 [  65   35]]
Model improve: 0.3005 -> 0.3846
Epoch: 4/15
Train loss:0.1256, Valid loss:0.0846
Val metric mean prob: 0.2161
Best metric at epoch 4: 0.4151 0.3520 0.6622
Cf: [[4640   26]
 [  67   33]]
Model improve: 0.3846 -> 0.4151
Epoch: 5/15
Train loss:0.1134, Valid loss:0.0806
Val metric mean prob: 0.2228
Best metric at epoch 5: 0.4757 0.2300 0.7389
Cf: [[4609   57]
 [  51   49]]
Model improve: 0.4151 -> 0.4757
Epoch: 6/15
Train loss:0.1034, Valid loss:0.0838
Val metric mean prob: 0.2073
Best metric at epoch 6: 0.4520 0.1280 0.6960
Cf: [[4629   37]
 [  60   40]]
Epoch: 7/15
Train loss:0.0946, Valid loss:0.0894
Val metric mean prob: 0.2484
Best metric at epoch 7: 0.4510 0.2660 0.7238
Cf: [[4608   58]
 [  54   46]]
Epoch: 8/15
Train loss:0.0824, Valid loss:0.0922
Val metric mean prob: 0.2635
Best metric at epoch 8: 0.4403 0.4150 0.6724
Cf: [[4642   24]
 [  65   35]]
Epoch: 9/15
Train loss:0.0726, Valid loss:0.0919
Val metric mean prob: 0.2851
Best metric at epoch 9: 0.4713 0.4300 0.6829
Cf: [[4646   20]
 [  63   37]]
Epoch: 10/15
Train loss:0.0610, Valid loss:0.1025
Val metric mean prob: 0.2970
Best metric at epoch 10: 0.4569 0.2590 0.7194
Cf: [[4614   52]
 [  55   45]]
Epoch: 11/15
Train loss:0.0519, Valid loss:0.1133
Val metric mean prob: 0.2769
Best metric at epoch 11: 0.4387 0.4360 0.6677
Cf: [[4645   21]
 [  66   34]]
Epoch: 12/15
Fold: 1
Len train df: 44750
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Valid loss:0.0844
Val metric mean prob: 0.2822
Best metric at epoch 1: 0.4968 0.3690 0.6931
Cf: [[4648   18]
 [  61   39]]
Model improve: 0.0000 -> 0.4968
Epoch: 2/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Valid loss:0.0869
Val metric mean prob: 0.2904
Best metric at epoch 1: 0.5000 0.3930 0.6979
Cf: [[4646   20]
 [  60   40]]
Model improve: 0.0000 -> 0.5000
Epoch: 2/10
Valid loss:0.0869
Val metric mean prob: 0.2904
Best metric at epoch 2: 0.5000 0.3930 0.6979
Cf: [[4646   20]
 [  60   40]]
Epoch: 3/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Valid loss:0.0867
Val metric mean prob: 0.2899
Best metric at epoch 1: 0.4908 0.3740 0.6975
Cf: [[4643   23]
 [  60   40]]
Model improve: 0.0000 -> 0.4908
Epoch: 2/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Valid loss:0.0844
Val metric mean prob: 0.2822
Best metric at epoch 1: 0.4968 0.3690 0.6931
Cf: [[4648   18]
 [  61   39]]
Model improve: 0.0000 -> 0.4968
Epoch: 2/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Valid loss:0.0874
Val metric mean prob: 0.2916
Best metric at epoch 1: 0.5000 0.4180 0.6932
Cf: [[4649   17]
 [  61   39]]
Model improve: 0.0000 -> 0.5000
Epoch: 2/10
Date :01/23/2023, 15:13:23
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Val metric mean prob: 0.4428
Best metric at epoch 1: 0.7500 0.3200 0.8000
Cf: [[127   0]
 [  2   3]]
Model improve: 0.0000 -> 0.7500
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Val metric mean prob: 0.2776
Best metric at epoch 1: 0.4900 0.2500 0.7395
Cf: [[4615   51]
 [  51   49]]
Model improve: 0.0000 -> 0.4900
Epoch: 2/10
Fold: 1
Len train df: 44750
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Date :01/23/2023, 16:11:54
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Fold: 1
Len train df: 100
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Train loss:0.7247, Valid loss:0.5962
Val metric mean prob: 0.0450
Best metric at epoch 1: 0.2000 0.4880 0.6427
Cf: [[119   6]
 [  2   1]]
Model improve: 0.0000 -> 0.2000
Epoch: 2/10
Date :01/23/2023, 16:57:41
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Epoch: 1/10
Train loss:0.2179, Valid loss:0.0997
Val metric mean prob: 0.0425
Best metric at epoch 1: 0.1498 0.0590 0.6326
Cf: [[4344  318]
 [  68   34]]
Model improve: 0.0000 -> 0.1498
Epoch: 2/10
Train loss:0.1561, Valid loss:0.0877
Val metric mean prob: 0.1286
Best metric at epoch 2: 0.3547 0.1060 0.6695
Cf: [[4597   65]
 [  66   36]]
Model improve: 0.1498 -> 0.3547
Epoch: 3/10
Train loss:0.1358, Valid loss:0.0939
Val metric mean prob: 0.1927
Best metric at epoch 3: 0.4195 0.3120 0.7043
Cf: [[4602   60]
 [  59   43]]
Model improve: 0.3547 -> 0.4195
Epoch: 4/10
Train loss:0.1252, Valid loss:0.0821
Val metric mean prob: 0.2146
Best metric at epoch 4: 0.4417 0.2630 0.6738
Cf: [[4637   25]
 [  66   36]]
Model improve: 0.4195 -> 0.4417
Epoch: 5/10
Train loss:0.1122, Valid loss:0.0856
Val metric mean prob: 0.2276
Best metric at epoch 5: 0.4422 0.2730 0.7100
Cf: [[4609   53]
 [  58   44]]
Model improve: 0.4417 -> 0.4422
Epoch: 6/10
Train loss:0.0998, Valid loss:0.0871
Val metric mean prob: 0.2477
Best metric at epoch 6: 0.4274 0.2280 0.7363
Cf: [[4580   82]
 [  52   50]]
Epoch: 7/10
Train loss:0.0874, Valid loss:0.0949
Val metric mean prob: 0.2538
Best metric at epoch 7: 0.4222 0.3950 0.6820
Cf: [[4622   40]
 [  64   38]]
Epoch: 8/10
Train loss:0.0771, Valid loss:0.0965
Val metric mean prob: 0.2871
Best metric at epoch 8: 0.4292 0.2320 0.7229
Cf: [[4592   70]
 [  55   47]]
Epoch: 9/10
Train loss:0.0693, Valid loss:0.0985
Val metric mean prob: 0.2862
Best metric at epoch 9: 0.4400 0.2770 0.7099
Cf: [[4608   54]
 [  58   44]]
Epoch: 10/10
Date :01/23/2023, 22:31:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2179, Valid loss:0.0997
Val metric mean prob: 0.0425
Best metric at epoch 1: 0.1498 0.0590 0.6326
Cf: [[4344  318]
 [  68   34]]
Model improve: 0.0000 -> 0.1498
Epoch: 2/15
Train loss:0.1566, Valid loss:0.0881
Val metric mean prob: 0.1164
Best metric at epoch 2: 0.3431 0.1060 0.6644
Cf: [[4595   67]
 [  67   35]]
Model improve: 0.1498 -> 0.3431
Epoch: 3/15
Train loss:0.1379, Valid loss:0.0983
Val metric mean prob: 0.1697
Best metric at epoch 3: 0.3874 0.3270 0.6758
Cf: [[4610   52]
 [  65   37]]
Model improve: 0.3431 -> 0.3874
Epoch: 4/15
Train loss:0.1284, Valid loss:0.0816
Val metric mean prob: 0.1887
Best metric at epoch 4: 0.4385 0.2050 0.6963
Cf: [[4618   44]
 [  61   41]]
Model improve: 0.3874 -> 0.4385
Epoch: 5/15
Train loss:0.1147, Valid loss:0.0848
Val metric mean prob: 0.1934
Best metric at epoch 5: 0.4393 0.2780 0.6827
Cf: [[4629   33]
 [  64   38]]
Model improve: 0.4385 -> 0.4393
Epoch: 6/15
Train loss:0.1046, Valid loss:0.0857
Val metric mean prob: 0.2570
Best metric at epoch 6: 0.4432 0.3190 0.6965
Cf: [[4620   42]
 [  61   41]]
Model improve: 0.4393 -> 0.4432
Epoch: 7/15
Train loss:0.0925, Valid loss:0.0898
Val metric mean prob: 0.2521
Best metric at epoch 7: 0.4578 0.3820 0.6835
Cf: [[4636   26]
 [  64   38]]
Model improve: 0.4432 -> 0.4578
Epoch: 8/15
Train loss:0.0815, Valid loss:0.0963
Val metric mean prob: 0.2582
Best metric at epoch 8: 0.4231 0.3200 0.6595
Cf: [[4641   21]
 [  69   33]]
Epoch: 9/15
Train loss:0.0698, Valid loss:0.1011
Val metric mean prob: 0.2676
Best metric at epoch 9: 0.4074 0.3460 0.6589
Cf: [[4635   27]
 [  69   33]]
Epoch: 10/15
Train loss:0.0584, Valid loss:0.1102
Val metric mean prob: 0.3017
Best metric at epoch 10: 0.4339 0.2460 0.6960
Cf: [[4616   46]
 [  61   41]]
Epoch: 11/15
Train loss:0.0500, Valid loss:0.1183
Val metric mean prob: 0.2846
Best metric at epoch 11: 0.4211 0.2420 0.6909
Cf: [[4614   48]
 [  62   40]]
Epoch: 12/15
Train loss:0.0445, Valid loss:0.1219
Val metric mean prob: 0.3008
Best metric at epoch 12: 0.4121 0.4280 0.6636
Cf: [[4633   29]
 [  68   34]]
Epoch: 13/15
Train loss:0.0376, Valid loss:0.1274
Val metric mean prob: 0.3037
Best metric at epoch 13: 0.4121 0.3640 0.6636
Cf: [[4633   29]
 [  68   34]]
Epoch: 14/15
Train loss:0.0358, Valid loss:0.1315
Val metric mean prob: 0.3021
Best metric at epoch 14: 0.4025 0.3850 0.6542
Cf: [[4637   25]
 [  70   32]]
Epoch: 15/15
Train loss:0.0348, Valid loss:0.1302
Val metric mean prob: 0.3013
Best metric at epoch 15: 0.4121 0.3740 0.6636
Cf: [[4633   29]
 [  68   34]]
Fold: 2
Len train df: 44603
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2157, Valid loss:0.1076
Val metric mean prob: 0.0498
Best metric at epoch 1: 0.1897 0.1150 0.6000
Cf: [[4539  123]
 [  82   24]]
Model improve: 0.0000 -> 0.1897
Epoch: 2/15
Train loss:0.1553, Valid loss:0.0897
Val metric mean prob: 0.1083
Best metric at epoch 2: 0.3755 0.0600 0.7070
Cf: [[4569   93]
 [  60   46]]
Model improve: 0.1897 -> 0.3755
Epoch: 3/15
Train loss:0.1380, Valid loss:0.0906
Val metric mean prob: 0.1245
Best metric at epoch 3: 0.4000 0.1220 0.6872
Cf: [[4604   58]
 [  65   41]]
Model improve: 0.3755 -> 0.4000
Epoch: 4/15
Train loss:0.1249, Valid loss:0.0905
Val metric mean prob: 0.2374
Best metric at epoch 4: 0.4585 0.2360 0.7161
Cf: [[4610   52]
 [  59   47]]
Model improve: 0.4000 -> 0.4585
Epoch: 5/15
Train loss:0.1170, Valid loss:0.0876
Val metric mean prob: 0.2365
Best metric at epoch 5: 0.4149 0.1310 0.7267
Cf: [[4577   85]
 [  56   50]]
Epoch: 6/15
Train loss:0.1064, Valid loss:0.0851
Val metric mean prob: 0.2754
Best metric at epoch 6: 0.4516 0.1880 0.7245
Cf: [[4600   62]
 [  57   49]]
Epoch: 7/15
Train loss:0.0951, Valid loss:0.0942
Val metric mean prob: 0.3029
Best metric at epoch 7: 0.4557 0.2410 0.7465
Cf: [[4585   77]
 [  52   54]]
Epoch: 8/15
Train loss:0.0851, Valid loss:0.0938
Val metric mean prob: 0.2899
Best metric at epoch 8: 0.4455 0.2080 0.7068
Cf: [[4611   51]
 [  61   45]]
Epoch: 9/15
Train loss:0.0711, Valid loss:0.1015
Val metric mean prob: 0.2994
Best metric at epoch 9: 0.4681 0.3190 0.7035
Cf: [[4624   38]
 [  62   44]]
Model improve: 0.4585 -> 0.4681
Epoch: 10/15
Train loss:0.0625, Valid loss:0.1040
Val metric mean prob: 0.2957
Best metric at epoch 10: 0.4550 0.2450 0.6985
Cf: [[4622   40]
 [  63   43]]
Epoch: 11/15
Train loss:0.0550, Valid loss:0.1128
Val metric mean prob: 0.3123
Best metric at epoch 11: 0.4500 0.3730 0.6679
Cf: [[4644   18]
 [  70   36]]
Epoch: 12/15
Train loss:0.0472, Valid loss:0.1160
Val metric mean prob: 0.3162
Best metric at epoch 12: 0.4457 0.2980 0.6807
Cf: [[4632   30]
 [  67   39]]
Epoch: 13/15
Fold: 1
Len train df: 44750
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0842
Val metric mean prob: 0.2818
Best metric at epoch 1: 0.4712 0.3290 0.7159
Cf: [[4618   44]
 [  57   45]]
Model improve: 0.0000 -> 0.4712
Epoch: 2/15
Fold: 1
Len train df: 44750
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0847
Val metric mean prob: 0.2883
Best metric at epoch 1: 0.4767 0.3070 0.7207
Cf: [[4617   45]
 [  56   46]]
Model improve: 0.0000 -> 0.4767
Epoch: 2/15
Fold: 1
Len train df: 44750
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0876
Val metric mean prob: 0.2974
Best metric at epoch 1: 0.4848 0.3030 0.7301
Cf: [[4614   48]
 [  54   48]]
Model improve: 0.0000 -> 0.4848
Epoch: 2/15
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/24/2023, 14:04:05
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0853
Val metric mean prob: 0.2853
Best metric at epoch 1: 0.5028 0.3330 0.7214
Cf: [[4632   34]
 [  55   45]]
Model improve: 0.0000 -> 0.5028
Epoch: 2/15
Fold: 2
Len train df: 44603
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0918
Val metric mean prob: 0.3260
Best metric at epoch 1: 0.4790 0.4110 0.6864
Cf: [[4641   21]
 [  66   40]]
Model improve: 0.0000 -> 0.4790
Epoch: 2/15
Date :01/24/2023, 14:25:33
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 2
Len train df: 44603
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/24/2023, 14:27:54
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 2
Len train df: 44603
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0937
Val metric mean prob: 0.3312
Best metric at epoch 1: 0.4824 0.4130 0.6909
Cf: [[4639   23]
 [  65   41]]
Model improve: 0.0000 -> 0.4824
Epoch: 2/15
Fold: 2
Len train df: 44603
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0922
Val metric mean prob: 0.3262
Best metric at epoch 1: 0.4757 0.3720 0.7038
Cf: [[4627   35]
 [  62   44]]
Model improve: 0.0000 -> 0.4757
Epoch: 2/15
Fold: 2
Len train df: 44603
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0871
Val metric mean prob: 0.3150
Best metric at epoch 1: 0.4734 0.3870 0.6862
Cf: [[4639   23]
 [  66   40]]
Model improve: 0.0000 -> 0.4734
Epoch: 2/15
Fold: 2
Len train df: 44603
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0896
Val metric mean prob: 0.3186
Best metric at epoch 1: 0.4762 0.4000 0.6863
Cf: [[4640   22]
 [  66   40]]
Model improve: 0.0000 -> 0.4762
Fold: 2
Len train df: 44603
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0937
Val metric mean prob: 0.3312
Best metric at epoch 1: 0.4824 0.4130 0.6909
Cf: [[4639   23]
 [  65   41]]
Model improve: 0.0000 -> 0.4824
Epoch: 2/15
Date :01/24/2023, 14:51:19
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/24/2023, 14:55:55
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/24/2023, 15:00:31
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/24/2023, 15:04:01
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 3
Len train df: 44752
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2198, Valid loss:0.1222
Val metric mean prob: 0.0454
Best metric at epoch 1: 0.1027 0.2060 0.5695
Cf: [[4448  223]
 [  74   17]]
Model improve: 0.0000 -> 0.1027
Epoch: 2/15
Train loss:0.1569, Valid loss:0.0845
Val metric mean prob: 0.1092
Best metric at epoch 2: 0.3230 0.2000 0.6381
Cf: [[4627   44]
 [  65   26]]
Model improve: 0.1027 -> 0.3230
Epoch: 3/15
Train loss:0.1415, Valid loss:0.0930
Val metric mean prob: 0.1564
Best metric at epoch 3: 0.3867 0.3020 0.6864
Cf: [[4616   55]
 [  56   35]]
Model improve: 0.3230 -> 0.3867
Epoch: 4/15
Train loss:0.1289, Valid loss:0.0792
Val metric mean prob: 0.1920
Best metric at epoch 4: 0.3924 0.2750 0.6665
Cf: [[4635   36]
 [  60   31]]
Model improve: 0.3867 -> 0.3924
Epoch: 5/15
Train loss:0.1179, Valid loss:0.0801
Val metric mean prob: 0.1719
Best metric at epoch 5: 0.3850 0.1610 0.7166
Cf: [[4590   81]
 [  50   41]]
Epoch: 6/15
Train loss:0.1078, Valid loss:0.0781
Val metric mean prob: 0.2057
Best metric at epoch 6: 0.4030 0.3390 0.6466
Cf: [[4655   16]
 [  64   27]]
Model improve: 0.3924 -> 0.4030
Epoch: 7/15
Train loss:0.0973, Valid loss:0.0804
Val metric mean prob: 0.2415
Best metric at epoch 7: 0.4192 0.2700 0.6879
Cf: [[4630   41]
 [  56   35]]
Model improve: 0.4030 -> 0.4192
Epoch: 8/15
Train loss:0.0881, Valid loss:0.0834
Val metric mean prob: 0.2339
Best metric at epoch 8: 0.3913 0.3620 0.6462
Cf: [[4651   20]
 [  64   27]]
Epoch: 9/15
Date :01/25/2023, 00:19:12
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 3
Len train df: 44752
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/25/2023, 00:20:17
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 44699
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/25/2023, 00:27:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 44699
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/25/2023, 00:29:16
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/25/2023, 00:30:29
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/25/2023, 01:46:23
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 44699
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/25/2023, 01:47:02
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2149, Valid loss:0.1044
Val metric mean prob: 0.0497
Best metric at epoch 1: 0.1252 0.0960 0.6465
Cf: [[4167  499]
 [  60   40]]
Model improve: 0.0000 -> 0.1252
Epoch: 2/15
Train loss:0.1566, Valid loss:0.0866
Val metric mean prob: 0.1252
Best metric at epoch 2: 0.3226 0.1720 0.6440
Cf: [[4610   56]
 [  70   30]]
Model improve: 0.1252 -> 0.3226
Epoch: 3/15
Train loss:0.1377, Valid loss:0.0898
Val metric mean prob: 0.1751
Best metric at epoch 3: 0.3537 0.3330 0.6412
Cf: [[4631   35]
 [  71   29]]
Model improve: 0.3226 -> 0.3537
Epoch: 4/15
Train loss:0.1247, Valid loss:0.0861
Val metric mean prob: 0.2277
Best metric at epoch 4: 0.3885 0.4410 0.6337
Cf: [[4654   12]
 [  73   27]]
Model improve: 0.3537 -> 0.3885
Epoch: 5/15
Train loss:0.1125, Valid loss:0.0835
Val metric mean prob: 0.2092
Best metric at epoch 5: 0.3684 0.2320 0.7008
Cf: [[4580   86]
 [  58   42]]
Epoch: 6/15
Train loss:0.1038, Valid loss:0.0824
Val metric mean prob: 0.2121
Best metric at epoch 6: 0.3655 0.2030 0.6735
Cf: [[4605   61]
 [  64   36]]
Epoch: 7/15
Date :01/25/2023, 08:10:43
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2176, Valid loss:0.1020
Val metric mean prob: 0.0515
Best metric at epoch 1: 0.1417 0.1060 0.6078
Cf: [[4412  254]
 [  73   27]]
Model improve: 0.0000 -> 0.1417
Epoch: 2/15
Train loss:0.1578, Valid loss:0.0969
Val metric mean prob: 0.1151
Best metric at epoch 2: 0.2877 0.3360 0.6023
Cf: [[4641   25]
 [  79   21]]
Model improve: 0.1417 -> 0.2877
Epoch: 3/15
Train loss:0.1387, Valid loss:0.0850
Val metric mean prob: 0.1970
Best metric at epoch 3: 0.3563 0.2510 0.6504
Cf: [[4623   43]
 [  69   31]]
Model improve: 0.2877 -> 0.3563
Epoch: 4/15
Train loss:0.1264, Valid loss:0.0811
Val metric mean prob: 0.1576
Best metric at epoch 4: 0.4023 0.1510 0.6708
Cf: [[4627   39]
 [  65   35]]
Model improve: 0.3563 -> 0.4023
Epoch: 5/15
Train loss:0.1151, Valid loss:0.0795
Val metric mean prob: 0.2003
Best metric at epoch 5: 0.3733 0.1230 0.7011
Cf: [[4583   83]
 [  58   42]]
Epoch: 6/15
Train loss:0.1001, Valid loss:0.0835
Val metric mean prob: 0.2349
Best metric at epoch 6: 0.4146 0.2520 0.6668
Cf: [[4636   30]
 [  66   34]]
Model improve: 0.4023 -> 0.4146
Epoch: 7/15
Date :01/25/2023, 12:42:43
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/25/2023, 13:13:02
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: SAM (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    rho: 0.05
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/25/2023, 13:14:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: SAM (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    rho: 0.05
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2378, Valid loss:0.1075
Val metric mean prob: 0.0274
Best metric at epoch 1: 0.0481 0.0410 0.5342
Cf: [[3305 1361]
 [  64   36]]
Model improve: 0.0000 -> 0.0481
Epoch: 2/15
Date :01/25/2023, 14:03:17
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: SAM (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    rho: 0.05
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/25/2023, 14:41:20
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.0605, Valid loss:0.0241
Val metric mean prob: 0.0405
Best metric at epoch 1: 0.0842 0.1290 0.6004
Cf: [[3970  696]
 [  65   35]]
Model improve: 0.0000 -> 0.0842
Epoch: 2/15
Train loss:0.0409, Valid loss:0.0230
Val metric mean prob: 0.0721
Best metric at epoch 2: 0.2857 0.2750 0.6109
Cf: [[4628   38]
 [  77   23]]
Model improve: 0.0842 -> 0.2857
Epoch: 3/15
Train loss:0.0396, Valid loss:0.0254
Val metric mean prob: 0.0748
Best metric at epoch 3: 0.2841 0.2950 0.6195
Cf: [[4615   51]
 [  75   25]]
Epoch: 4/15
Train loss:0.0396, Valid loss:0.0234
Val metric mean prob: 0.0735
Best metric at epoch 4: 0.2837 0.3180 0.5977
Cf: [[4645   21]
 [  80   20]]
Epoch: 5/15
Train loss:0.0396, Valid loss:0.0235
Val metric mean prob: 0.0728
Best metric at epoch 5: 0.2878 0.3230 0.5980
Cf: [[4647   19]
 [  80   20]]
Model improve: 0.2857 -> 0.2878
Epoch: 6/15
Train loss:0.0395, Valid loss:0.0234
Val metric mean prob: 0.0729
Best metric at epoch 6: 0.2837 0.3140 0.5977
Cf: [[4645   21]
 [  80   20]]
Epoch: 7/15
Train loss:0.0398, Valid loss:0.0238
Val metric mean prob: 0.0721
Best metric at epoch 7: 0.2837 0.3180 0.5977
Cf: [[4645   21]
 [  80   20]]
Epoch: 8/15
Train loss:0.0398, Valid loss:0.0245
Val metric mean prob: 0.0750
Best metric at epoch 8: 0.2929 0.2710 0.6376
Cf: [[4597   69]
 [  71   29]]
Model improve: 0.2878 -> 0.2929
Epoch: 9/15
Train loss:0.0396, Valid loss:0.0242
Val metric mean prob: 0.0734
Best metric at epoch 9: 0.2837 0.3330 0.5977
Cf: [[4645   21]
 [  80   20]]
Epoch: 10/15
Train loss:0.0393, Valid loss:0.0248
Val metric mean prob: 0.0748
Best metric at epoch 10: 0.2797 0.3430 0.5975
Cf: [[4643   23]
 [  80   20]]
Epoch: 11/15
Train loss:0.0399, Valid loss:0.0237
Val metric mean prob: 0.0731
Best metric at epoch 11: 0.2844 0.2430 0.6413
Cf: [[4585   81]
 [  70   30]]
Epoch: 12/15
Train loss:0.0398, Valid loss:0.0239
Val metric mean prob: 0.0714
Best metric at epoch 12: 0.2837 0.3180 0.5977
Cf: [[4645   21]
 [  80   20]]
Epoch: 13/15
Train loss:0.0398, Valid loss:0.0258
Val metric mean prob: 0.0771
Best metric at epoch 13: 0.2981 0.3340 0.6160
Cf: [[4629   37]
 [  76   24]]
Model improve: 0.2929 -> 0.2981
Epoch: 14/15
Train loss:0.0397, Valid loss:0.0235
Val metric mean prob: 0.0715
Best metric at epoch 14: 0.2837 0.3120 0.5977
Cf: [[4645   21]
 [  80   20]]
Epoch: 15/15
Train loss:0.0395, Valid loss:0.0251
Val metric mean prob: 0.0749
Best metric at epoch 15: 0.2797 0.3510 0.5975
Cf: [[4643   23]
 [  80   20]]
Fold: 1
Len train df: 44750
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.0594, Valid loss:0.0236
Val metric mean prob: 0.0416
Best metric at epoch 1: 0.0962 0.1430 0.5526
Cf: [[4467  195]
 [  87   15]]
Model improve: 0.0000 -> 0.0962
Epoch: 2/15
Date :01/25/2023, 23:50:12
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/25/2023, 23:57:30
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/25/2023, 23:58:52
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.0605, Valid loss:0.0238
Val metric mean prob: 0.0401
Best metric at epoch 1: 0.0853 0.1210 0.6197
Cf: [[3823  843]
 [  58   42]]
Model improve: 0.0000 -> 0.0853
Epoch: 2/15
Train loss:0.0409, Valid loss:0.0206
Val metric mean prob: 0.0792
Best metric at epoch 2: 0.3058 0.1260 0.6737
Cf: [[4561  105]
 [  63   37]]
Model improve: 0.0853 -> 0.3058
Epoch: 3/15
Train loss:0.0372, Valid loss:0.0230
Val metric mean prob: 0.1005
Best metric at epoch 3: 0.3175 0.3160 0.6437
Cf: [[4607   59]
 [  70   30]]
Model improve: 0.3058 -> 0.3175
Epoch: 4/15
Train loss:0.0344, Valid loss:0.0218
Val metric mean prob: 0.1272
Best metric at epoch 4: 0.3676 0.3160 0.6645
Cf: [[4615   51]
 [  66   34]]
Model improve: 0.3175 -> 0.3676
Epoch: 5/15
Train loss:0.0319, Valid loss:0.0199
Val metric mean prob: 0.1154
Best metric at epoch 5: 0.3249 0.1710 0.6530
Cf: [[4601   65]
 [  68   32]]
Epoch: 6/15
Train loss:0.0298, Valid loss:0.0195
Val metric mean prob: 0.1164
Best metric at epoch 6: 0.3671 0.1640 0.6826
Cf: [[4597   69]
 [  62   38]]
Epoch: 7/15
Train loss:0.0278, Valid loss:0.0195
Val metric mean prob: 0.1204
Best metric at epoch 7: 0.3690 0.2340 0.6510
Cf: [[4629   37]
 [  69   31]]
Model improve: 0.3676 -> 0.3690
Epoch: 8/15
Train loss:0.0256, Valid loss:0.0205
Val metric mean prob: 0.1409
Best metric at epoch 8: 0.4224 0.2410 0.7361
Cf: [[4583   83]
 [  51   49]]
Model improve: 0.3690 -> 0.4224
Epoch: 9/15
Train loss:0.0231, Valid loss:0.0199
Val metric mean prob: 0.1250
Best metric at epoch 9: 0.3729 0.1820 0.6603
Cf: [[4622   44]
 [  67   33]]
Epoch: 10/15
Train loss:0.0213, Valid loss:0.0197
Val metric mean prob: 0.1328
Best metric at epoch 10: 0.4171 0.2320 0.6899
Cf: [[4618   48]
 [  61   39]]
Epoch: 11/15
Train loss:0.0196, Valid loss:0.0213
Val metric mean prob: 0.1444
Best metric at epoch 11: 0.3977 0.3370 0.6706
Cf: [[4625   41]
 [  65   35]]
Epoch: 12/15
Train loss:0.0184, Valid loss:0.0202
Val metric mean prob: 0.1347
Best metric at epoch 12: 0.4382 0.2850 0.6908
Cf: [[4627   39]
 [  61   39]]
Model improve: 0.4224 -> 0.4382
Epoch: 13/15
Date :01/26/2023, 07:50:09
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Epoch: 1/15
Train loss:0.2181, Valid loss:0.1145
Val metric mean prob: 0.0461
Best metric at epoch 1: 0.1036 0.1190 0.5928
Cf: [[4272  394]
 [  73   27]]
Model improve: 0.0000 -> 0.1036
Epoch: 2/15
Train loss:0.1562, Valid loss:0.0853
Val metric mean prob: 0.1286
Best metric at epoch 2: 0.3153 0.1350 0.6524
Cf: [[4595   71]
 [  68   32]]
Model improve: 0.1036 -> 0.3153
Epoch: 3/15
Train loss:0.1377, Valid loss:0.0964
Val metric mean prob: 0.1743
Best metric at epoch 3: 0.3766 0.4090 0.6423
Cf: [[4641   25]
 [  71   29]]
Model improve: 0.3153 -> 0.3766
Epoch: 4/15
Train loss:0.1257, Valid loss:0.0847
Val metric mean prob: 0.2305
Best metric at epoch 4: 0.4084 0.2430 0.6894
Cf: [[4614   52]
 [  61   39]]
Model improve: 0.3766 -> 0.4084
Epoch: 5/15
Train loss:0.1132, Valid loss:0.0837
Val metric mean prob: 0.2328
Best metric at epoch 5: 0.4182 0.2220 0.7221
Cf: [[4592   74]
 [  54   46]]
Model improve: 0.4084 -> 0.4182
Epoch: 6/15
Train loss:0.1036, Valid loss:0.0850
Val metric mean prob: 0.2058
Best metric at epoch 6: 0.3952 0.1990 0.6614
Cf: [[4632   34]
 [  67   33]]
Epoch: 7/15
Date :01/26/2023, 11:33:53
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Epoch: 1/15
Train loss:0.2181, Valid loss:0.1145
Val metric mean prob: 0.0461
Best metric at epoch 1: 0.1036 0.1190 0.5928
Cf: [[4272  394]
 [  73   27]]
Model improve: 0.0000 -> 0.1036
Epoch: 2/15
Train loss:0.1562, Valid loss:0.0853
Val metric mean prob: 0.1286
Best metric at epoch 2: 0.3153 0.1350 0.6524
Cf: [[4595   71]
 [  68   32]]
Model improve: 0.1036 -> 0.3153
Epoch: 3/15
Train loss:0.1377, Valid loss:0.0964
Val metric mean prob: 0.1743
Best metric at epoch 3: 0.3766 0.4090 0.6423
Cf: [[4641   25]
 [  71   29]]
Model improve: 0.3153 -> 0.3766
Epoch: 4/15
Train loss:0.1257, Valid loss:0.0847
Val metric mean prob: 0.2305
Best metric at epoch 4: 0.4084 0.2430 0.6894
Cf: [[4614   52]
 [  61   39]]
Model improve: 0.3766 -> 0.4084
Epoch: 5/15
Train loss:0.1132, Valid loss:0.0837
Val metric mean prob: 0.2328
Best metric at epoch 5: 0.4182 0.2220 0.7221
Cf: [[4592   74]
 [  54   46]]
Model improve: 0.4084 -> 0.4182
Epoch: 6/15
Date :01/26/2023, 14:40:42
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=134, max_w_size=84),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/26/2023, 14:47:52
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=134, max_w_size=84),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
    ElasticTransform(always_apply=False, p=0.5, alpha=3, sigma=50, alpha_affine=50, interpolation=1, border_mode=4, value=None, mask_value=None, approximate=False, same_dxdy=False),
  ], p=0.2),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=[10, 50], per_channel=True, mean=0),
    GaussianBlur(always_apply=False, p=0.5, blur_limit=(3, 7), sigma_limit=(0, 0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 7), allow_shifted=True),
    MedianBlur(always_apply=False, p=0.5, blur_limit=(3, 7)),
  ], p=0.2),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2212, Valid loss:0.1043
Val metric mean prob: 0.0436
Best metric at epoch 1: 0.1044 0.0950 0.5871
Cf: [[4312  354]
 [  75   25]]
Model improve: 0.0000 -> 0.1044
Epoch: 2/15
Train loss:0.1636, Valid loss:0.0926
Val metric mean prob: 0.0825
Best metric at epoch 2: 0.2381 0.1680 0.6159
Cf: [[4581   85]
 [  75   25]]
Model improve: 0.1044 -> 0.2381
Epoch: 3/15
Train loss:0.1502, Valid loss:0.0995
Val metric mean prob: 0.1718
Best metric at epoch 3: 0.3239 0.4690 0.6130
Cf: [[4647   19]
 [  77   23]]
Model improve: 0.2381 -> 0.3239
Epoch: 4/15
Date :01/26/2023, 19:33:24
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=134, max_w_size=84),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2185, Valid loss:0.1100
Val metric mean prob: 0.0463
Best metric at epoch 1: 0.1043 0.1300 0.5626
Cf: [[4457  209]
 [  83   17]]
Model improve: 0.0000 -> 0.1043
Epoch: 2/15
Train loss:0.1564, Valid loss:0.0894
Val metric mean prob: 0.1306
Best metric at epoch 2: 0.2593 0.1420 0.6306
Cf: [[4578   88]
 [  72   28]]
Model improve: 0.1043 -> 0.2593
Epoch: 3/15
Train loss:0.1374, Valid loss:0.0961
Val metric mean prob: 0.1774
Best metric at epoch 3: 0.3709 0.4110 0.6375
Cf: [[4643   23]
 [  72   28]]
Model improve: 0.2593 -> 0.3709
Epoch: 4/15
Train loss:0.1241, Valid loss:0.0872
Val metric mean prob: 0.2119
Best metric at epoch 4: 0.3946 0.3790 0.6431
Cf: [[4648   18]
 [  71   29]]
Model improve: 0.3709 -> 0.3946
Epoch: 5/15
Train loss:0.1128, Valid loss:0.0791
Val metric mean prob: 0.2286
Best metric at epoch 5: 0.4364 0.2810 0.6769
Cf: [[4637   29]
 [  64   36]]
Model improve: 0.3946 -> 0.4364
Epoch: 6/15
Train loss:0.1034, Valid loss:0.0858
Val metric mean prob: 0.1998
Best metric at epoch 6: 0.3881 0.1690 0.6884
Cf: [[4604   62]
 [  61   39]]
Epoch: 7/15
Date :01/26/2023, 23:23:02
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=134, max_w_size=84),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 44652
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.001
)
total_epoch :15
Epoch: 1/15
Train loss:0.2183, Valid loss:0.1125
Val metric mean prob: 0.0456
Best metric at epoch 1: 0.1019 0.1260 0.5678
Cf: [[4412  254]
 [  81   19]]
Model improve: 0.0000 -> 0.1019
Epoch: 2/15
Train loss:0.1574, Valid loss:0.0863
Val metric mean prob: 0.1367
Best metric at epoch 2: 0.3038 0.2330 0.6164
Cf: [[4632   34]
 [  76   24]]
Model improve: 0.1019 -> 0.3038
Epoch: 3/15
Train loss:0.1377, Valid loss:0.0932
Val metric mean prob: 0.1824
Best metric at epoch 3: 0.3689 0.2740 0.6827
Cf: [[4598   68]
 [  62   38]]
Model improve: 0.3038 -> 0.3689
Epoch: 4/15
Train loss:0.1248, Valid loss:0.0901
Val metric mean prob: 0.2080
Best metric at epoch 4: 0.4046 0.3820 0.6709
Cf: [[4628   38]
 [  65   35]]
Model improve: 0.3689 -> 0.4046
Epoch: 5/15
Train loss:0.1131, Valid loss:0.0802
Val metric mean prob: 0.2055
Best metric at epoch 5: 0.4304 0.2820 0.6674
Cf: [[4642   24]
 [  66   34]]
Model improve: 0.4046 -> 0.4304
Epoch: 6/15
Fold: 3
Len train df: 44752
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Fold: 3
Len train df: 44752
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.1131, Valid loss:0.0763
Val metric mean prob: 0.2380
Best metric at epoch 1: 0.4317 0.4050 0.6629
Cf: [[4653   18]
 [  61   30]]
Model improve: 0.0000 -> 0.4317
Epoch: 2/15
Date :01/27/2023, 02:46:37
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 3
Len train df: 45689
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2666, Valid loss:0.1109
Val metric mean prob: 0.0457
Best metric at epoch 1: 0.1143 0.1620 0.5769
Cf: [[4465  206]
 [  73   18]]
Model improve: 0.0000 -> 0.1143
Epoch: 2/15
Fold: 0
Len train df: 45577
Len valid df: 10979
Fold: 1
Len train df: 45673
Len valid df: 10879
Fold: 2
Len train df: 45512
Len valid df: 11012
Fold: 3
Len train df: 45689
Len valid df: 10891
Fold: 4
Len train df: 45637
Len valid df: 10945
Fold: 0
Len train df: 43727
Len valid df: 10979
Fold: 1
Len train df: 43827
Len valid df: 10879
Fold: 2
Len train df: 43694
Len valid df: 11012
Fold: 3
Len train df: 43815
Len valid df: 10891
Fold: 4
Len train df: 43761
Len valid df: 10945
Fold: 0
Len train df: 45577
Len valid df: 10979
Fold: 1
Len train df: 45673
Len valid df: 10879
Fold: 2
Len train df: 45512
Len valid df: 11012
Fold: 3
Len train df: 45689
Len valid df: 10891
Fold: 4
Len train df: 45637
Len valid df: 10945
Fold: 3
Len train df: 45689
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 2/15
Train loss:0.1927, Valid loss:0.1003
Val metric mean prob: 0.1534
Best metric at epoch 2: 0.3291 0.4120 0.6385
Cf: [[4630   41]
 [  65   26]]
Model improve: 0.0000 -> 0.3291
Epoch: 3/15
Train loss:0.1775, Valid loss:0.0861
Val metric mean prob: 0.1700
Best metric at epoch 3: 0.3804 0.3000 0.6659
Cf: [[4630   41]
 [  60   31]]
Model improve: 0.3291 -> 0.3804
Epoch: 4/15
Train loss:0.1570, Valid loss:0.0832
Val metric mean prob: 0.1925
Best metric at epoch 4: 0.4103 0.3430 0.6723
Cf: [[4638   33]
 [  59   32]]
Model improve: 0.3804 -> 0.4103
Epoch: 5/15
Train loss:0.1424, Valid loss:0.0783
Val metric mean prob: 0.2153
Best metric at epoch 5: 0.4041 0.1410 0.7075
Cf: [[4608   63]
 [  52   39]]
Epoch: 6/15
Train loss:0.1269, Valid loss:0.0898
Val metric mean prob: 0.2371
Best metric at epoch 6: 0.4648 0.4440 0.6794
Cf: [[4653   18]
 [  58   33]]
Model improve: 0.4103 -> 0.4648
Epoch: 7/15
Train loss:0.1100, Valid loss:0.0861
Val metric mean prob: 0.2077
Best metric at epoch 7: 0.4103 0.3100 0.6723
Cf: [[4638   33]
 [  59   32]]
Epoch: 8/15
Train loss:0.0939, Valid loss:0.0916
Val metric mean prob: 0.2630
Best metric at epoch 8: 0.4471 0.3710 0.7044
Cf: [[4630   41]
 [  53   38]]
Epoch: 9/15
Train loss:0.0807, Valid loss:0.1065
Val metric mean prob: 0.2404
Best metric at epoch 9: 0.3885 0.3930 0.6461
Cf: [[4650   21]
 [  64   27]]
Epoch: 10/15
Train loss:0.0696, Valid loss:0.1040
Val metric mean prob: 0.2601
Best metric at epoch 10: 0.4062 0.2020 0.7076
Cf: [[4609   62]
 [  52   39]]
Epoch: 11/15
Train loss:0.0601, Valid loss:0.1114
Val metric mean prob: 0.2720
Best metric at epoch 11: 0.4309 0.1990 0.7088
Cf: [[4620   51]
 [  52   39]]
Epoch: 12/15
Train loss:0.0532, Valid loss:0.1164
Val metric mean prob: 0.2790
Best metric at epoch 12: 0.4074 0.2780 0.6773
Cf: [[4633   38]
 [  58   33]]
Epoch: 13/15
Fold: 3
Len train df: 45689
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 2/15
Valid loss:0.1109
Val metric mean prob: 0.0457
Best metric at epoch 2: 0.1143 0.1620 0.5769
Cf: [[4465  206]
 [  73   18]]
Model improve: 0.0000 -> 0.1143
Fold: 3
Len train df: 45689
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 2/15
Valid loss:0.0878
Val metric mean prob: 0.2775
Best metric at epoch 2: 0.4730 0.4520 0.6900
Cf: [[4649   22]
 [  56   35]]
Model improve: 0.0000 -> 0.4730
Epoch: 3/15
Date :01/27/2023, 10:50:54
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 45577
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/27/2023, 10:51:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 45577
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2638, Valid loss:0.1228
Val metric mean prob: 0.0556
Best metric at epoch 1: 0.1622 0.2320 0.5561
Cf: [[4630   36]
 [  88   12]]
Model improve: 0.0000 -> 0.1622
Epoch: 2/15
Train loss:0.1994, Valid loss:0.1286
Val metric mean prob: 0.1133
Best metric at epoch 2: 0.3289 0.4570 0.6221
Cf: [[4639   27]
 [  75   25]]
Model improve: 0.1622 -> 0.3289
Epoch: 3/15
Train loss:0.1736, Valid loss:0.0888
Val metric mean prob: 0.1596
Best metric at epoch 3: 0.3602 0.2830 0.6416
Cf: [[4634   32]
 [  71   29]]
Model improve: 0.3289 -> 0.3602
Epoch: 4/15
Train loss:0.1540, Valid loss:0.1066
Val metric mean prob: 0.1836
Best metric at epoch 4: 0.3580 0.4990 0.6415
Cf: [[4633   33]
 [  71   29]]
Epoch: 5/15
Fold: 3
Len train df: 45689
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0950
Val metric mean prob: 0.2859
Best metric at epoch 1: 0.4722 0.4500 0.6848
Cf: [[4652   19]
 [  57   34]]
Model improve: 0.0000 -> 0.4722
Fold: 3
Len train df: 45689
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0908
Val metric mean prob: 0.2743
Best metric at epoch 1: 0.4568 0.3720 0.6997
Cf: [[4637   34]
 [  54   37]]
Model improve: 0.0000 -> 0.4568
Epoch: 2/15
Fold: 3
Len train df: 45689
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0906
Val metric mean prob: 0.2692
Best metric at epoch 1: 0.4540 0.4520 0.6996
Cf: [[4636   35]
 [  54   37]]
Model improve: 0.0000 -> 0.4540
Epoch: 2/15
Valid loss:0.0906
Val metric mean prob: 0.2692
Best metric at epoch 2: 0.4540 0.4520 0.6996
Cf: [[4636   35]
 [  54   37]]
Epoch: 3/15
Fold: 3
Len train df: 45689
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0954
Val metric mean prob: 0.2866
Best metric at epoch 1: 0.4615 0.3400 0.7101
Cf: [[4632   39]
 [  52   39]]
Model improve: 0.0000 -> 0.4615
Fold: 3
Len train df: 45689
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0873
Val metric mean prob: 0.2268
Best metric at epoch 1: 0.4861 0.4750 0.6904
Cf: [[4653   18]
 [  56   35]]
Model improve: 0.0000 -> 0.4861
Epoch: 2/15
Fold: 3
Len train df: 45689
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0817
Val metric mean prob: 0.2259
Best metric at epoch 1: 0.4528 0.3700 0.6944
Cf: [[4639   32]
 [  55   36]]
Model improve: 0.0000 -> 0.4528
Epoch: 2/15
Fold: 3
Len train df: 45689
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0885
Val metric mean prob: 0.2135
Best metric at epoch 1: 0.4654 0.4390 0.7000
Cf: [[4640   31]
 [  54   37]]
Model improve: 0.0000 -> 0.4654
Epoch: 2/15
Date :01/27/2023, 14:01:13
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 45577
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/27/2023, 14:03:07
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 45577
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2659, Valid loss:0.1176
Val metric mean prob: 0.0594
Best metric at epoch 1: 0.1872 0.2140 0.5860
Cf: [[4582   84]
 [  81   19]]
Model improve: 0.0000 -> 0.1872
Epoch: 2/15
Train loss:0.1945, Valid loss:0.0991
Val metric mean prob: 0.1252
Best metric at epoch 2: 0.3315 0.2450 0.6445
Cf: [[4615   51]
 [  70   30]]
Model improve: 0.1872 -> 0.3315
Epoch: 3/15
Train loss:0.1673, Valid loss:0.0945
Val metric mean prob: 0.1818
Best metric at epoch 3: 0.3742 0.3960 0.6422
Cf: [[4640   26]
 [  71   29]]
Model improve: 0.3315 -> 0.3742
Epoch: 4/15
Train loss:0.1480, Valid loss:0.0864
Val metric mean prob: 0.2266
Best metric at epoch 4: 0.4000 0.3530 0.6616
Cf: [[4634   32]
 [  67   33]]
Model improve: 0.3742 -> 0.4000
Date :01/27/2023, 16:24:00
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 47427
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.3391, Valid loss:0.1667
Val metric mean prob: 0.0876
Best metric at epoch 1: 0.2981 0.3880 0.6467
Cf: [[4589   77]
 [  69   31]]
Model improve: 0.0000 -> 0.2981
Epoch: 2/15
Train loss:0.2442, Valid loss:0.1064
Val metric mean prob: 0.1362
Best metric at epoch 2: 0.3911 0.3250 0.6703
Cf: [[4622   44]
 [  65   35]]
Model improve: 0.2981 -> 0.3911
Epoch: 3/15
Train loss:0.1969, Valid loss:0.1131
Val metric mean prob: 0.2050
Best metric at epoch 3: 0.4945 0.4880 0.7210
Cf: [[4629   37]
 [  55   45]]
Model improve: 0.3911 -> 0.4945
Epoch: 4/15
Train loss:0.1549, Valid loss:0.1287
Val metric mean prob: 0.2222
Best metric at epoch 4: 0.3965 0.4630 0.7162
Cf: [[4584   82]
 [  55   45]]
Epoch: 5/15
Train loss:0.1192, Valid loss:0.1157
Val metric mean prob: 0.2544
Best metric at epoch 5: 0.4181 0.4740 0.6807
Cf: [[4626   40]
 [  63   37]]
Epoch: 6/15
Train loss:0.0940, Valid loss:0.1259
Val metric mean prob: 0.2398
Best metric at epoch 6: 0.3975 0.4890 0.6569
Cf: [[4637   29]
 [  68   32]]
Epoch: 7/15
Train loss:0.0730, Valid loss:0.1207
Val metric mean prob: 0.2897
Best metric at epoch 7: 0.4082 0.4640 0.6482
Cf: [[4649   17]
 [  70   30]]
Epoch: 8/15
Train loss:0.0572, Valid loss:0.1383
Val metric mean prob: 0.2661
Best metric at epoch 8: 0.3741 0.4580 0.6286
Cf: [[4653   13]
 [  74   26]]
Epoch: 9/15
Train loss:0.0451, Valid loss:0.1431
Val metric mean prob: 0.2810
Best metric at epoch 9: 0.3879 0.3140 0.6565
Cf: [[4633   33]
 [  68   32]]
Epoch: 10/15
Train loss:0.0372, Valid loss:0.1493
Val metric mean prob: 0.2799
Best metric at epoch 10: 0.3758 0.4740 0.6377
Cf: [[4645   21]
 [  72   28]]
Epoch: 11/15
Date :01/27/2023, 22:39:11
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 47519
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.3358, Valid loss:0.1492
Val metric mean prob: 0.1147
Best metric at epoch 1: 0.2708 0.4880 0.6206
Cf: [[4598   64]
 [  76   26]]
Model improve: 0.0000 -> 0.2708
Epoch: 2/15
Train loss:0.2416, Valid loss:0.1100
Val metric mean prob: 0.1948
Best metric at epoch 2: 0.4024 0.5180 0.6631
Cf: [[4629   33]
 [  68   34]]
Model improve: 0.2708 -> 0.4024
Epoch: 3/15
Train loss:0.1966, Valid loss:0.1069
Val metric mean prob: 0.2058
Best metric at epoch 3: 0.4331 0.4830 0.6644
Cf: [[4641   21]
 [  68   34]]
Model improve: 0.4024 -> 0.4331
Epoch: 4/15
Train loss:0.1540, Valid loss:0.1130
Val metric mean prob: 0.2075
Best metric at epoch 4: 0.4171 0.4650 0.6862
Cf: [[4616   46]
 [  63   39]]
Epoch: 5/15
Fold: 0
Len train df: 47427
Len valid df: 10979
Fold: 0
Len train df: 47427
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0969
Val metric mean prob: 0.1751
Best metric at epoch 1: 0.5000 0.3630 0.7306
Cf: [[4625   41]
 [  53   47]]
Model improve: 0.0000 -> 0.5000
Epoch: 2/15
Fold: 0
Len train df: 47427
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0974
Val metric mean prob: 0.2000
Best metric at epoch 1: 0.5028 0.4220 0.7214
Cf: [[4632   34]
 [  55   45]]
Model improve: 0.0000 -> 0.5028
Epoch: 2/15
Date :01/28/2023, 01:12:50
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 2
Len train df: 46421
Len valid df: 11012
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.3055, Valid loss:0.1193
Val metric mean prob: 0.0694
Best metric at epoch 1: 0.1875 0.2030 0.6107
Cf: [[4507  155]
 [  79   27]]
Model improve: 0.0000 -> 0.1875
Epoch: 2/15
Train loss:0.2256, Valid loss:0.1172
Val metric mean prob: 0.1413
Best metric at epoch 2: 0.4311 0.3690 0.6671
Cf: [[4637   25]
 [  70   36]]
Model improve: 0.1875 -> 0.4311
Epoch: 3/15
Train loss:0.1870, Valid loss:0.0970
Val metric mean prob: 0.2503
Best metric at epoch 3: 0.4670 0.4060 0.7122
Cf: [[4617   45]
 [  60   46]]
Model improve: 0.4311 -> 0.4670
Epoch: 4/15
Train loss:0.1578, Valid loss:0.0914
Val metric mean prob: 0.2290
Best metric at epoch 4: 0.4746 0.3140 0.6950
Cf: [[4633   29]
 [  64   42]]
Model improve: 0.4670 -> 0.4746
Epoch: 5/15
Train loss:0.1314, Valid loss:0.1088
Val metric mean prob: 0.2688
Best metric at epoch 5: 0.4469 0.4540 0.6851
Cf: [[4629   33]
 [  66   40]]
Fold: 3
Len train df: 46626
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Fold: 2
Len train df: 46421
Len valid df: 11012
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0946
Val metric mean prob: 0.2777
Best metric at epoch 1: 0.5057 0.4610 0.7050
Cf: [[4638   24]
 [  62   44]]
Model improve: 0.0000 -> 0.5057
Epoch: 2/15
Fold: 2
Len train df: 46421
Len valid df: 11012
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.1246
Val metric mean prob: 0.1577
Best metric at epoch 1: 0.4865 0.4190 0.7086
Cf: [[4628   34]
 [  61   45]]
Model improve: 0.0000 -> 0.4865
Epoch: 2/15
Fold: 2
Len train df: 46421
Len valid df: 11012
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0984
Val metric mean prob: 0.2203
Best metric at epoch 1: 0.4900 0.3890 0.7263
Cf: [[4617   45]
 [  57   49]]
Model improve: 0.0000 -> 0.4900
Epoch: 2/15
Date :01/28/2023, 04:27:23
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 3
Len train df: 46626
Len valid df: 10891
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.3047, Valid loss:0.1373
Val metric mean prob: 0.0798
Best metric at epoch 1: 0.2411 0.4060 0.5899
Cf: [[4638   33]
 [  74   17]]
Model improve: 0.0000 -> 0.2411
Epoch: 2/15
Train loss:0.2156, Valid loss:0.0820
Val metric mean prob: 0.1819
Best metric at epoch 2: 0.4161 0.3010 0.6674
Cf: [[4644   27]
 [  60   31]]
Model improve: 0.2411 -> 0.4161
Epoch: 3/15
Train loss:0.1826, Valid loss:0.0901
Val metric mean prob: 0.1927
Best metric at epoch 3: 0.3882 0.3850 0.6764
Cf: [[4625   46]
 [  58   33]]
Epoch: 4/15
Train loss:0.1554, Valid loss:0.0919
Val metric mean prob: 0.1891
Best metric at epoch 4: 0.4311 0.3610 0.6935
Cf: [[4631   40]
 [  55   36]]
Model improve: 0.4161 -> 0.4311
Epoch: 5/15
Train loss:0.1302, Valid loss:0.1129
Val metric mean prob: 0.1936
Best metric at epoch 5: 0.3636 0.4170 0.6902
Cf: [[4600   71]
 [  55   36]]
Epoch: 6/15
Date :01/28/2023, 07:43:49
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 46575
Len valid df: 10945
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.3077, Valid loss:0.1638
Val metric mean prob: 0.0539
Best metric at epoch 1: 0.1075 0.2440 0.6182
Cf: [[4220  453]
 [  62   31]]
Model improve: 0.0000 -> 0.1075
Epoch: 2/15
Train loss:0.2243, Valid loss:0.1292
Val metric mean prob: 0.1310
Best metric at epoch 2: 0.3118 0.4640 0.6491
Cf: [[4609   64]
 [  64   29]]
Model improve: 0.1075 -> 0.3118
Epoch: 3/15
Train loss:0.1879, Valid loss:0.1208
Val metric mean prob: 0.1788
Best metric at epoch 3: 0.3646 0.4750 0.6813
Cf: [[4609   64]
 [  58   35]]
Model improve: 0.3118 -> 0.3646
Epoch: 4/15
Train loss:0.1600, Valid loss:0.1010
Val metric mean prob: 0.1965
Best metric at epoch 4: 0.4151 0.4770 0.6739
Cf: [[4640   33]
 [  60   33]]
Model improve: 0.3646 -> 0.4151
Epoch: 5/15
Train loss:0.1321, Valid loss:0.0977
Val metric mean prob: 0.2302
Best metric at epoch 5: 0.3784 0.3430 0.6821
Cf: [[4616   57]
 [  58   35]]
Date :01/28/2023, 10:44:01
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 44699
Len valid df: 10945
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2195, Valid loss:0.0953
Val metric mean prob: 0.0322
Best metric at epoch 1: 0.0981 0.0460 0.6057
Cf: [[4204  469]
 [  64   29]]
Model improve: 0.0000 -> 0.0981
Epoch: 2/15
Train loss:0.1614, Valid loss:0.0863
Val metric mean prob: 0.0746
Best metric at epoch 2: 0.2874 0.1170 0.6237
Cf: [[4623   50]
 [  69   24]]
Model improve: 0.0981 -> 0.2874
Epoch: 3/15
Train loss:0.1431, Valid loss:0.0886
Val metric mean prob: 0.1479
Best metric at epoch 3: 0.3881 0.3340 0.6382
Cf: [[4658   15]
 [  67   26]]
Model improve: 0.2874 -> 0.3881
Epoch: 4/15
Train loss:0.1298, Valid loss:0.1020
Val metric mean prob: 0.1705
Best metric at epoch 4: 0.3626 0.4100 0.6616
Cf: [[4626   47]
 [  62   31]]
Epoch: 5/15
Train loss:0.1178, Valid loss:0.1017
Val metric mean prob: 0.1968
Best metric at epoch 5: 0.4056 0.4990 0.6537
Cf: [[4652   21]
 [  64   29]]
Model improve: 0.3881 -> 0.4056
Epoch: 6/15
Date :01/28/2023, 13:31:14
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 47513
Len valid df: 10945
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.3391, Valid loss:0.1029
Val metric mean prob: 0.0844
Best metric at epoch 1: 0.2051 0.2020 0.6165
Cf: [[4556  117]
 [  69   24]]
Model improve: 0.0000 -> 0.2051
Epoch: 2/15
Train loss:0.2416, Valid loss:0.1144
Val metric mean prob: 0.1706
Best metric at epoch 2: 0.3822 0.5000 0.6577
Cf: [[4639   34]
 [  63   30]]
Model improve: 0.2051 -> 0.3822
Epoch: 3/15
Train loss:0.1924, Valid loss:0.1246
Val metric mean prob: 0.1684
Best metric at epoch 3: 0.2946 0.4520 0.6669
Cf: [[4575   98]
 [  60   33]]
Date :01/28/2023, 15:18:31
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 45637
Len valid df: 10945
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2693, Valid loss:0.1203
Val metric mean prob: 0.0469
Best metric at epoch 1: 0.1325 0.1590 0.5912
Cf: [[4470  203]
 [  72   21]]
Model improve: 0.0000 -> 0.1325
Epoch: 2/15
Train loss:0.1973, Valid loss:0.0905
Val metric mean prob: 0.1277
Best metric at epoch 2: 0.3462 0.2670 0.6413
Cf: [[4637   36]
 [  66   27]]
Model improve: 0.1325 -> 0.3462
Epoch: 3/15
Train loss:0.1660, Valid loss:0.0801
Val metric mean prob: 0.1707
Best metric at epoch 3: 0.3529 0.1400 0.6709
Cf: [[4612   61]
 [  60   33]]
Model improve: 0.3462 -> 0.3529
Epoch: 4/15
Train loss:0.1465, Valid loss:0.0827
Val metric mean prob: 0.2199
Best metric at epoch 4: 0.4276 0.4030 0.6644
Cf: [[4652   21]
 [  62   31]]
Model improve: 0.3529 -> 0.4276
Epoch: 5/15
Train loss:0.1280, Valid loss:0.0879
Val metric mean prob: 0.2222
Best metric at epoch 5: 0.3889 0.4070 0.6481
Cf: [[4650   23]
 [  65   28]]
Epoch: 6/15
Train loss:0.1092, Valid loss:0.1229
Val metric mean prob: 0.2020
Best metric at epoch 6: 0.4000 0.5860 0.6633
Cf: [[4642   31]
 [  62   31]]
Epoch: 7/15
Train loss:0.0925, Valid loss:0.0966
Val metric mean prob: 0.2268
Best metric at epoch 7: 0.3913 0.4440 0.6432
Cf: [[4655   18]
 [  66   27]]
Date :01/28/2023, 22:58:18
Date :01/28/2023, 22:59:32
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 4
Len train df: 45637
Len valid df: 10945
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 8/15
Train loss:0.0743, Valid loss:0.1154
Val metric mean prob: 0.2464
Best metric at epoch 8: 0.3916 0.4830 0.6482
Cf: [[4651   22]
 [  65   28]]
Model improve: 0.0000 -> 0.3916
Epoch: 9/15
Train loss:0.0535, Valid loss:0.1280
Val metric mean prob: 0.2455
Best metric at epoch 9: 0.3453 0.3540 0.6267
Cf: [[4651   22]
 [  69   24]]
Epoch: 10/15
Fold: 4
Len train df: 45637
Len valid df: 10945
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 8/15
Valid loss:0.0975
Val metric mean prob: 0.2547
Best metric at epoch 8: 0.4277 0.4450 0.6794
Cf: [[4641   32]
 [  59   34]]
Model improve: 0.0000 -> 0.4277
Epoch: 9/15
Fold: 4
Len train df: 45637
Len valid df: 10945
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.1005
Val metric mean prob: 0.2526
Best metric at epoch 1: 0.4295 0.4940 0.6695
Cf: [[4649   24]
 [  61   32]]
Model improve: 0.0000 -> 0.4295
Epoch: 2/15
Date :01/29/2023, 00:36:08
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 45673
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2672, Valid loss:0.1245
Val metric mean prob: 0.0575
Best metric at epoch 1: 0.1923 0.2020 0.5693
Cf: [[4623   39]
 [  87   15]]
Model improve: 0.0000 -> 0.1923
Date :01/29/2023, 01:39:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 45673
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2672, Valid loss:0.1245
Val metric mean prob: 0.0575
Best metric at epoch 1: 0.1923 0.2020 0.5693
Cf: [[4623   39]
 [  87   15]]
Model improve: 0.0000 -> 0.1923
Epoch: 2/15
Train loss:0.1952, Valid loss:0.0972
Val metric mean prob: 0.1596
Best metric at epoch 2: 0.3723 0.3090 0.6661
Cf: [[4611   51]
 [  67   35]]
Model improve: 0.1923 -> 0.3723
Epoch: 3/15
Train loss:0.1701, Valid loss:0.0890
Val metric mean prob: 0.1761
Best metric at epoch 3: 0.3842 0.2500 0.6623
Cf: [[4621   41]
 [  68   34]]
Model improve: 0.3723 -> 0.3842
Epoch: 4/15
Train loss:0.1490, Valid loss:0.0901
Val metric mean prob: 0.2148
Best metric at epoch 4: 0.4032 0.2350 0.7348
Cf: [[4566   96]
 [  52   50]]
Model improve: 0.3842 -> 0.4032
Epoch: 5/15
Train loss:0.1284, Valid loss:0.0893
Val metric mean prob: 0.2220
Best metric at epoch 5: 0.3864 0.3430 0.6624
Cf: [[4622   40]
 [  68   34]]
Epoch: 6/15
Train loss:0.1092, Valid loss:0.1038
Val metric mean prob: 0.2635
Best metric at epoch 6: 0.4235 0.4730 0.6730
Cf: [[4630   32]
 [  66   36]]
Model improve: 0.4032 -> 0.4235
Epoch: 7/15
Fold: 1
Len train df: 45673
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Valid loss:0.0870
Val metric mean prob: 0.2957
Best metric at epoch 1: 0.4800 0.3130 0.7299
Cf: [[4612   50]
 [  54   48]]
Model improve: 0.0000 -> 0.4800
Epoch: 2/15
Date :01/29/2023, 05:20:45
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 43827
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.1874, Valid loss:0.1032
Val metric mean prob: 0.0328
Best metric at epoch 1: 0.1041 0.0500 0.5787
Cf: [[4345  317]
 [  79   23]]
Model improve: 0.0000 -> 0.1041
Epoch: 2/15
Train loss:0.1279, Valid loss:0.0977
Val metric mean prob: 0.1024
Best metric at epoch 2: 0.2651 0.2650 0.6033
Cf: [[4620   42]
 [  80   22]]
Model improve: 0.1041 -> 0.2651
Epoch: 3/15
Train loss:0.1161, Valid loss:0.0878
Val metric mean prob: 0.1699
Best metric at epoch 3: 0.3529 0.1510 0.6562
Cf: [[4610   52]
 [  69   33]]
Model improve: 0.2651 -> 0.3529
Epoch: 4/15
Train loss:0.1098, Valid loss:0.0846
Val metric mean prob: 0.1795
Best metric at epoch 4: 0.3822 0.2270 0.6444
Cf: [[4637   25]
 [  72   30]]
Model improve: 0.3529 -> 0.3822
Epoch: 5/15
Train loss:0.0996, Valid loss:0.0850
Val metric mean prob: 0.1814
Best metric at epoch 5: 0.3853 0.1510 0.6979
Cf: [[4588   74]
 [  60   42]]
Model improve: 0.3822 -> 0.3853
Epoch: 6/15
Date :01/29/2023, 08:01:47
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/29/2023, 08:16:34
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/29/2023, 08:17:10
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Len valid df: 10879
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2262, Valid loss:0.1042
Val metric mean prob: 0.0327
Best metric at epoch 1: 0.0909 0.0460 0.5957
Cf: [[4092  570]
 [  70   32]]
Model improve: 0.0000 -> 0.0909
Epoch: 2/15
Train loss:0.1647, Valid loss:0.0945
Val metric mean prob: 0.0599
Best metric at epoch 2: 0.2039 0.0880 0.6336
Cf: [[4491  171]
 [  71   31]]
Model improve: 0.0909 -> 0.2039
Epoch: 3/15
Date :01/29/2023, 10:02:05
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnetv2_b1
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2139, Valid loss:0.1086
Val metric mean prob: 0.0300
Best metric at epoch 1: 0.0573 0.0750 0.5217
Cf: [[4495  171]
 [  92    8]]
Model improve: 0.0000 -> 0.0573
Epoch: 2/15
Train loss:0.1610, Valid loss:0.0949
Val metric mean prob: 0.0992
Best metric at epoch 2: 0.3237 0.2150 0.6352
Cf: [[4621   45]
 [  72   28]]
Model improve: 0.0573 -> 0.3237
Epoch: 3/15
Train loss:0.1421, Valid loss:0.0878
Val metric mean prob: 0.1470
Best metric at epoch 3: 0.3451 0.1850 0.6857
Cf: [[4579   87]
 [  61   39]]
Model improve: 0.3237 -> 0.3451
Epoch: 4/15
Train loss:0.1331, Valid loss:0.0915
Val metric mean prob: 0.1794
Best metric at epoch 4: 0.4217 0.3510 0.6717
Cf: [[4635   31]
 [  65   35]]
Model improve: 0.3451 -> 0.4217
Epoch: 5/15
Train loss:0.1232, Valid loss:0.0949
Val metric mean prob: 0.2182
Best metric at epoch 5: 0.4194 0.3980 0.6900
Cf: [[4619   47]
 [  61   39]]
Epoch: 6/15
Train loss:0.1123, Valid loss:0.0892
Val metric mean prob: 0.2381
Best metric at epoch 6: 0.3977 0.3990 0.6660
Cf: [[4629   37]
 [  66   34]]
Epoch: 7/15
Train loss:0.1004, Valid loss:0.0848
Val metric mean prob: 0.2373
Best metric at epoch 7: 0.3886 0.2980 0.6656
Cf: [[4625   41]
 [  66   34]]
Epoch: 8/15
Train loss:0.0911, Valid loss:0.0902
Val metric mean prob: 0.2537
Best metric at epoch 8: 0.4076 0.3200 0.6573
Cf: [[4641   25]
 [  68   32]]
Epoch: 9/15
Date :01/29/2023, 14:24:28
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=1.0, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnet_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/29/2023, 14:26:53
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=1.0, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnet_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/29/2023, 14:28:15
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=1.0, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnet_b2
Len train df: 44652
Len valid df: 10979
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/29/2023, 15:12:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=1.0, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnet_b2
Len train df: 100
Len valid df: 500
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.5927, Valid loss:0.6702
Val metric mean prob: 0.0503
Best metric at epoch 1: 0.0833 0.5310 0.5440
Cf: [[199  17]
 [  5   1]]
Model improve: 0.0000 -> 0.0833
Epoch: 2/15
Train loss:0.4213, Valid loss:0.4716
Val metric mean prob: 0.0464
Best metric at epoch 2: 0.0571 0.2790 0.5417
Cf: [[ 18 198]
 [  0   6]]
Epoch: 3/15
Train loss:0.2952, Valid loss:0.3184
Val metric mean prob: 0.0390
Best metric at epoch 3: 0.0543 0.1350 0.5162
Cf: [[  7 209]
 [  0   6]]
Epoch: 4/15
Train loss:0.2088, Valid loss:0.2590
Val metric mean prob: 0.0344
Best metric at epoch 4: 0.0556 0.0970 0.5278
Cf: [[ 12 204]
 [  0   6]]
Epoch: 5/15
Date :01/29/2023, 15:14:53
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=1.0, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnet_b2
Len train df: 100
Len valid df: 500
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.5927, Valid loss:0.6702
Val metric mean prob: 0.0503
Best metric at epoch 1: 0.0833 0.5310 0.5440
Cf: [[199  17]
 [  5   1]]
Model improve: 0.0000 -> 0.0833
Epoch: 2/15
Date :01/29/2023, 15:15:40
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=1.0, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnet_b2
Len train df: 44652
Len valid df: 10979
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2045, Valid loss:0.1284
Val metric mean prob: 0.0533
Best metric at epoch 1: 0.1513 0.3410 0.5439
Cf: [[4656   10]
 [  91    9]]
Model improve: 0.0000 -> 0.1513
Epoch: 2/15
Train loss:0.1532, Valid loss:0.0953
Val metric mean prob: 0.1313
Best metric at epoch 2: 0.2733 0.2860 0.6058
Cf: [[4627   39]
 [  78   22]]
Model improve: 0.1513 -> 0.2733
Epoch: 3/15
Train loss:0.1350, Valid loss:0.0898
Val metric mean prob: 0.1555
Best metric at epoch 3: 0.3312 0.1090 0.6267
Cf: [[4635   31]
 [  74   26]]
Model improve: 0.2733 -> 0.3312
Epoch: 4/15
Train loss:0.1237, Valid loss:0.0904
Val metric mean prob: 0.1931
Best metric at epoch 4: 0.4025 0.2990 0.6571
Cf: [[4639   27]
 [  68   32]]
Model improve: 0.3312 -> 0.4025
Epoch: 5/15
Train loss:0.1113, Valid loss:0.0973
Val metric mean prob: 0.2032
Best metric at epoch 5: 0.3294 0.2590 0.6355
Cf: [[4624   42]
 [  72   28]]
Epoch: 6/15
Train loss:0.0972, Valid loss:0.0998
Val metric mean prob: 0.2067
Best metric at epoch 6: 0.3280 0.1320 0.6488
Cf: [[4608   58]
 [  69   31]]
Epoch: 7/15
Train loss:0.0850, Valid loss:0.1014
Val metric mean prob: 0.2199
Best metric at epoch 7: 0.3718 0.3070 0.6421
Cf: [[4639   27]
 [  71   29]]
Epoch: 8/15
Train loss:0.0727, Valid loss:0.1185
Val metric mean prob: 0.2363
Best metric at epoch 8: 0.3694 0.3660 0.6420
Cf: [[4638   28]
 [  71   29]]
Epoch: 9/15
Train loss:0.0571, Valid loss:0.1324
Val metric mean prob: 0.2337
Best metric at epoch 9: 0.3462 0.1890 0.6723
Cf: [[4594   72]
 [  64   36]]
Epoch: 10/15
Train loss:0.0496, Valid loss:0.1446
Val metric mean prob: 0.2264
Best metric at epoch 10: 0.3356 0.4490 0.6224
Cf: [[4642   24]
 [  75   25]]
Epoch: 11/15
Date :01/29/2023, 23:01:59
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnet_b2
Len train df: 44652
Len valid df: 10979
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Train loss:0.2037, Valid loss:0.1094
Val metric mean prob: 0.0421
Best metric at epoch 1: 0.1073 0.1370 0.5449
Cf: [[4572   94]
 [  89   11]]
Model improve: 0.0000 -> 0.1073
Epoch: 2/15
Train loss:0.1519, Valid loss:0.1109
Val metric mean prob: 0.1361
Best metric at epoch 2: 0.2985 0.3690 0.6424
Cf: [[4595   71]
 [  70   30]]
Model improve: 0.1073 -> 0.2985
Epoch: 3/15
Train loss:0.1318, Valid loss:0.0832
Val metric mean prob: 0.1970
Best metric at epoch 3: 0.3946 0.1310 0.7115
Cf: [[4587   79]
 [  56   44]]
Model improve: 0.2985 -> 0.3946
Epoch: 4/15
Train loss:0.1201, Valid loss:0.0895
Val metric mean prob: 0.1815
Best metric at epoch 4: 0.4000 0.3250 0.6661
Cf: [[4630   36]
 [  66   34]]
Model improve: 0.3946 -> 0.4000
Epoch: 5/15
Train loss:0.1092, Valid loss:0.0869
Val metric mean prob: 0.2318
Best metric at epoch 5: 0.4088 0.2810 0.6803
Cf: [[4622   44]
 [  63   37]]
Model improve: 0.4000 -> 0.4088
Epoch: 6/15
Train loss:0.0931, Valid loss:0.0929
Val metric mean prob: 0.2368
Best metric at epoch 6: 0.3958 0.2600 0.6842
Cf: [[4612   54]
 [  62   38]]
Epoch: 7/15
Train loss:0.0804, Valid loss:0.1036
Val metric mean prob: 0.2385
Best metric at epoch 7: 0.4086 0.3640 0.6849
Cf: [[4618   48]
 [  62   38]]
Epoch: 8/15
Date :01/30/2023, 04:21:58
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Epoch: 1/15
Train loss:0.2166, Valid loss:0.1118
Val metric mean prob: 0.0480
Best metric at epoch 1: 0.1082 0.1320 0.5826
Cf: [[4364  302]
 [  77   23]]
Model improve: 0.0000 -> 0.1082
Epoch: 2/15
Date :01/30/2023, 04:55:35
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.2166, Valid loss:0.1097
Val metric mean prob: 0.0472
Best metric at epoch 1: 0.1116 0.1070 0.6286
Cf: [[4140  526]
 [  63   37]]
Model improve: 0.0000 -> 0.1116
Epoch: 2/15
Train loss:0.1565, Valid loss:0.0906
Val metric mean prob: 0.1271
Best metric at epoch 2: 0.2767 0.2920 0.6060
Cf: [[4629   37]
 [  78   22]]
Model improve: 0.1116 -> 0.2767
Epoch: 3/15
Train loss:0.1427, Valid loss:0.0994
Val metric mean prob: 0.1772
Best metric at epoch 3: 0.3529 0.3900 0.6457
Cf: [[4626   40]
 [  70   30]]
Model improve: 0.2767 -> 0.3529
Epoch: 4/15
Train loss:0.1320, Valid loss:0.0905
Val metric mean prob: 0.1903
Best metric at epoch 4: 0.3537 0.3770 0.6412
Cf: [[4631   35]
 [  71   29]]
Model improve: 0.3529 -> 0.3537
Epoch: 5/15
Date :01/30/2023, 07:05:30
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/30/2023, 07:27:20
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/30/2023, 07:28:02
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: nextvit-small
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/30/2023, 07:29:13
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: nextvit-small
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/30/2023, 07:29:33
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: nextvit-small
Len train df: 44652
Len valid df: 10979
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/30/2023, 07:30:11
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: nextvit-small
Len train df: 44652
Len valid df: 10979
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/30/2023, 07:30:33
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: nextvit-small
Len train df: 44652
Len valid df: 10979
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/30/2023, 07:31:28
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: nextvit-small
Len train df: 10
Len valid df: 100
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.6872, Valid loss:0.7514
Date :01/30/2023, 07:32:07
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: nextvit-small
Len train df: 10
Len valid df: 100
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :01/30/2023, 07:32:29
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: nextvit-small
Len train df: 44652
Len valid df: 10979
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Train loss:0.4644, Valid loss:0.1607
Val metric mean prob: 0.0359
Best metric at epoch 1: 0.0476 0.0980 0.5471
Cf: [[2306 2360]
 [  40   60]]
Model improve: 0.0000 -> 0.0476
Epoch: 2/15
Date :01/30/2023, 10:45:20
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: nextvit-small
Len train df: 44652
Len valid df: 10979
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 2/15
Date :01/30/2023, 10:58:50
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: nextvit-small
Len train df: 44652
Len valid df: 10979
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 2/15
Train loss:0.1667, Valid loss:0.1009
Val metric mean prob: 0.0749
Best metric at epoch 2: 0.2160 0.1280 0.6054
Cf: [[4576   90]
 [  77   23]]
Model improve: 0.0000 -> 0.2160
Epoch: 3/15
Train loss:0.1508, Valid loss:0.1222
Val metric mean prob: 0.1205
Best metric at epoch 3: 0.2649 0.5390 0.5967
Cf: [[4635   31]
 [  80   20]]
Model improve: 0.2160 -> 0.2649
Epoch: 4/15
Date :01/30/2023, 14:08:30
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 2/13
Date :01/30/2023, 15:04:28
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 2/13
Date :01/30/2023, 15:13:30
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2164, Valid loss:0.1063
Val metric mean prob: 0.0494
Best metric at epoch 1: 0.1748 0.1280 0.5822
Cf: [[2289   45]
 [  40    9]]
Model improve: 0.0000 -> 0.1748
Epoch: 2/13
Train loss:0.1557, Valid loss:0.0861
Val metric mean prob: 0.1276
Best metric at epoch 2: 0.5510 0.1510 0.7708
Cf: [[2312   22]
 [  22   27]]
Model improve: 0.1748 -> 0.5510
Epoch: 3/13
Train loss:0.1385, Valid loss:0.0879
Val metric mean prob: 0.2007
Best metric at epoch 3: 0.5155 0.2910 0.7502
Cf: [[2311   23]
 [  24   25]]
Epoch: 4/13
Train loss:0.1260, Valid loss:0.0757
Val metric mean prob: 0.2631
Best metric at epoch 4: 0.5227 0.3240 0.7313
Cf: [[2318   16]
 [  26   23]]
Epoch: 5/13
Train loss:0.1163, Valid loss:0.0731
Val metric mean prob: 0.2691
Best metric at epoch 5: 0.5349 0.1880 0.7317
Cf: [[2320   14]
 [  26   23]]
Epoch: 6/13
Train loss:0.1038, Valid loss:0.0746
Val metric mean prob: 0.2865
Best metric at epoch 6: 0.5412 0.2190 0.7319
Cf: [[2321   13]
 [  26   23]]
Epoch: 7/13
Train loss:0.0956, Valid loss:0.0827
Val metric mean prob: 0.3146
Best metric at epoch 7: 0.5000 0.3060 0.7400
Cf: [[2311   23]
 [  25   24]]
Epoch: 8/13
Train loss:0.0821, Valid loss:0.0791
Val metric mean prob: 0.3255
Best metric at epoch 8: 0.5455 0.4150 0.7128
Cf: [[2327    7]
 [  28   21]]
Epoch: 9/13
Train loss:0.0720, Valid loss:0.0832
Val metric mean prob: 0.3371
Best metric at epoch 9: 0.5610 0.3570 0.7326
Cf: [[2324   10]
 [  26   23]]
Model improve: 0.5510 -> 0.5610
Epoch: 10/13
Train loss:0.0627, Valid loss:0.0977
Val metric mean prob: 0.3415
Best metric at epoch 10: 0.5385 0.4960 0.7126
Cf: [[2326    8]
 [  28   21]]
Epoch: 11/13
Train loss:0.0550, Valid loss:0.0937
Val metric mean prob: 0.3396
Best metric at epoch 11: 0.5610 0.4400 0.7326
Cf: [[2324   10]
 [  26   23]]
Epoch: 12/13
Train loss:0.0533, Valid loss:0.0958
Val metric mean prob: 0.3548
Best metric at epoch 12: 0.5526 0.4600 0.7130
Cf: [[2328    6]
 [  28   21]]
Epoch: 13/13
Train loss:0.0518, Valid loss:0.0937
Val metric mean prob: 0.3531
Best metric at epoch 13: 0.5750 0.4370 0.7330
Cf: [[2326    8]
 [  26   23]]
Model improve: 0.5610 -> 0.5750
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2143, Valid loss:0.0968
Val metric mean prob: 0.0496
Best metric at epoch 1: 0.1675 0.0800 0.6363
Cf: [[2207  126]
 [  33   16]]
Model improve: 0.0000 -> 0.1675
Epoch: 2/13
Train loss:0.1540, Valid loss:0.0964
Val metric mean prob: 0.1230
Best metric at epoch 2: 0.3611 0.3650 0.6305
Cf: [[2323   10]
 [  36   13]]
Model improve: 0.1675 -> 0.3611
Epoch: 3/13
Train loss:0.1368, Valid loss:0.0906
Val metric mean prob: 0.1878
Best metric at epoch 3: 0.4444 0.2730 0.7563
Cf: [[2291   42]
 [  23   26]]
Model improve: 0.3611 -> 0.4444
Epoch: 4/13
Train loss:0.1237, Valid loss:0.0936
Val metric mean prob: 0.1934
Best metric at epoch 4: 0.4533 0.4390 0.6715
Cf: [[2324    9]
 [  32   17]]
Model improve: 0.4444 -> 0.4533
Epoch: 5/13
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Date :01/31/2023, 01:00:21
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0780
Val metric mean prob: 0.3335
Best metric at epoch 1: 0.5647 0.4200 0.7423
Cf: [[2322   12]
 [  25   24]]
Model improve: 0.0000 -> 0.5647
Epoch: 2/13
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0812
Val metric mean prob: 0.3459
Best metric at epoch 1: 0.5567 0.3880 0.7710
Cf: [[2313   21]
 [  22   27]]
Model improve: 0.0000 -> 0.5567
Epoch: 2/13
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0892
Val metric mean prob: 0.3479
Best metric at epoch 1: 0.5750 0.4460 0.7330
Cf: [[2326    8]
 [  26   23]]
Model improve: 0.0000 -> 0.5750
Epoch: 2/13
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0934
Val metric mean prob: 0.3473
Best metric at epoch 1: 0.5714 0.4750 0.7232
Cf: [[2328    6]
 [  27   22]]
Model improve: 0.0000 -> 0.5714
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0768
Val metric mean prob: 0.3271
Best metric at epoch 1: 0.5581 0.3980 0.7421
Cf: [[2321   13]
 [  25   24]]
Model improve: 0.0000 -> 0.5581
Epoch: 2/13
Date :01/31/2023, 01:22:21
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 5/13
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 5/13
Date :01/31/2023, 01:23:06
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 5/13
Train loss:0.1135, Valid loss:0.0782
Val metric mean prob: 0.2365
Best metric at epoch 5: 0.4118 0.3980 0.6418
Cf: [[2328    5]
 [  35   14]]
Model improve: 0.0000 -> 0.4118
Epoch: 6/13
Train loss:0.0998, Valid loss:0.0826
Val metric mean prob: 0.2338
Best metric at epoch 6: 0.4416 0.3570 0.6711
Cf: [[2322   11]
 [  32   17]]
Model improve: 0.4118 -> 0.4416
Epoch: 7/13
Train loss:0.0885, Valid loss:0.0951
Val metric mean prob: 0.2344
Best metric at epoch 7: 0.4000 0.4420 0.6507
Cf: [[2322   11]
 [  34   15]]
Epoch: 8/13
Train loss:0.0770, Valid loss:0.0932
Val metric mean prob: 0.2562
Best metric at epoch 8: 0.4400 0.2300 0.7183
Cf: [[2304   29]
 [  27   22]]
Epoch: 9/13
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0866
Val metric mean prob: 0.2118
Best metric at epoch 1: 0.4719 0.3540 0.7102
Cf: [[2314   19]
 [  28   21]]
Model improve: 0.0000 -> 0.4719
Epoch: 2/13
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Date :01/31/2023, 03:54:54
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0795
Val metric mean prob: 0.2532
Best metric at epoch 1: 0.4835 0.3110 0.7202
Cf: [[2313   20]
 [  27   22]]
Model improve: 0.0000 -> 0.4835
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0790
Val metric mean prob: 0.2576
Best metric at epoch 1: 0.4889 0.3010 0.7204
Cf: [[2314   19]
 [  27   22]]
Model improve: 0.0000 -> 0.4889
Epoch: 2/13
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Date :01/31/2023, 04:03:41
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0777
Val metric mean prob: 0.3030
Best metric at epoch 1: 0.5476 0.4210 0.7321
Cf: [[2322   12]
 [  26   23]]
Model improve: 0.0000 -> 0.5476
Epoch: 2/13
Date :01/31/2023, 04:11:26
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2168, Valid loss:0.1058
Val metric mean prob: 0.0338
Best metric at epoch 1: 0.0826 0.0530 0.6212
Cf: [[1872  461]
 [  28   22]]
Model improve: 0.0000 -> 0.0826
Epoch: 2/13
Train loss:0.1545, Valid loss:0.0898
Val metric mean prob: 0.1626
Best metric at epoch 2: 0.3750 0.2310 0.7012
Cf: [[2292   41]
 [  29   21]]
Model improve: 0.0826 -> 0.3750
Epoch: 3/13
Train loss:0.1365, Valid loss:0.0862
Val metric mean prob: 0.2032
Best metric at epoch 3: 0.4615 0.2500 0.7336
Cf: [[2303   30]
 [  26   24]]
Model improve: 0.3750 -> 0.4615
Epoch: 4/13
Train loss:0.1248, Valid loss:0.0841
Val metric mean prob: 0.2148
Best metric at epoch 4: 0.4272 0.2610 0.7134
Cf: [[2302   31]
 [  28   22]]
Epoch: 5/13
Train loss:0.1135, Valid loss:0.0843
Val metric mean prob: 0.2273
Best metric at epoch 5: 0.4598 0.2860 0.6964
Cf: [[2316   17]
 [  30   20]]
Epoch: 6/13
Train loss:0.1029, Valid loss:0.0853
Val metric mean prob: 0.2372
Best metric at epoch 6: 0.4118 0.4250 0.6391
Cf: [[2329    4]
 [  36   14]]
Epoch: 7/13
Train loss:0.0909, Valid loss:0.0887
Val metric mean prob: 0.2602
Best metric at epoch 7: 0.4848 0.2660 0.7346
Cf: [[2308   25]
 [  26   24]]
Model improve: 0.4615 -> 0.4848
Epoch: 8/13
Train loss:0.0805, Valid loss:0.0976
Val metric mean prob: 0.2391
Best metric at epoch 8: 0.3864 0.2300 0.6655
Cf: [[2312   21]
 [  33   17]]
Epoch: 9/13
Train loss:0.0708, Valid loss:0.1006
Val metric mean prob: 0.2618
Best metric at epoch 9: 0.4082 0.3440 0.6940
Cf: [[2305   28]
 [  30   20]]
Epoch: 10/13
Date :01/31/2023, 10:39:02
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 10/13
Train loss:0.0616, Valid loss:0.1117
Val metric mean prob: 0.2714
Best metric at epoch 10: 0.4314 0.2410 0.7136
Cf: [[2303   30]
 [  28   22]]
Model improve: 0.0000 -> 0.4314
Epoch: 11/13
Train loss:0.0484, Valid loss:0.1178
Val metric mean prob: 0.2728
Best metric at epoch 11: 0.3896 0.4760 0.6474
Cf: [[2321   12]
 [  35   15]]
Epoch: 12/13
Train loss:0.0400, Valid loss:0.1201
Val metric mean prob: 0.2787
Best metric at epoch 12: 0.3944 0.4960 0.6385
Cf: [[2326    7]
 [  36   14]]
Epoch: 13/13
10 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
10 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
10 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0854
Val metric mean prob: 0.2651
Best metric at epoch 1: 0.4516 0.3630 0.7053
Cf: [[2311   22]
 [  29   21]]
Model improve: 0.0000 -> 0.4516
10 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0853
Val metric mean prob: 0.2560
Best metric at epoch 1: 0.4750 0.4480 0.6876
Cf: [[2322   11]
 [  31   19]]
Model improve: 0.0000 -> 0.4750
Epoch: 2/13
10 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0870
Val metric mean prob: 0.2534
Best metric at epoch 1: 0.4848 0.3390 0.7346
Cf: [[2308   25]
 [  26   24]]
Model improve: 0.0000 -> 0.4848
Date :01/31/2023, 12:42:16
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2144, Valid loss:0.1155
Val metric mean prob: 0.0447
Best metric at epoch 1: 0.1550 0.1390 0.5870
Cf: [[2263   70]
 [  39   10]]
Model improve: 0.0000 -> 0.1550
Epoch: 2/13
Train loss:0.1523, Valid loss:0.1143
Val metric mean prob: 0.1333
Best metric at epoch 2: 0.2913 0.3740 0.6447
Cf: [[2294   39]
 [  34   15]]
Model improve: 0.1550 -> 0.2913
Epoch: 3/13
Date :01/31/2023, 14:59:58
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2144, Valid loss:0.1155
Val metric mean prob: 0.0447
Best metric at epoch 1: 0.1550 0.1390 0.5870
Cf: [[2263   70]
 [  39   10]]
Model improve: 0.0000 -> 0.1550
Epoch: 2/13
Train loss:0.1523, Valid loss:0.1143
Val metric mean prob: 0.1333
Best metric at epoch 2: 0.2913 0.3740 0.6447
Cf: [[2294   39]
 [  34   15]]
Model improve: 0.1550 -> 0.2913
Epoch: 3/13
Train loss:0.1343, Valid loss:0.0998
Val metric mean prob: 0.1579
Best metric at epoch 3: 0.3361 0.2670 0.6934
Cf: [[2283   50]
 [  29   20]]
Model improve: 0.2913 -> 0.3361
Epoch: 4/13
Train loss:0.1222, Valid loss:0.0927
Val metric mean prob: 0.1616
Best metric at epoch 4: 0.3704 0.3200 0.6494
Cf: [[2316   17]
 [  34   15]]
Model improve: 0.3361 -> 0.3704
Epoch: 5/13
Train loss:0.1128, Valid loss:0.0855
Val metric mean prob: 0.1997
Best metric at epoch 5: 0.3469 0.1690 0.6666
Cf: [[2301   32]
 [  32   17]]
Epoch: 6/13
Train loss:0.1021, Valid loss:0.0918
Val metric mean prob: 0.2068
Best metric at epoch 6: 0.3846 0.3730 0.6501
Cf: [[2319   14]
 [  34   15]]
Model improve: 0.3704 -> 0.3846
Epoch: 7/13
Train loss:0.0909, Valid loss:0.0904
Val metric mean prob: 0.2200
Best metric at epoch 7: 0.4000 0.3150 0.6787
Cf: [[2310   23]
 [  31   18]]
Model improve: 0.3846 -> 0.4000
Epoch: 8/13
Train loss:0.0792, Valid loss:0.0906
Val metric mean prob: 0.2354
Best metric at epoch 8: 0.4267 0.3870 0.6611
Cf: [[2323   10]
 [  33   16]]
Model improve: 0.4000 -> 0.4267
Epoch: 9/13
Train loss:0.0702, Valid loss:0.1001
Val metric mean prob: 0.2118
Best metric at epoch 9: 0.3810 0.2020 0.6592
Cf: [[2314   19]
 [  33   16]]
Epoch: 10/13
Train loss:0.0612, Valid loss:0.1075
Val metric mean prob: 0.2398
Best metric at epoch 10: 0.3736 0.2870 0.6681
Cf: [[2308   25]
 [  32   17]]
Epoch: 11/13
Train loss:0.0543, Valid loss:0.1102
Val metric mean prob: 0.2375
Best metric at epoch 11: 0.3711 0.2050 0.6772
Cf: [[2303   30]
 [  31   18]]
Epoch: 12/13
Train loss:0.0497, Valid loss:0.1136
Val metric mean prob: 0.2377
Best metric at epoch 12: 0.3529 0.2980 0.6486
Cf: [[2312   21]
 [  34   15]]
Epoch: 13/13
Train loss:0.0497, Valid loss:0.1127
Val metric mean prob: 0.2449
Best metric at epoch 13: 0.3614 0.2940 0.6490
Cf: [[2314   19]
 [  34   15]]
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2154, Valid loss:0.0903
Val metric mean prob: 0.0547
Best metric at epoch 1: 0.2222 0.0900 0.6101
Cf: [[2287   46]
 [  38   12]]
Model improve: 0.0000 -> 0.2222
Epoch: 2/13
Train loss:0.1540, Valid loss:0.0984
Val metric mean prob: 0.1219
Best metric at epoch 2: 0.3294 0.3240 0.6355
Cf: [[2312   21]
 [  36   14]]
Model improve: 0.2222 -> 0.3294
Epoch: 3/13
Train loss:0.1369, Valid loss:0.0839
Val metric mean prob: 0.1569
Best metric at epoch 3: 0.3478 0.2340 0.6544
Cf: [[2307   26]
 [  34   16]]
Model improve: 0.3294 -> 0.3478
Epoch: 4/13
Train loss:0.1255, Valid loss:0.0964
Val metric mean prob: 0.1969
Best metric at epoch 4: 0.4416 0.5590 0.6679
Cf: [[2323   10]
 [  33   17]]
Model improve: 0.3478 -> 0.4416
Epoch: 5/13
Train loss:0.1144, Valid loss:0.0843
Val metric mean prob: 0.2208
Best metric at epoch 5: 0.4444 0.5380 0.6587
Cf: [[2327    6]
 [  34   16]]
Model improve: 0.4416 -> 0.4444
Epoch: 6/13
Train loss:0.1040, Valid loss:0.0788
Val metric mean prob: 0.2530
Best metric at epoch 6: 0.4675 0.3770 0.6781
Cf: [[2324    9]
 [  32   18]]
Model improve: 0.4444 -> 0.4675
Epoch: 7/13
Train loss:0.0903, Valid loss:0.0844
Val metric mean prob: 0.2577
Best metric at epoch 7: 0.4810 0.4740 0.6879
Cf: [[2323   10]
 [  31   19]]
Model improve: 0.4675 -> 0.4810
Epoch: 8/13
Train loss:0.0800, Valid loss:0.0843
Val metric mean prob: 0.2958
Best metric at epoch 8: 0.4722 0.4720 0.6689
Cf: [[2328    5]
 [  33   17]]
Epoch: 9/13
Train loss:0.0681, Valid loss:0.0858
Val metric mean prob: 0.3022
Best metric at epoch 9: 0.4571 0.4790 0.6591
Cf: [[2329    4]
 [  34   16]]
Epoch: 10/13
Train loss:0.0598, Valid loss:0.0887
Val metric mean prob: 0.2939
Best metric at epoch 10: 0.4423 0.1700 0.7234
Cf: [[2302   31]
 [  27   23]]
Epoch: 11/13
Train loss:0.0543, Valid loss:0.0911
Val metric mean prob: 0.3071
Best metric at epoch 11: 0.4545 0.4900 0.6498
Cf: [[2332    1]
 [  35   15]]
Epoch: 12/13
Train loss:0.0521, Valid loss:0.0953
Val metric mean prob: 0.3062
Best metric at epoch 12: 0.4557 0.3940 0.6776
Cf: [[2322   11]
 [  32   18]]
Epoch: 13/13
Train loss:0.0481, Valid loss:0.0955
Val metric mean prob: 0.3046
Best metric at epoch 13: 0.4557 0.4030 0.6776
Cf: [[2322   11]
 [  32   18]]
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2124, Valid loss:0.1068
Val metric mean prob: 0.0456
Best metric at epoch 1: 0.1529 0.1120 0.6019
Cf: [[2238   96]
 [  37   12]]
Model improve: 0.0000 -> 0.1529
Epoch: 2/13
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0833
Train loss:0.2124, Valid loss:0.0833
Date :02/01/2023, 06:54:04
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0833
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0833
Val metric mean prob: 0.2874
Best metric at epoch 1: 0.4737 0.4980 0.6783
Cf: [[2325    8]
 [  32   18]]
Model improve: 0.0000 -> 0.4737
Epoch: 2/13
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0828
Val metric mean prob: 0.2857
Best metric at epoch 1: 0.5067 0.4730 0.6887
Cf: [[2327    6]
 [  31   19]]
Model improve: 0.0000 -> 0.5067
Epoch: 2/13
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0805
Val metric mean prob: 0.2819
Best metric at epoch 1: 0.5000 0.5190 0.6791
Cf: [[2329    4]
 [  32   18]]
Model improve: 0.0000 -> 0.5000
10 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0896
Val metric mean prob: 0.2370
Best metric at epoch 1: 0.4086 0.2730 0.6885
Cf: [[2308   25]
 [  30   19]]
Model improve: 0.0000 -> 0.4086
Epoch: 2/13
10 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0888
Val metric mean prob: 0.2357
Best metric at epoch 1: 0.4000 0.2580 0.6974
Cf: [[2302   31]
 [  29   20]]
Model improve: 0.0000 -> 0.4000
Epoch: 2/13
10 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0888
Val metric mean prob: 0.2339
Best metric at epoch 1: 0.4094 0.1760 0.7542
Cf: [[2281   52]
 [  23   26]]
Model improve: 0.0000 -> 0.4094
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 500
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.6015, Valid loss:0.3367
Val metric mean prob: 0.0477
Best metric at epoch 1: 0.1429 0.3370 0.5671
Cf: [[208   7]
 [  5   1]]
Model improve: 0.0000 -> 0.1429
Epoch: 2/13
Train loss:0.1875, Valid loss:0.1323
Val metric mean prob: 0.0383
Best metric at epoch 2: 0.1379 0.0610 0.6178
Cf: [[194  21]
 [  4   2]]
Epoch: 3/13
Train loss:0.0943, Valid loss:0.1305
Val metric mean prob: 0.0333
Best metric at epoch 3: 0.2609 0.0420 0.7174
Cf: [[201  14]
 [  3   3]]
Model improve: 0.1429 -> 0.2609
Epoch: 4/13
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 500
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.0912, Valid loss:0.1311
Val metric mean prob: 0.0431
Best metric at epoch 1: 0.2400 0.0720 0.7128
Cf: [[199  16]
 [  3   3]]
Model improve: 0.0000 -> 0.2400
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 500
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.1882, Valid loss:0.1453
Val metric mean prob: 0.0446
Best metric at epoch 1: 0.1818 0.0970 0.6341
Cf: [[201  14]
 [  4   2]]
Model improve: 0.0000 -> 0.1818
Epoch: 2/13
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 500
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.1965, Valid loss:0.1355
Val metric mean prob: 0.0401
Best metric at epoch 1: 0.1818 0.0650 0.6942
Cf: [[191  24]
 [  3   3]]
Model improve: 0.0000 -> 0.1818
Epoch: 2/13
Train loss:0.1005, Valid loss:0.1297
Val metric mean prob: 0.0350
Best metric at epoch 2: 0.2667 0.0490 0.6504
Cf: [[208   7]
 [  4   2]]
Model improve: 0.1818 -> 0.2667
Epoch: 3/13
Train loss:0.0840, Valid loss:0.1352
Val metric mean prob: 0.0415
Best metric at epoch 3: 0.3000 0.0530 0.7244
Cf: [[204  11]
 [  3   3]]
Model improve: 0.2667 -> 0.3000
Epoch: 4/13
Train loss:0.0763, Valid loss:0.1433
Val metric mean prob: 0.0248
Best metric at epoch 4: 0.3158 0.0240 0.7267
Cf: [[205  10]
 [  3   3]]
Model improve: 0.3000 -> 0.3158
Epoch: 5/13
Train loss:0.0681, Valid loss:0.1334
Val metric mean prob: 0.0344
Best metric at epoch 5: 0.2667 0.0500 0.6504
Cf: [[208   7]
 [  4   2]]
Epoch: 6/13
Train loss:0.0610, Valid loss:0.1290
Val metric mean prob: 0.0537
Best metric at epoch 6: 0.3077 0.1010 0.6550
Cf: [[210   5]
 [  4   2]]
Epoch: 7/13
Train loss:0.0563, Valid loss:0.1389
Val metric mean prob: 0.0343
Best metric at epoch 7: 0.2667 0.0470 0.6504
Cf: [[208   7]
 [  4   2]]
Epoch: 8/13
Train loss:0.0600, Valid loss:0.1466
Val metric mean prob: 0.0262
Best metric at epoch 8: 0.2222 0.0200 0.7081
Cf: [[197  18]
 [  3   3]]
Epoch: 9/13
Date :02/01/2023, 07:52:31
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 500
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.6039, Valid loss:0.3298
Val metric mean prob: 0.0472
Best metric at epoch 1: 0.1333 0.3290 0.5647
Cf: [[207   8]
 [  5   1]]
Model improve: 0.0000 -> 0.1333
Epoch: 2/13
Train loss:0.2025, Valid loss:0.1330
Val metric mean prob: 0.0384
Best metric at epoch 2: 0.1714 0.0550 0.6895
Cf: [[189  26]
 [  3   3]]
Model improve: 0.1333 -> 0.1714
Epoch: 3/13
Train loss:0.0978, Valid loss:0.1312
Val metric mean prob: 0.0363
Best metric at epoch 3: 0.2500 0.0520 0.7151
Cf: [[200  15]
 [  3   3]]
Model improve: 0.1714 -> 0.2500
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 500
Len valid df: 500
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 500
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.1980, Valid loss:0.1379
Val metric mean prob: 0.0412
Best metric at epoch 1: 0.2222 0.0750 0.6434
Cf: [[205  10]
 [  4   2]]
Model improve: 0.0000 -> 0.2222
Epoch: 2/13
Date :02/01/2023, 15:27:16
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2159, Valid loss:0.1106
Val metric mean prob: 0.0522
Best metric at epoch 1: 0.1356 0.1510 0.5976
Cf: [[2218  116]
 [  37   12]]
Model improve: 0.0000 -> 0.1356
Epoch: 2/13
Train loss:0.1545, Valid loss:0.1114
Val metric mean prob: 0.1110
Best metric at epoch 2: 0.3333 0.3190 0.6566
Cf: [[2303   31]
 [  33   16]]
Model improve: 0.1356 -> 0.3333
Epoch: 3/13
Train loss:0.1382, Valid loss:0.1011
Val metric mean prob: 0.1590
Best metric at epoch 3: 0.3925 0.3090 0.7064
Cf: [[2297   37]
 [  28   21]]
Model improve: 0.3333 -> 0.3925
Epoch: 4/13
Train loss:0.1265, Valid loss:0.0881
Val metric mean prob: 0.1800
Best metric at epoch 4: 0.4634 0.3430 0.6909
Cf: [[2320   14]
 [  30   19]]
Model improve: 0.3925 -> 0.4634
Epoch: 5/13
Train loss:0.1166, Valid loss:0.0737
Val metric mean prob: 0.2315
Best metric at epoch 5: 0.5111 0.1050 0.7308
Cf: [[2316   18]
 [  26   23]]
Model improve: 0.4634 -> 0.5111
Epoch: 6/13
Train loss:0.1064, Valid loss:0.0772
Val metric mean prob: 0.1987
Best metric at epoch 6: 0.4444 0.1230 0.7563
Cf: [[2292   42]
 [  23   26]]
Epoch: 7/13
Train loss:0.0959, Valid loss:0.0825
Val metric mean prob: 0.2362
Best metric at epoch 7: 0.4356 0.2640 0.7181
Cf: [[2304   30]
 [  27   22]]
Epoch: 8/13
Train loss:0.0830, Valid loss:0.0812
Val metric mean prob: 0.2461
Best metric at epoch 8: 0.4750 0.3250 0.6913
Cf: [[2322   12]
 [  30   19]]
Epoch: 9/13
Train loss:0.0737, Valid loss:0.0859
Val metric mean prob: 0.2711
Best metric at epoch 9: 0.4516 0.1340 0.7094
Cf: [[2311   23]
 [  28   21]]
Epoch: 10/13
Train loss:0.0652, Valid loss:0.0868
Val metric mean prob: 0.2894
Best metric at epoch 10: 0.4583 0.1860 0.7191
Cf: [[2309   25]
 [  27   22]]
Epoch: 11/13
Train loss:0.0590, Valid loss:0.0896
Val metric mean prob: 0.2865
Best metric at epoch 11: 0.4828 0.1980 0.7106
Cf: [[2317   17]
 [  28   21]]
Epoch: 12/13
Train loss:0.0551, Valid loss:0.0937
Val metric mean prob: 0.3024
Best metric at epoch 12: 0.4538 0.1290 0.7663
Cf: [[2291   43]
 [  22   27]]
Epoch: 13/13
Train loss:0.0545, Valid loss:0.0922
Val metric mean prob: 0.3082
Best metric at epoch 13: 0.4828 0.2550 0.7106
Cf: [[2317   17]
 [  28   21]]
10 fold
Fold: 6
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2144, Valid loss:0.1049
Val metric mean prob: 0.0544
Best metric at epoch 1: 0.1498 0.1010 0.6844
Cf: [[2099  235]
 [  26   23]]
Model improve: 0.0000 -> 0.1498
Epoch: 2/13
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0770
Val metric mean prob: 0.3172
Best metric at epoch 1: 0.5060 0.2290 0.7115
Cf: [[2321   13]
 [  28   21]]
Model improve: 0.0000 -> 0.5060
Epoch: 2/13
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0794
Val metric mean prob: 0.3128
Best metric at epoch 1: 0.5116 0.2450 0.7213
Cf: [[2319   15]
 [  27   22]]
Model improve: 0.0000 -> 0.5116
Epoch: 2/13
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0767
Val metric mean prob: 0.3034
Best metric at epoch 1: 0.5111 0.2710 0.7308
Cf: [[2316   18]
 [  26   23]]
Model improve: 0.0000 -> 0.5111
Epoch: 2/13
10 fold
Fold: 5
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0794
Val metric mean prob: 0.3128
Best metric at epoch 1: 0.5116 0.2450 0.7213
Cf: [[2319   15]
 [  27   22]]
Model improve: 0.0000 -> 0.5116
Epoch: 2/13
Date :02/01/2023, 23:57:55
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 6
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2149, Valid loss:0.1030
Val metric mean prob: 0.0412
Best metric at epoch 1: 0.1466 0.0730 0.6154
Cf: [[2206  128]
 [  35   14]]
Model improve: 0.0000 -> 0.1466
Epoch: 2/13
Train loss:0.1535, Valid loss:0.0903
Val metric mean prob: 0.1172
Best metric at epoch 2: 0.3562 0.2600 0.6303
Cf: [[2323   11]
 [  36   13]]
Model improve: 0.1466 -> 0.3562
Epoch: 3/13
Train loss:0.1365, Valid loss:0.0813
Val metric mean prob: 0.1839
Best metric at epoch 3: 0.4304 0.2810 0.6707
Cf: [[2321   13]
 [  32   17]]
Model improve: 0.3562 -> 0.4304
Epoch: 4/13
Train loss:0.1257, Valid loss:0.0822
Val metric mean prob: 0.1716
Best metric at epoch 4: 0.3810 0.2610 0.6592
Cf: [[2315   19]
 [  33   16]]
Epoch: 5/13
Train loss:0.1155, Valid loss:0.0752
Val metric mean prob: 0.1777
Best metric at epoch 5: 0.4808 0.1030 0.7487
Cf: [[2304   30]
 [  24   25]]
Model improve: 0.4304 -> 0.4808
Epoch: 6/13
Train loss:0.1054, Valid loss:0.0764
Val metric mean prob: 0.2334
Best metric at epoch 6: 0.5128 0.3070 0.7022
Cf: [[2325    9]
 [  29   20]]
Model improve: 0.4808 -> 0.5128
Epoch: 7/13
Train loss:0.0927, Valid loss:0.0818
Val metric mean prob: 0.2489
Best metric at epoch 7: 0.5385 0.4230 0.7126
Cf: [[2326    8]
 [  28   21]]
Model improve: 0.5128 -> 0.5385
Epoch: 8/13
Train loss:0.0822, Valid loss:0.0828
Val metric mean prob: 0.2502
Best metric at epoch 8: 0.4857 0.4160 0.6726
Cf: [[2330    4]
 [  32   17]]
Epoch: 9/13
Train loss:0.0709, Valid loss:0.0824
Val metric mean prob: 0.2738
Best metric at epoch 9: 0.5135 0.3380 0.6926
Cf: [[2328    6]
 [  30   19]]
Epoch: 10/13
Train loss:0.0619, Valid loss:0.0923
Val metric mean prob: 0.2482
Best metric at epoch 10: 0.4789 0.3470 0.6724
Cf: [[2329    5]
 [  32   17]]
Epoch: 11/13
Train loss:0.0550, Valid loss:0.0948
Val metric mean prob: 0.2545
Best metric at epoch 11: 0.4658 0.3290 0.6720
Cf: [[2327    7]
 [  32   17]]
Epoch: 12/13
Train loss:0.0514, Valid loss:0.0959
Val metric mean prob: 0.2614
Best metric at epoch 12: 0.4928 0.4220 0.6728
Cf: [[2331    3]
 [  32   17]]
Epoch: 13/13
10 fold
Fold: 6
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0781
Val metric mean prob: 0.2581
Best metric at epoch 1: 0.5000 0.4350 0.6922
Cf: [[2326    8]
 [  30   19]]
Model improve: 0.0000 -> 0.5000
Epoch: 2/13
10 fold
Fold: 6
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0742
Val metric mean prob: 0.2678
Best metric at epoch 1: 0.5526 0.3500 0.7130
Cf: [[2328    6]
 [  28   21]]
Model improve: 0.0000 -> 0.5526
Epoch: 2/13
10 fold
Fold: 6
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0763
Val metric mean prob: 0.2808
Best metric at epoch 1: 0.5789 0.4000 0.7234
Cf: [[2329    5]
 [  27   22]]
Model improve: 0.0000 -> 0.5789
Epoch: 2/13
10 fold
Fold: 7
Model name: tf_efficientnetv2_b2
Len train df: 60
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.7427, Valid loss:0.6477
Val metric mean prob: 0.0260
Best metric at epoch 1: 0.1250 0.5130 0.6394
Cf: [[208  12]
 [  2   1]]
Model improve: 0.0000 -> 0.1250
Epoch: 2/13
Train loss:0.6632, Valid loss:0.5813
Val metric mean prob: 0.0261
Best metric at epoch 2: 0.1429 0.4860 0.6439
Cf: [[210  10]
 [  2   1]]
Model improve: 0.1250 -> 0.1429
Epoch: 3/13
10 fold
Fold: 7
Model name: tf_efficientnetv2_b2
Len train df: 60
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.6324, Valid loss:0.5826
Val metric mean prob: 0.0261
Best metric at epoch 1: 0.1250 0.4850 0.6394
Cf: [[208  12]
 [  2   1]]
Model improve: 0.0000 -> 0.1250
Epoch: 2/13
10 fold
Fold: 7
Model name: tf_efficientnetv2_b2
Len train df: 60
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 3/13
Train loss:0.6324, Valid loss:0.5826
Val metric mean prob: 0.0261
Best metric at epoch 3: 0.1250 0.4850 0.6394
Cf: [[208  12]
 [  2   1]]
Model improve: 0.0000 -> 0.1250
10 fold
Fold: 7
Model name: tf_efficientnetv2_b2
Len train df: 60
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.7427, Valid loss:0.6477
Val metric mean prob: 0.0260
Best metric at epoch 1: 0.1250 0.5130 0.6394
Cf: [[208  12]
 [  2   1]]
Model improve: 0.0000 -> 0.1250
Epoch: 2/13
Train loss:0.6632, Valid loss:0.5813
Val metric mean prob: 0.0261
Best metric at epoch 2: 0.1429 0.4860 0.6439
Cf: [[210  10]
 [  2   1]]
Model improve: 0.1250 -> 0.1429
Epoch: 3/13
Train loss:0.5574, Valid loss:0.5307
Val metric mean prob: 0.0257
Best metric at epoch 3: 0.0500 0.4490 0.5848
Cf: [[184  36]
 [  2   1]]
Epoch: 4/13
10 fold
Fold: 7
Model name: tf_efficientnetv2_b2
Len train df: 60
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 3/13
Train loss:0.4834, Valid loss:0.5379
Val metric mean prob: 0.0259
Best metric at epoch 3: 0.0541 0.4520 0.5917
Cf: [[187  33]
 [  2   1]]
Model improve: 0.0000 -> 0.0541
Epoch: 4/13
Train loss:0.4375, Valid loss:0.4950
Val metric mean prob: 0.0257
Best metric at epoch 4: 0.0345 0.3800 0.5811
Cf: [[109 111]
 [  1   2]]
Epoch: 5/13
10 fold
Fold: 7
Model name: tf_efficientnetv2_b2
Len train df: 60
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :2
Epoch: 1/2
Train loss:0.7427, Valid loss:0.6477
Val metric mean prob: 0.0260
Best metric at epoch 1: 0.1250 0.5130 0.6394
Cf: [[208  12]
 [  2   1]]
Model improve: 0.0000 -> 0.1250
Epoch: 2/2
Train loss:0.6661, Valid loss:0.5895
Val metric mean prob: 0.0261
Best metric at epoch 2: 0.1429 0.4890 0.6439
Cf: [[210  10]
 [  2   1]]
Model improve: 0.1250 -> 0.1429
10 fold
Fold: 8
Model name: tf_efficientnetv2_b2
Len train df: 60
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :2
Epoch: 1/2
Train loss:0.6921, Valid loss:0.6232
Val metric mean prob: 0.0329
Best metric at epoch 1: 0.0432 0.4330 0.5922
Cf: [[ 40 177]
 [  0   4]]
Model improve: 0.0000 -> 0.0432
Epoch: 2/2
Train loss:0.6135, Valid loss:0.6227
Val metric mean prob: 0.0335
Best metric at epoch 2: 0.0406 0.4290 0.5645
Cf: [[ 28 189]
 [  0   4]]
10 fold
Fold: 9
Model name: tf_efficientnetv2_b2
Len train df: 60
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :2
Epoch: 1/2
10 fold
Fold: 8
Model name: tf_efficientnetv2_b2
Len train df: 60
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :2
Epoch: 1/2
Train loss:0.7428, Valid loss:0.6493
Val metric mean prob: 0.0342
Best metric at epoch 1: 0.0491 0.4570 0.6429
Cf: [[ 62 155]
 [  0   4]]
Model improve: 0.0000 -> 0.0491
Epoch: 2/2
Train loss:0.6680, Valid loss:0.5899
Val metric mean prob: 0.0335
Best metric at epoch 2: 0.0426 0.4270 0.5662
Cf: [[ 83 134]
 [  1   3]]
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 60
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.0160, Valid loss:0.0864
Val metric mean prob: 0.2862
Best metric at epoch 1: 0.5000 0.2970 0.6667
Cf: [[216   0]
 [  4   2]]
Model improve: 0.0000 -> 0.5000
Date :02/02/2023, 15:12:11
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2152, Valid loss:0.1067
Val metric mean prob: 0.0511
Best metric at epoch 1: 0.2410 0.1550 0.5969
Cf: [[2309   24]
 [  39   10]]
Model improve: 0.0000 -> 0.2410
Epoch: 2/13
Train loss:0.1562, Valid loss:0.0911
Val metric mean prob: 0.1195
Best metric at epoch 2: 0.3704 0.2270 0.6494
Cf: [[2316   17]
 [  34   15]]
Model improve: 0.2410 -> 0.3704
Epoch: 3/13
Train loss:0.1386, Valid loss:0.0952
Val metric mean prob: 0.1651
Best metric at epoch 3: 0.4524 0.3310 0.6904
Cf: [[2317   16]
 [  30   19]]
Model improve: 0.3704 -> 0.4524
Epoch: 4/13
Train loss:0.1246, Valid loss:0.0895
Val metric mean prob: 0.1518
Best metric at epoch 4: 0.3797 0.3000 0.6498
Cf: [[2318   15]
 [  34   15]]
Epoch: 5/13
Train loss:0.1150, Valid loss:0.0806
Val metric mean prob: 0.2277
Best metric at epoch 5: 0.4337 0.2840 0.6802
Cf: [[2317   16]
 [  31   18]]
Epoch: 6/13
Train loss:0.1029, Valid loss:0.0839
Val metric mean prob: 0.2384
Best metric at epoch 6: 0.4510 0.2280 0.7283
Cf: [[2303   30]
 [  26   23]]
Epoch: 7/13
Train loss:0.0913, Valid loss:0.0943
Val metric mean prob: 0.2259
Best metric at epoch 7: 0.3774 0.2830 0.6962
Cf: [[2296   37]
 [  29   20]]
Epoch: 8/13
Train loss:0.0785, Valid loss:0.0896
Val metric mean prob: 0.2453
Best metric at epoch 8: 0.4211 0.2310 0.6985
Cf: [[2307   26]
 [  29   20]]
Epoch: 9/13
Train loss:0.0690, Valid loss:0.0973
Val metric mean prob: 0.2392
Best metric at epoch 9: 0.3488 0.2200 0.6483
Cf: [[2311   22]
 [  34   15]]
Epoch: 10/13
Train loss:0.0600, Valid loss:0.1038
Val metric mean prob: 0.2642
Best metric at epoch 10: 0.3810 0.1180 0.7335
Cf: [[2280   53]
 [  25   24]]
Epoch: 11/13
Train loss:0.0525, Valid loss:0.1073
Val metric mean prob: 0.2609
Best metric at epoch 11: 0.3908 0.3460 0.6690
Cf: [[2312   21]
 [  32   17]]
Epoch: 12/13
Train loss:0.0487, Valid loss:0.1119
Val metric mean prob: 0.2540
Best metric at epoch 12: 0.3462 0.2100 0.6757
Cf: [[2296   37]
 [  31   18]]
Epoch: 13/13
Train loss:0.0466, Valid loss:0.1106
Val metric mean prob: 0.2575
Best metric at epoch 13: 0.3636 0.2420 0.6768
Cf: [[2301   32]
 [  31   18]]
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Date :02/02/2023, 23:25:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0791
Val metric mean prob: 0.2622
Best metric at epoch 1: 0.4946 0.2660 0.7302
Cf: [[2312   21]
 [  26   23]]
Model improve: 0.0000 -> 0.4946
Date :02/02/2023, 23:45:24
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2152, Valid loss:0.1001
Val metric mean prob: 0.0434
Best metric at epoch 1: 0.2041 0.0930 0.5919
Cf: [[2295   38]
 [  40   10]]
Model improve: 0.0000 -> 0.2041
Epoch: 2/13
Train loss:0.1545, Valid loss:0.0906
Val metric mean prob: 0.1568
Best metric at epoch 2: 0.2759 0.1770 0.6146
Cf: [[2308   25]
 [  38   12]]
Model improve: 0.2041 -> 0.2759
Epoch: 3/13
Train loss:0.1381, Valid loss:0.0891
Val metric mean prob: 0.2136
Best metric at epoch 3: 0.4286 0.3700 0.6766
Cf: [[2317   16]
 [  32   18]]
Model improve: 0.2759 -> 0.4286
Epoch: 4/13
Train loss:0.1232, Valid loss:0.0787
Val metric mean prob: 0.1867
Best metric at epoch 4: 0.4118 0.3700 0.6391
Cf: [[2329    4]
 [  36   14]]
Epoch: 5/13
Train loss:0.1143, Valid loss:0.0995
Val metric mean prob: 0.2253
Best metric at epoch 5: 0.4800 0.5310 0.6785
Cf: [[2326    7]
 [  32   18]]
Model improve: 0.4286 -> 0.4800
Epoch: 6/13
Train loss:0.1022, Valid loss:0.0752
Val metric mean prob: 0.2845
Best metric at epoch 6: 0.5349 0.3500 0.7272
Cf: [[2320   13]
 [  27   23]]
Model improve: 0.4800 -> 0.5349
Epoch: 7/13
Train loss:0.0917, Valid loss:0.0767
Val metric mean prob: 0.2804
Best metric at epoch 7: 0.4675 0.3090 0.6781
Cf: [[2324    9]
 [  32   18]]
Epoch: 8/13
Train loss:0.0820, Valid loss:0.0809
Val metric mean prob: 0.3020
Best metric at epoch 8: 0.5316 0.3670 0.7083
Cf: [[2325    8]
 [  29   21]]
Epoch: 9/13
Train loss:0.0725, Valid loss:0.0838
Val metric mean prob: 0.3454
Best metric at epoch 9: 0.5195 0.3950 0.6985
Cf: [[2326    7]
 [  30   20]]
Epoch: 10/13
Train loss:0.0603, Valid loss:0.0877
Val metric mean prob: 0.3483
Best metric at epoch 10: 0.5349 0.3520 0.7272
Cf: [[2320   13]
 [  27   23]]
Epoch: 11/13
Train loss:0.0568, Valid loss:0.0910
Val metric mean prob: 0.3519
Best metric at epoch 11: 0.5287 0.3260 0.7270
Cf: [[2319   14]
 [  27   23]]
Epoch: 12/13
Train loss:0.0501, Valid loss:0.0909
Val metric mean prob: 0.3419
Best metric at epoch 12: 0.5055 0.3080 0.7261
Cf: [[2315   18]
 [  27   23]]
Epoch: 13/13
Train loss:0.0522, Valid loss:0.0924
Val metric mean prob: 0.3491
Best metric at epoch 13: 0.5176 0.3280 0.7172
Cf: [[2320   13]
 [  28   22]]
10 fold
Fold: 7
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0827
Val metric mean prob: 0.3440
Best metric at epoch 1: 0.5366 0.4010 0.7179
Cf: [[2323   10]
 [  28   22]]
Model improve: 0.0000 -> 0.5366
Epoch: 2/13
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0795
Val metric mean prob: 0.3241
Best metric at epoch 1: 0.5263 0.4620 0.6987
Cf: [[2327    6]
 [  30   20]]
Model improve: 0.0000 -> 0.5263
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0764
Val metric mean prob: 0.3023
Best metric at epoch 1: 0.5238 0.3720 0.7174
Cf: [[2321   12]
 [  28   22]]
Model improve: 0.0000 -> 0.5238
Epoch: 2/13
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0795
Val metric mean prob: 0.3264
Best metric at epoch 1: 0.5316 0.4450 0.7083
Cf: [[2325    8]
 [  29   21]]
Model improve: 0.0000 -> 0.5316
Epoch: 2/13
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0804
Val metric mean prob: 0.3270
Best metric at epoch 1: 0.5301 0.4210 0.7176
Cf: [[2322   11]
 [  28   22]]
Model improve: 0.0000 -> 0.5301
Epoch: 2/13
Date :02/03/2023, 07:50:30
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 7
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2153, Valid loss:0.1023
Val metric mean prob: 0.0559
Best metric at epoch 1: 0.1935 0.1320 0.6089
Cf: [[2270   63]
 [  37   12]]
Model improve: 0.0000 -> 0.1935
Epoch: 2/13
Train loss:0.1543, Valid loss:0.0883
Val metric mean prob: 0.1473
Best metric at epoch 2: 0.4220 0.1700 0.7268
Cf: [[2296   37]
 [  26   23]]
Model improve: 0.1935 -> 0.4220
Epoch: 3/13
Train loss:0.1360, Valid loss:0.1010
Val metric mean prob: 0.1546
Best metric at epoch 3: 0.4444 0.3180 0.6807
Cf: [[2319   14]
 [  31   18]]
Model improve: 0.4220 -> 0.4444
Epoch: 4/13
Train loss:0.1228, Valid loss:0.0905
Val metric mean prob: 0.2082
Best metric at epoch 4: 0.4222 0.3180 0.6892
Cf: [[2311   22]
 [  30   19]]
Epoch: 5/13
Train loss:0.1123, Valid loss:0.0791
Val metric mean prob: 0.2573
Best metric at epoch 5: 0.4396 0.1540 0.6994
Cf: [[2311   22]
 [  29   20]]
Epoch: 6/13
Train loss:0.1019, Valid loss:0.0804
Val metric mean prob: 0.2771
Best metric at epoch 6: 0.4762 0.1920 0.7485
Cf: [[2302   31]
 [  24   25]]
Model improve: 0.4444 -> 0.4762
Epoch: 7/13
Train loss:0.0915, Valid loss:0.0852
Val metric mean prob: 0.2788
Best metric at epoch 7: 0.5111 0.2670 0.7308
Cf: [[2315   18]
 [  26   23]]
Model improve: 0.4762 -> 0.5111
Epoch: 8/13
Train loss:0.0816, Valid loss:0.0847
Val metric mean prob: 0.2952
Best metric at epoch 8: 0.5111 0.2160 0.7308
Cf: [[2315   18]
 [  26   23]]
Epoch: 9/13
Train loss:0.0724, Valid loss:0.0963
Val metric mean prob: 0.3041
Best metric at epoch 9: 0.4337 0.2230 0.6802
Cf: [[2317   16]
 [  31   18]]
Epoch: 10/13
Train loss:0.0609, Valid loss:0.0958
Val metric mean prob: 0.3061
Best metric at epoch 10: 0.4681 0.2110 0.7196
Cf: [[2310   23]
 [  27   22]]
Epoch: 11/13
Train loss:0.0582, Valid loss:0.1021
Val metric mean prob: 0.3162
Best metric at epoch 11: 0.4500 0.2600 0.6809
Cf: [[2320   13]
 [  31   18]]
Epoch: 12/13
Train loss:0.0512, Valid loss:0.1022
Val metric mean prob: 0.3194
Best metric at epoch 12: 0.4368 0.2590 0.6898
Cf: [[2314   19]
 [  30   19]]
Epoch: 13/13
10 fold
Fold: 7
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0807
Val metric mean prob: 0.2901
Best metric at epoch 1: 0.4954 0.1870 0.7684
Cf: [[2300   33]
 [  22   27]]
Model improve: 0.0000 -> 0.4954
Epoch: 2/13
Valid loss:0.0807
Val metric mean prob: 0.2901
Best metric at epoch 2: 0.4954 0.1870 0.7684
Cf: [[2300   33]
 [  22   27]]
Epoch: 3/13
Date :02/03/2023, 15:02:19
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 8
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2162, Valid loss:0.1032
Val metric mean prob: 0.0373
Best metric at epoch 1: 0.1194 0.1040 0.5378
Cf: [[2320   14]
 [  45    4]]
Model improve: 0.0000 -> 0.1194
Epoch: 2/13
Train loss:0.1562, Valid loss:0.0853
Val metric mean prob: 0.1675
Best metric at epoch 2: 0.3486 0.2260 0.6851
Cf: [[2293   41]
 [  30   19]]
Model improve: 0.1194 -> 0.3486
Epoch: 3/13
Train loss:0.1377, Valid loss:0.0881
Val metric mean prob: 0.2064
Best metric at epoch 3: 0.4000 0.2530 0.7255
Cf: [[2291   43]
 [  26   23]]
Model improve: 0.3486 -> 0.4000
Epoch: 4/13
Train loss:0.1244, Valid loss:0.0809
Val metric mean prob: 0.2143
Best metric at epoch 4: 0.4186 0.2650 0.6796
Cf: [[2315   19]
 [  31   18]]
Model improve: 0.4000 -> 0.4186
Epoch: 5/13
Train loss:0.1128, Valid loss:0.0795
Val metric mean prob: 0.2158
Best metric at epoch 5: 0.4675 0.1750 0.6815
Cf: [[2324   10]
 [  31   18]]
Model improve: 0.4186 -> 0.4675
Epoch: 6/13
Train loss:0.1031, Valid loss:0.0829
Val metric mean prob: 0.2646
Best metric at epoch 6: 0.4468 0.2600 0.7091
Cf: [[2310   24]
 [  28   21]]
Epoch: 7/13
Train loss:0.0924, Valid loss:0.0922
Val metric mean prob: 0.2656
Best metric at epoch 7: 0.4304 0.4540 0.6707
Cf: [[2321   13]
 [  32   17]]
Epoch: 8/13
Train loss:0.0840, Valid loss:0.0895
Val metric mean prob: 0.2715
Best metric at epoch 8: 0.4658 0.4120 0.6720
Cf: [[2327    7]
 [  32   17]]
Epoch: 9/13
Train loss:0.0700, Valid loss:0.0993
Val metric mean prob: 0.2932
Best metric at epoch 9: 0.4444 0.4410 0.6807
Cf: [[2320   14]
 [  31   18]]
Epoch: 10/13
Train loss:0.0598, Valid loss:0.1065
Val metric mean prob: 0.3127
Best metric at epoch 10: 0.4571 0.4910 0.6622
Cf: [[2329    5]
 [  33   16]]
Epoch: 11/13
Train loss:0.0549, Valid loss:0.1098
Val metric mean prob: 0.2996
Best metric at epoch 11: 0.4318 0.3270 0.6896
Cf: [[2314   20]
 [  30   19]]
Epoch: 12/13
Train loss:0.0507, Valid loss:0.1112
Val metric mean prob: 0.3064
Best metric at epoch 12: 0.4516 0.3290 0.7094
Cf: [[2311   23]
 [  28   21]]
Epoch: 13/13
Train loss:0.0508, Valid loss:0.1094
Val metric mean prob: 0.3033
Best metric at epoch 13: 0.4742 0.3370 0.7293
Cf: [[2309   25]
 [  26   23]]
Model improve: 0.4675 -> 0.4742
10 fold
Fold: 9
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2135, Valid loss:0.0996
Val metric mean prob: 0.0408
Best metric at epoch 1: 0.1373 0.0930 0.5616
Cf: [[2287   46]
 [  42    7]]
Model improve: 0.0000 -> 0.1373
Epoch: 2/13
10 fold
Fold: 8
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0864
Val metric mean prob: 0.2950
Best metric at epoch 1: 0.4675 0.4320 0.6815
Cf: [[2324   10]
 [  31   18]]
Model improve: 0.0000 -> 0.4675
Epoch: 2/13
10 fold
Fold: 8
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0862
Val metric mean prob: 0.2953
Best metric at epoch 1: 0.4545 0.3010 0.7000
Cf: [[2315   19]
 [  29   20]]
Model improve: 0.0000 -> 0.4545
Epoch: 2/13
10 fold
Fold: 8
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0862
Val metric mean prob: 0.2953
Best metric at epoch 1: 0.4545 0.3010 0.7000
Cf: [[2315   19]
 [  29   20]]
Model improve: 0.0000 -> 0.4545
Epoch: 2/13
Date :02/03/2023, 23:38:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 9
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2156, Valid loss:0.1071
Val metric mean prob: 0.0438
Best metric at epoch 1: 0.1333 0.1150 0.5753
Cf: [[2256   77]
 [  40    9]]
Model improve: 0.0000 -> 0.1333
Epoch: 2/13
Train loss:0.1523, Valid loss:0.0913
Val metric mean prob: 0.1193
Best metric at epoch 2: 0.2694 0.1120 0.7400
Cf: [[2215  118]
 [  23   26]]
Model improve: 0.1333 -> 0.2694
Epoch: 3/13
Train loss:0.1361, Valid loss:0.0898
Val metric mean prob: 0.1309
Best metric at epoch 3: 0.4000 0.1670 0.7348
Cf: [[2286   47]
 [  25   24]]
Model improve: 0.2694 -> 0.4000
Epoch: 4/13
Train loss:0.1238, Valid loss:0.0844
Val metric mean prob: 0.1411
Best metric at epoch 4: 0.3784 0.2170 0.6405
Cf: [[2322   11]
 [  35   14]]
Epoch: 5/13
Train loss:0.1120, Valid loss:0.0891
Val metric mean prob: 0.1867
Best metric at epoch 5: 0.3810 0.2640 0.6592
Cf: [[2314   19]
 [  33   16]]
Epoch: 6/13
Train loss:0.1006, Valid loss:0.0986
Val metric mean prob: 0.1958
Best metric at epoch 6: 0.3429 0.4230 0.6205
Cf: [[2324    9]
 [  37   12]]
Epoch: 7/13
Train loss:0.0907, Valid loss:0.0949
Val metric mean prob: 0.2151
Best metric at epoch 7: 0.4130 0.2670 0.6887
Cf: [[2309   24]
 [  30   19]]
Model improve: 0.4000 -> 0.4130
Epoch: 8/13
Train loss:0.0793, Valid loss:0.1008
Val metric mean prob: 0.1958
Best metric at epoch 8: 0.3611 0.4300 0.6305
Cf: [[2323   10]
 [  36   13]]
Epoch: 9/13
Train loss:0.0693, Valid loss:0.1039
Val metric mean prob: 0.2358
Best metric at epoch 9: 0.4419 0.2950 0.6900
Cf: [[2315   18]
 [  30   19]]
Model improve: 0.4130 -> 0.4419
Epoch: 10/13
Train loss:0.0604, Valid loss:0.1108
Val metric mean prob: 0.2238
Best metric at epoch 10: 0.4000 0.1750 0.7161
Cf: [[2294   39]
 [  27   22]]
Epoch: 11/13
Train loss:0.0552, Valid loss:0.1145
Val metric mean prob: 0.2354
Best metric at epoch 11: 0.4045 0.3090 0.6790
Cf: [[2311   22]
 [  31   18]]
Epoch: 12/13
Train loss:0.0493, Valid loss:0.1172
Val metric mean prob: 0.2435
Best metric at epoch 12: 0.3951 0.3640 0.6598
Cf: [[2317   16]
 [  33   16]]
Epoch: 13/13
Date :02/04/2023, 06:52:19
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 41898
Len valid df: 13676
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :30
Epoch: 1/30
Date :02/04/2023, 06:53:09
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.75, limit=(-0.2, 0.2)),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-1.0, 1.0), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    GridDistortion(always_apply=False, p=0.5, num_steps=5, distort_limit=(-1.0, 1.0), interpolation=1, border_mode=4, value=None, mask_value=None, normalized=False),
  ], p=0.75),
  HueSaturationValue(always_apply=False, p=0.75, hue_shift_limit=(-40, 40), sat_shift_limit=(-40, 40), val_shift_limit=(0, 0)),
  ShiftScaleRotate(always_apply=False, p=0.75, shift_limit_x=(-0.2, 0.2), shift_limit_y=(-0.2, 0.2), scale_limit=(-0.30000000000000004, 0.30000000000000004), rotate_limit=(-30, 30), interpolation=1, border_mode=0, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 41898
Len valid df: 13676
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.1
)
total_epoch :30
Epoch: 1/30
Train loss:0.2189, Valid loss:0.1050
Val metric mean prob: 0.0293
Best metric at epoch 1: 0.0875 0.0660 0.5259
Cf: [[5803   30]
 [ 116    7]]
Model improve: 0.0000 -> 0.0875
Epoch: 2/30
Train loss:0.1714, Valid loss:0.1091
Val metric mean prob: 0.0388
Best metric at epoch 2: 0.1149 0.1120 0.5504
Cf: [[5710  123]
 [ 108   15]]
Model improve: 0.0875 -> 0.1149
Epoch: 3/30
Train loss:0.1684, Valid loss:0.1149
Val metric mean prob: 0.0422
Best metric at epoch 3: 0.0918 0.1100 0.5653
Cf: [[5457  376]
 [  99   24]]
Epoch: 4/30
Train loss:0.1660, Valid loss:0.0984
Val metric mean prob: 0.0527
Best metric at epoch 4: 0.1499 0.0920 0.5977
Cf: [[5598  235]
 [  94   29]]
Model improve: 0.1149 -> 0.1499
Epoch: 5/30
Date :02/04/2023, 09:40:05
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 41898
Len valid df: 13676
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.1
)
total_epoch :30
Epoch: 1/30
Train loss:0.2202, Valid loss:0.1073
Val metric mean prob: 0.0435
Best metric at epoch 1: 0.1301 0.1390 0.5559
Cf: [[5726  107]
 [ 107   16]]
Model improve: 0.0000 -> 0.1301
Epoch: 2/30
Train loss:0.1593, Valid loss:0.0951
Val metric mean prob: 0.0759
Best metric at epoch 2: 0.2826 0.1630 0.6027
Cf: [[5798   35]
 [  97   26]]
Model improve: 0.1301 -> 0.2826
Epoch: 3/30
Train loss:0.1443, Valid loss:0.0929
Val metric mean prob: 0.1395
Best metric at epoch 3: 0.3487 0.3030 0.6350
Cf: [[5795   38]
 [  89   34]]
Model improve: 0.2826 -> 0.3487
Epoch: 4/30
Train loss:0.1339, Valid loss:0.0875
Val metric mean prob: 0.1734
Best metric at epoch 4: 0.3762 0.2730 0.6510
Cf: [[5792   41]
 [  85   38]]
Model improve: 0.3487 -> 0.3762
Epoch: 5/30
Train loss:0.1243, Valid loss:0.1144
Val metric mean prob: 0.1718
Best metric at epoch 5: 0.3604 0.4500 0.6575
Cf: [[5774   59]
 [  83   40]]
Date :02/04/2023, 12:33:08
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 43727
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :30
Epoch: 1/30
Train loss:0.1583, Valid loss:0.1006
Val metric mean prob: 0.0284
Best metric at epoch 1: 0.0809 0.0420 0.5648
Cf: [[4244  422]
 [  78   22]]
Model improve: 0.0000 -> 0.0809
Epoch: 2/30
Train loss:0.1006, Valid loss:0.0988
Val metric mean prob: 0.0273
Best metric at epoch 2: 0.0790 0.0400 0.5419
Cf: [[4450  216]
 [  87   13]]
Date :02/04/2023, 13:41:54
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 54827
Len valid df: 10979
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :30
Epoch: 1/30
Date :02/04/2023, 13:48:26
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 54827
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :30
Epoch: 1/30
Train loss:0.4812, Valid loss:0.2015
Val metric mean prob: 0.1079
Best metric at epoch 1: 0.3169 0.5900 0.6392
Cf: [[4612   54]
 [  71   29]]
Model improve: 0.0000 -> 0.3169
Epoch: 2/30
Train loss:0.3105, Valid loss:0.1201
Val metric mean prob: 0.1817
Best metric at epoch 2: 0.4268 0.5040 0.6719
Cf: [[4637   29]
 [  65   35]]
Model improve: 0.3169 -> 0.4268
Epoch: 3/30
Train loss:0.2011, Valid loss:0.1057
Val metric mean prob: 0.2348
Best metric at epoch 3: 0.4167 0.3310 0.6715
Cf: [[4633   33]
 [  65   35]]
Epoch: 4/30
Train loss:0.1411, Valid loss:0.1349
Val metric mean prob: 0.2087
Best metric at epoch 4: 0.3608 0.4680 0.6687
Cf: [[4607   59]
 [  65   35]]
Epoch: 5/30
Date :02/04/2023, 16:33:09
train transformCompose([
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :30
Epoch: 1/30
Train loss:0.2185, Valid loss:0.1157
Val metric mean prob: 0.0445
Best metric at epoch 1: 0.1092 0.1100 0.6082
Cf: [[4229  437]
 [  69   31]]
Model improve: 0.0000 -> 0.1092
Epoch: 2/30
Train loss:0.1578, Valid loss:0.0896
Val metric mean prob: 0.1051
Best metric at epoch 2: 0.2667 0.2140 0.6140
Cf: [[4610   56]
 [  76   24]]
Model improve: 0.1092 -> 0.2667
Epoch: 3/30
Train loss:0.1376, Valid loss:0.1011
Val metric mean prob: 0.1734
Best metric at epoch 3: 0.3404 0.4570 0.6182
Cf: [[4649   17]
 [  76   24]]
Model improve: 0.2667 -> 0.3404
Epoch: 4/30
Train loss:0.1211, Valid loss:0.0952
Val metric mean prob: 0.1971
Best metric at epoch 4: 0.3562 0.4760 0.6279
Cf: [[4646   20]
 [  74   26]]
Model improve: 0.3404 -> 0.3562
Epoch: 5/30
Train loss:0.1076, Valid loss:0.0860
Val metric mean prob: 0.2307
Best metric at epoch 5: 0.3699 0.4020 0.6330
Cf: [[4647   19]
 [  73   27]]
Model improve: 0.3562 -> 0.3699
Epoch: 6/30
Train loss:0.0957, Valid loss:0.0896
Val metric mean prob: 0.1769
Best metric at epoch 6: 0.3563 0.1610 0.6504
Cf: [[4623   43]
 [  69   31]]
Epoch: 7/30
Train loss:0.0835, Valid loss:0.0925
Val metric mean prob: 0.2250
Best metric at epoch 7: 0.4091 0.3040 0.7170
Cf: [[4591   75]
 [  55   45]]
Model improve: 0.3699 -> 0.4091
Epoch: 8/30
Train loss:0.0684, Valid loss:0.0991
Val metric mean prob: 0.2599
Best metric at epoch 8: 0.3915 0.2480 0.6794
Cf: [[4614   52]
 [  63   37]]
Epoch: 9/30
Train loss:0.0600, Valid loss:0.1141
Val metric mean prob: 0.2209
Best metric at epoch 9: 0.3636 0.1890 0.6462
Cf: [[4631   35]
 [  70   30]]
Epoch: 10/30
Date :02/04/2023, 23:04:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  VerticalFlip(always_apply=False, p=0.5),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :30
Epoch: 1/30
Date :02/04/2023, 23:06:28
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.7, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  VerticalFlip(always_apply=False, p=0.5),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2187, Valid loss:0.1075
Val metric mean prob: 0.0421
Best metric at epoch 1: 0.1095 0.1000 0.5832
Cf: [[4369  297]
 [  77   23]]
Model improve: 0.0000 -> 0.1095
Epoch: 2/13
Train loss:0.1598, Valid loss:0.0907
Val metric mean prob: 0.0825
Best metric at epoch 2: 0.2329 0.1140 0.6321
Cf: [[4546  120]
 [  71   29]]
Model improve: 0.1095 -> 0.2329
Epoch: 3/13
Train loss:0.1426, Valid loss:0.0904
Val metric mean prob: 0.1853
Best metric at epoch 3: 0.3629 0.2180 0.7140
Cf: [[4563  103]
 [  55   45]]
Model improve: 0.2329 -> 0.3629
Epoch: 4/13
Train loss:0.1304, Valid loss:0.0862
Val metric mean prob: 0.2322
Best metric at epoch 4: 0.4286 0.4440 0.6627
Cf: [[4645   21]
 [  67   33]]
Model improve: 0.3629 -> 0.4286
Epoch: 5/13
Train loss:0.1160, Valid loss:0.0816
Val metric mean prob: 0.2200
Best metric at epoch 5: 0.4568 0.2900 0.6823
Cf: [[4641   25]
 [  63   37]]
Model improve: 0.4286 -> 0.4568
Epoch: 6/13
Train loss:0.1066, Valid loss:0.0816
Val metric mean prob: 0.2147
Best metric at epoch 6: 0.4762 0.1520 0.7203
Cf: [[4622   44]
 [  55   45]]
Model improve: 0.4568 -> 0.4762
Epoch: 7/13
Train loss:0.0951, Valid loss:0.0848
Val metric mean prob: 0.1943
Best metric at epoch 7: 0.3936 0.1580 0.7343
Cf: [[4566  100]
 [  51   49]]
Epoch: 8/13
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0810
Val metric mean prob: 0.2766
Best metric at epoch 1: 0.4898 0.2530 0.7349
Cf: [[4618   48]
 [  52   48]]
Model improve: 0.0000 -> 0.4898
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Valid loss:0.0783
Val metric mean prob: 0.2523
Best metric at epoch 1: 0.4914 0.2730 0.7116
Cf: [[4634   32]
 [  57   43]]
Model improve: 0.0000 -> 0.4914
Epoch: 2/13
Date :02/05/2023, 03:19:50
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.2, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  Affine(always_apply=False, p=0.5, interpolation=1, mask_interpolation=0, cval=0, mode=0, scale={'x': (0.8, 1.2), 'y': (0.8, 1.2)}, translate_percent={'x': (0.1, 0.1), 'y': (0.1, 0.1)}, translate_px=None, rotate=(0.0, 0.0), fit_output=False, shear={'x': (20, 20), 'y': (20, 20)}, cval_mask=0, keep_ratio=False),
  HorizontalFlip(always_apply=False, p=0.5),
  RandomBrightness(always_apply=False, p=0.5, limit=(-0.2, 0.2)),
  RandomContrast(always_apply=False, p=0.5, limit=(-0.2, 0.2)),
  Cutout(always_apply=False, p=0.1, num_holes=5, max_h_size=136, max_w_size=168),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Train loss:0.2184, Valid loss:0.1063
Val metric mean prob: 0.0438
Best metric at epoch 1: 0.1018 0.1050 0.5797
Cf: [[4337  329]
 [  77   23]]
Model improve: 0.0000 -> 0.1018
Epoch: 2/13
Train loss:0.1600, Valid loss:0.0884
Val metric mean prob: 0.1085
Best metric at epoch 2: 0.2723 0.1600 0.6230
Cf: [[4601   65]
 [  74   26]]
Model improve: 0.1018 -> 0.2723
Epoch: 3/13
Train loss:0.1432, Valid loss:0.0924
Val metric mean prob: 0.1683
Best metric at epoch 3: 0.3537 0.3740 0.6277
Cf: [[4645   21]
 [  74   26]]
Model improve: 0.2723 -> 0.3537
Epoch: 4/13
Train loss:0.1326, Valid loss:0.0934
Val metric mean prob: 0.1984
Best metric at epoch 4: 0.3733 0.4560 0.6376
Cf: [[4644   22]
 [  72   28]]
Model improve: 0.3537 -> 0.3733
Epoch: 5/13
Date :02/05/2023, 05:37:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=1.0, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Epoch: 1/13
Date :02/05/2023, 05:41:53
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=1.0, clip_limit=(1, 4.0), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 2
Epoch: 1/13
Train loss:0.2450, Valid loss:0.1075
Val metric mean prob: 0.0349
Best metric at epoch 1: 0.0766 0.0620 0.5892
Cf: [[3912  754]
 [  66   34]]
Model improve: 0.0000 -> 0.0766
Epoch: 2/13
Train loss:0.1623, Valid loss:0.0932
Val metric mean prob: 0.0570
Best metric at epoch 2: 0.2037 0.0770 0.6445
Cf: [[4475  191]
 [  67   33]]
Model improve: 0.0766 -> 0.2037
Epoch: 3/13
Train loss:0.1486, Valid loss:0.0995
Val metric mean prob: 0.1362
Best metric at epoch 3: 0.3312 0.3540 0.6267
Cf: [[4635   31]
 [  74   26]]
Model improve: 0.2037 -> 0.3312
Epoch: 4/13
Train loss:0.1364, Valid loss:0.1018
Val metric mean prob: 0.1651
Best metric at epoch 4: 0.3311 0.4710 0.6222
Cf: [[4640   26]
 [  75   25]]
Date :02/05/2023, 08:03:47
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 2
Epoch: 1/13
Train loss:0.2372, Valid loss:0.1201
Val metric mean prob: 0.0406
Best metric at epoch 1: 0.0788 0.1120 0.5537
Cf: [[4327  339]
 [  82   18]]
Model improve: 0.0000 -> 0.0788
Epoch: 2/13
Train loss:0.1595, Valid loss:0.0890
Val metric mean prob: 0.1131
Best metric at epoch 2: 0.2763 0.2610 0.6017
Cf: [[4635   31]
 [  79   21]]
Model improve: 0.0788 -> 0.2763
Epoch: 3/13
Train loss:0.1416, Valid loss:0.1003
Val metric mean prob: 0.1628
Best metric at epoch 3: 0.3605 0.3920 0.6506
Cf: [[4625   41]
 [  69   31]]
Model improve: 0.2763 -> 0.3605
Epoch: 4/13
Train loss:0.1275, Valid loss:0.0843
Val metric mean prob: 0.2010
Best metric at epoch 4: 0.3765 0.3070 0.6559
Cf: [[4628   38]
 [  68   32]]
Model improve: 0.3605 -> 0.3765
Epoch: 5/13
Train loss:0.1163, Valid loss:0.0816
Val metric mean prob: 0.2049
Best metric at epoch 5: 0.4138 0.1890 0.7035
Cf: [[4605   61]
 [  58   42]]
Model improve: 0.3765 -> 0.4138
Epoch: 6/13
Train loss:0.1053, Valid loss:0.0839
Val metric mean prob: 0.2120
Best metric at epoch 6: 0.3976 0.2140 0.6615
Cf: [[4633   33]
 [  67   33]]
Epoch: 7/13
Date :02/05/2023, 11:37:51
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 0
Epoch: 1/15
Train loss:0.1814, Valid loss:0.1110
Val metric mean prob: 0.0490
Best metric at epoch 1: 0.1085 0.1200 0.5890
Cf: [[4330  336]
 [  75   25]]
Model improve: 0.0000 -> 0.1085
Epoch: 2/15
Date :02/05/2023, 12:37:09
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Date :02/05/2023, 12:37:45
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Date :02/05/2023, 12:40:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 0
Epoch: 1/15
Date :02/05/2023, 12:40:51
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 0
Epoch: 1/15
Date :02/05/2023, 12:41:57
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 0
Epoch: 1/15
Date :02/05/2023, 12:43:39
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2267, Valid loss:0.1067
Val metric mean prob: 0.0274
Best metric at epoch 1: 0.0474 0.0430 0.5247
Cf: [[3777  889]
 [  76   24]]
Model improve: 0.0000 -> 0.0474
Epoch: 2/15
Train loss:0.1760, Valid loss:0.0997
Val metric mean prob: 0.0247
Best metric at epoch 2: 0.0886 0.0270 0.5860
Cf: [[4162  504]
 [  72   28]]
Model improve: 0.0474 -> 0.0886
Epoch: 3/15
Date :02/05/2023, 14:35:17
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b7_ns
Len train df: 44652
Len valid df: 10979
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/05/2023, 14:37:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 44652
Len valid df: 10979
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/05/2023, 14:40:28
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b7_ns
Len train df: 44652
Len valid df: 10979
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/05/2023, 14:40:55
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 44652
Len valid df: 10979
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/05/2023, 14:46:50
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 44652
Len valid df: 10979
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/05/2023, 15:32:37
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 20
Len valid df: 500
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.6910, Valid loss:0.7050
Val metric mean prob: 0.0514
Best metric at epoch 1: 0.1053 0.5110 0.5556
Cf: [[204  12]
 [  5   1]]
Model improve: 0.0000 -> 0.1053
Date :02/05/2023, 15:33:38
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 20
Len valid df: 500
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/05/2023, 15:34:43
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-20, 20), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-0.05, 0.05), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ], p=0.1),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=(10.0, 50.0), per_channel=True, mean=0),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
  ], p=0.1),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 20
Len valid df: 500
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.6950, Valid loss:0.7098
Val metric mean prob: 0.0511
Best metric at epoch 1: 0.0606 0.5100 0.5231
Cf: [[190  26]
 [  5   1]]
Model improve: 0.0000 -> 0.0606
Date :02/05/2023, 15:35:45
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-20, 20), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-0.05, 0.05), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ], p=0.1),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=(10.0, 50.0), per_channel=True, mean=0),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
  ], p=0.1),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 44652
Len valid df: 10979
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.1921, Valid loss:0.0988
Val metric mean prob: 0.0552
Best metric at epoch 1: 0.1849 0.1130 0.6173
Cf: [[4501  165]
 [  73   27]]
Model improve: 0.0000 -> 0.1849
Epoch: 2/15
Train loss:0.1563, Valid loss:0.0898
Val metric mean prob: 0.0739
Best metric at epoch 2: 0.2774 0.1340 0.5931
Cf: [[4648   18]
 [  81   19]]
Model improve: 0.1849 -> 0.2774
Epoch: 3/15
Train loss:0.1420, Valid loss:0.0889
Val metric mean prob: 0.1316
Best metric at epoch 3: 0.3290 0.2000 0.6800
Cf: [[4573   93]
 [  62   38]]
Model improve: 0.2774 -> 0.3290
Epoch: 4/15
Train loss:0.1296, Valid loss:0.0923
Val metric mean prob: 0.1445
Best metric at epoch 4: 0.2967 0.3000 0.6291
Cf: [[4611   55]
 [  73   27]]
Epoch: 5/15
Date :02/05/2023, 23:04:13
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-20, 20), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-0.05, 0.05), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ], p=0.1),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=(10.0, 50.0), per_channel=True, mean=0),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
  ], p=0.1),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/05/2023, 23:05:42
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-20, 20), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-0.05, 0.05), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ], p=0.1),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=(10.0, 50.0), per_channel=True, mean=0),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
  ], p=0.1),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2325, Valid loss:0.1082
Val metric mean prob: 0.0298
Best metric at epoch 1: 0.0962 0.0650 0.5403
Cf: [[2284   50]
 [  44    5]]
Model improve: 0.0000 -> 0.0962
Epoch: 2/15
Train loss:0.1762, Valid loss:0.1052
Val metric mean prob: 0.0282
Best metric at epoch 2: 0.0578 0.0370 0.6036
Cf: [[1341  993]
 [  18   31]]
Date :02/06/2023, 00:45:02
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-20, 20), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-0.05, 0.05), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ], p=0.1),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=(10.0, 50.0), per_channel=True, mean=0),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
  ], p=0.1),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 8
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0862
Val metric mean prob: 0.2953
Best metric at epoch 1: 0.4545 0.3010 0.7000
Cf: [[2315   19]
 [  29   20]]
Model improve: 0.0000 -> 0.4545
Date :02/06/2023, 00:50:10
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b7_ns
Len train df: 50278
Len valid df: 5471
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0005
    lr: 0.0
    maximize: False
    weight_decay: 1e-06
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/06/2023, 00:51:03
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b7_ns
Len train df: 50278
Len valid df: 5471
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0005
    lr: 0.0
    maximize: False
    weight_decay: 1e-06
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/06/2023, 00:53:25
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 50278
Len valid df: 5471
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0005
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/06/2023, 00:56:20
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 50278
Len valid df: 5471
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0005
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.1981, Valid loss:0.1205
Val metric mean prob: 0.0290
Best metric at epoch 1: 0.0467 0.0650 0.5341
Cf: [[1588  746]
 [  30   19]]
Model improve: 0.0000 -> 0.0467
Epoch: 2/15
Date :02/06/2023, 03:26:41
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 44652
Len valid df: 10979
Train bs: 4
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 1e-06
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/06/2023, 03:27:35
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 44652
Len valid df: 10979
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 1e-06
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/06/2023, 03:28:28
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b5_ns
Len train df: 44652
Len valid df: 10979
Train bs: 6
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 1e-06
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/06/2023, 03:56:18
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-0.05, 0.05), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ], p=0.1),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=(10.0, 50.0), per_channel=True, mean=0),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
  ], p=0.1),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 53407
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Warmup: 1
Epoch: 1/10
Train loss:0.3796, Valid loss:0.1817
Val metric mean prob: 0.0380
Best metric at epoch 1: 0.0759 0.1560 0.5392
Cf: [[2231  103]
 [  43    6]]
Model improve: 0.0000 -> 0.0759
Epoch: 2/10
Train loss:0.3220, Valid loss:0.1445
Val metric mean prob: 0.0354
Best metric at epoch 2: 0.0706 0.1170 0.5235
Cf: [[2301   33]
 [  46    3]]
Epoch: 3/10
Train loss:0.3200, Valid loss:0.1228
Val metric mean prob: 0.0351
Best metric at epoch 3: 0.1069 0.0960 0.5554
Cf: [[2259   75]
 [  42    7]]
Model improve: 0.0759 -> 0.1069
Epoch: 4/10
Train loss:0.3185, Valid loss:0.1651
Val metric mean prob: 0.0406
Best metric at epoch 4: 0.0769 0.2790 0.5202
Cf: [[2333    1]
 [  47    2]]
Epoch: 5/10
Date :02/06/2023, 07:16:10
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-0.05, 0.05), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ], p=0.1),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=(10.0, 50.0), per_channel=True, mean=0),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
  ], p=0.1),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Warmup: 1
Epoch: 1/10
Date :02/06/2023, 07:16:44
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-0.05, 0.05), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ], p=0.1),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=(10.0, 50.0), per_channel=True, mean=0),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
  ], p=0.1),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b1
Len train df: 50278
Len valid df: 5471
Train bs: 32
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Warmup: 1
Epoch: 1/10
Date :02/06/2023, 07:18:24
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-0.05, 0.05), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ], p=0.1),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=(10.0, 50.0), per_channel=True, mean=0),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5), allow_shifted=True),
  ], p=0.1),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b1
Len train df: 50278
Len valid df: 5471
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Warmup: 1
Epoch: 1/10
Date :02/06/2023, 07:23:07
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b1
Len train df: 50278
Len valid df: 5471
Train bs: 24
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Warmup: 1
Epoch: 1/10
Train loss:0.2423, Valid loss:0.1119
Val metric mean prob: 0.0308
Best metric at epoch 1: 0.0514 0.0540 0.5646
Cf: [[1397  937]
 [  23   26]]
Model improve: 0.0000 -> 0.0514
Epoch: 2/10
Train loss:0.1762, Valid loss:0.1072
Val metric mean prob: 0.0307
Best metric at epoch 2: 0.0554 0.0570 0.5346
Cf: [[2067  267]
 [  40    9]]
Model improve: 0.0514 -> 0.0554
Epoch: 3/10
Date :02/06/2023, 08:39:33
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Warmup: 1
Epoch: 1/10
Date :02/06/2023, 08:41:40
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Warmup: 1
Epoch: 1/10
Date :02/06/2023, 08:42:28
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b1
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Warmup: 1
Epoch: 1/10
Train loss:0.2200, Valid loss:0.1074
Val metric mean prob: 0.0292
Best metric at epoch 1: 0.0533 0.0500 0.5534
Cf: [[1726  608]
 [  31   18]]
Model improve: 0.0000 -> 0.0533
Epoch: 2/10
Train loss:0.1737, Valid loss:0.1093
Val metric mean prob: 0.0301
Best metric at epoch 2: 0.0968 0.0770 0.5464
Cf: [[2265   69]
 [  43    6]]
Model improve: 0.0533 -> 0.0968
Date :02/06/2023, 10:05:50
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b1
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Warmup: 1
Epoch: 1/10
Train loss:0.2290, Valid loss:0.1088
Val metric mean prob: 0.0297
Best metric at epoch 1: 0.0500 0.0490 0.5475
Cf: [[1603  731]
 [  29   20]]
Model improve: 0.0000 -> 0.0500
Epoch: 2/10
Train loss:0.1760, Valid loss:0.1042
Val metric mean prob: 0.0284
Best metric at epoch 2: 0.0923 0.0460 0.5625
Cf: [[2197  137]
 [  40    9]]
Model improve: 0.0500 -> 0.0923
Epoch: 3/10
Train loss:0.1749, Valid loss:0.1086
Val metric mean prob: 0.0293
Best metric at epoch 3: 0.0813 0.0480 0.5774
Cf: [[2076  258]
 [  36   13]]
Epoch: 4/10
Date :02/06/2023, 11:55:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Train loss:0.2565, Valid loss:0.1139
Val metric mean prob: 0.0294
Best metric at epoch 1: 0.0470 0.0570 0.5287
Cf: [[1801  533]
 [  35   14]]
Model improve: 0.0000 -> 0.0470
Epoch: 2/13
Date :02/06/2023, 12:34:17
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 0
Len train df: 50278
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Epoch: 1/15
Date :02/06/2023, 12:36:08
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b1
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Train loss:0.2105, Valid loss:0.1170
Val metric mean prob: 0.0459
Best metric at epoch 1: 0.1667 0.1710 0.5497
Cf: [[2328    6]
 [  44    5]]
Model improve: 0.0000 -> 0.1667
Epoch: 2/13
Train loss:0.1573, Valid loss:0.0802
Val metric mean prob: 0.1555
Best metric at epoch 2: 0.4259 0.1790 0.7270
Cf: [[2298   36]
 [  26   23]]
Model improve: 0.1667 -> 0.4259
Epoch: 3/13
Train loss:0.1408, Valid loss:0.0793
Val metric mean prob: 0.2240
Best metric at epoch 3: 0.5060 0.3280 0.7115
Cf: [[2321   13]
 [  28   21]]
Model improve: 0.4259 -> 0.5060
Epoch: 4/13
Train loss:0.1283, Valid loss:0.0972
Val metric mean prob: 0.2106
Best metric at epoch 4: 0.5060 0.4500 0.7115
Cf: [[2321   13]
 [  28   21]]
Epoch: 5/13
Train loss:0.1192, Valid loss:0.0753
Val metric mean prob: 0.2554
Best metric at epoch 5: 0.4865 0.3900 0.6822
Cf: [[2327    7]
 [  31   18]]
Epoch: 6/13
Date :02/06/2023, 15:29:54
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Date :02/06/2023, 15:30:41
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2035, Valid loss:0.1139
Val metric mean prob: 0.0470
Best metric at epoch 1: 0.1481 0.1210 0.6159
Cf: [[2208  126]
 [  35   14]]
Model improve: 0.0000 -> 0.1481
Epoch: 2/15
Train loss:0.1543, Valid loss:0.0855
Val metric mean prob: 0.1767
Best metric at epoch 2: 0.4742 0.2230 0.7293
Cf: [[2309   25]
 [  26   23]]
Model improve: 0.1481 -> 0.4742
Epoch: 3/15
Train loss:0.1358, Valid loss:0.0730
Val metric mean prob: 0.2581
Best metric at epoch 3: 0.5067 0.3540 0.6924
Cf: [[2327    7]
 [  30   19]]
Model improve: 0.4742 -> 0.5067
Epoch: 4/15
Train loss:0.1235, Valid loss:0.0821
Val metric mean prob: 0.2591
Best metric at epoch 4: 0.5641 0.4090 0.7230
Cf: [[2327    7]
 [  27   22]]
Model improve: 0.5067 -> 0.5641
Epoch: 5/15
Date :02/07/2023, 03:31:30
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 8
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/07/2023, 03:32:13
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 6
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.1970, Valid loss:0.1162
Val metric mean prob: 0.0460
Best metric at epoch 1: 0.1250 0.1190 0.6154
Cf: [[2158  176]
 [  34   15]]
Model improve: 0.0000 -> 0.1250
Epoch: 2/15
Date :02/07/2023, 10:21:13
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/07/2023, 10:21:36
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2034, Valid loss:0.1143
Val metric mean prob: 0.0479
Best metric at epoch 1: 0.1474 0.1240 0.6157
Cf: [[2207  127]
 [  35   14]]
Model improve: 0.0000 -> 0.1474
Epoch: 2/15
Train loss:0.1533, Valid loss:0.0828
Val metric mean prob: 0.1922
Best metric at epoch 2: 0.5116 0.2590 0.7213
Cf: [[2319   15]
 [  27   22]]
Model improve: 0.1474 -> 0.5116
Epoch: 3/15
Train loss:0.1367, Valid loss:0.0787
Val metric mean prob: 0.2660
Best metric at epoch 3: 0.5067 0.4490 0.6924
Cf: [[2327    7]
 [  30   19]]
Epoch: 4/15
Train loss:0.1236, Valid loss:0.0802
Val metric mean prob: 0.2703
Best metric at epoch 4: 0.5778 0.3260 0.7621
Cf: [[2319   15]
 [  23   26]]
Model improve: 0.5116 -> 0.5778
Epoch: 5/15
Train loss:0.1128, Valid loss:0.0975
Val metric mean prob: 0.2801
Best metric at epoch 5: 0.5783 0.5350 0.7428
Cf: [[2324   10]
 [  25   24]]
Model improve: 0.5778 -> 0.5783
Epoch: 6/15
Train loss:0.1021, Valid loss:0.0746
Val metric mean prob: 0.2820
Best metric at epoch 6: 0.5510 0.2060 0.7708
Cf: [[2312   22]
 [  22   27]]
Epoch: 7/15
Train loss:0.0893, Valid loss:0.0736
Val metric mean prob: 0.3538
Best metric at epoch 7: 0.5895 0.2700 0.7819
Cf: [[2316   18]
 [  21   28]]
Model improve: 0.5783 -> 0.5895
Epoch: 8/15
Train loss:0.0801, Valid loss:0.0815
Val metric mean prob: 0.3083
Best metric at epoch 8: 0.4783 0.2800 0.7200
Cf: [[2313   21]
 [  27   22]]
Epoch: 9/15
Train loss:0.0693, Valid loss:0.0861
Val metric mean prob: 0.3417
Best metric at epoch 9: 0.5000 0.1470 0.7591
Cf: [[2305   29]
 [  23   26]]
Epoch: 10/15
Date :02/07/2023, 18:07:09
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2045, Valid loss:0.1126
Val metric mean prob: 0.0474
Best metric at epoch 1: 0.1395 0.1150 0.6427
Cf: [[2142  191]
 [  31   18]]
Model improve: 0.0000 -> 0.1395
Epoch: 2/15
Train loss:0.1503, Valid loss:0.0912
Val metric mean prob: 0.1860
Best metric at epoch 2: 0.4706 0.3700 0.7007
Cf: [[2317   16]
 [  29   20]]
Model improve: 0.1395 -> 0.4706
Epoch: 3/15
Train loss:0.1330, Valid loss:0.0821
Val metric mean prob: 0.2020
Best metric at epoch 3: 0.3953 0.2750 0.6692
Cf: [[2313   20]
 [  32   17]]
Epoch: 4/15
Train loss:0.1191, Valid loss:0.0830
Val metric mean prob: 0.2152
Best metric at epoch 4: 0.4267 0.3250 0.6611
Cf: [[2323   10]
 [  33   16]]
Epoch: 5/15
Train loss:0.1084, Valid loss:0.1017
Val metric mean prob: 0.2414
Best metric at epoch 5: 0.4474 0.5390 0.6713
Cf: [[2323   10]
 [  32   17]]
Epoch: 6/15
Train loss:0.0968, Valid loss:0.0891
Val metric mean prob: 0.2601
Best metric at epoch 6: 0.4500 0.3970 0.6809
Cf: [[2320   13]
 [  31   18]]
Epoch: 7/15
Train loss:0.0843, Valid loss:0.0937
Val metric mean prob: 0.2601
Best metric at epoch 7: 0.4557 0.4260 0.6811
Cf: [[2321   12]
 [  31   18]]
Epoch: 8/15
Train loss:0.0749, Valid loss:0.1017
Val metric mean prob: 0.2223
Best metric at epoch 8: 0.3944 0.5210 0.6411
Cf: [[2325    8]
 [  35   14]]
Date :02/08/2023, 00:38:14
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 2
Model name: tf_efficientnet_b2_ns
Len train df: 50276
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2047, Valid loss:0.1058
Val metric mean prob: 0.0393
Best metric at epoch 1: 0.1284 0.0700 0.6414
Cf: [[2106  227]
 [  31   19]]
Model improve: 0.0000 -> 0.1284
Epoch: 2/15
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0795
Val metric mean prob: 0.3399
Best metric at epoch 1: 0.6078 0.3590 0.8116
Cf: [[2312   22]
 [  18   31]]
Model improve: 0.0000 -> 0.6078
Epoch: 2/15
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0869
Val metric mean prob: 0.3017
Best metric at epoch 1: 0.5833 0.4310 0.7816
Cf: [[2315   19]
 [  21   28]]
Model improve: 0.0000 -> 0.5833
Epoch: 2/15
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0747
Val metric mean prob: 0.3508
Best metric at epoch 1: 0.6263 0.3160 0.8123
Cf: [[2315   19]
 [  18   31]]
Model improve: 0.0000 -> 0.6263
Epoch: 2/15
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0795
Val metric mean prob: 0.3405
Best metric at epoch 1: 0.6304 0.4190 0.7929
Cf: [[2320   14]
 [  20   29]]
Model improve: 0.0000 -> 0.6304
Epoch: 2/15
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0747
Val metric mean prob: 0.3508
Best metric at epoch 1: 0.6263 0.3160 0.8123
Cf: [[2315   19]
 [  18   31]]
Model improve: 0.0000 -> 0.6263
Epoch: 2/15
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0984
Val metric mean prob: 0.2295
Best metric at epoch 1: 0.5106 0.4550 0.7404
Cf: [[2312   21]
 [  25   24]]
Model improve: 0.0000 -> 0.5106
Epoch: 2/15
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0925
Val metric mean prob: 0.2491
Best metric at epoch 1: 0.5000 0.4280 0.7400
Cf: [[2310   23]
 [  25   24]]
Model improve: 0.0000 -> 0.5000
Epoch: 2/15
Date :02/08/2023, 02:09:30
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 51320
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2523, Valid loss:0.1037
Val metric mean prob: 0.0693
Best metric at epoch 1: 0.2338 0.2110 0.5878
Cf: [[2314   19]
 [  40    9]]
Model improve: 0.0000 -> 0.2338
Epoch: 2/15
Train loss:0.1845, Valid loss:0.0876
Val metric mean prob: 0.1695
Best metric at epoch 2: 0.3913 0.2580 0.6783
Cf: [[2308   25]
 [  31   18]]
Model improve: 0.2338 -> 0.3913
Epoch: 3/15
Date :02/08/2023, 04:01:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 2
Model name: tf_efficientnet_b2_ns
Len train df: 50276
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2047, Valid loss:0.1058
Val metric mean prob: 0.0393
Best metric at epoch 1: 0.1284 0.0700 0.6414
Cf: [[2106  227]
 [  31   19]]
Model improve: 0.0000 -> 0.1284
Epoch: 2/15
Train loss:0.1549, Valid loss:0.0837
Val metric mean prob: 0.1663
Best metric at epoch 2: 0.4948 0.1910 0.7351
Cf: [[2310   23]
 [  26   24]]
Model improve: 0.1284 -> 0.4948
Date :02/08/2023, 07:20:26
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 2
Model name: tf_efficientnet_b2_ns
Len train df: 50276
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2047, Valid loss:0.1058
Val metric mean prob: 0.0393
Best metric at epoch 1: 0.1284 0.0700 0.6414
Cf: [[2106  227]
 [  31   19]]
Model improve: 0.0000 -> 0.1284
Epoch: 2/15
Train loss:0.1549, Valid loss:0.0837
Val metric mean prob: 0.1663
Best metric at epoch 2: 0.4948 0.1910 0.7351
Cf: [[2310   23]
 [  26   24]]
Model improve: 0.1284 -> 0.4948
Epoch: 3/15
Train loss:0.1348, Valid loss:0.0895
Val metric mean prob: 0.1880
Best metric at epoch 3: 0.4598 0.2770 0.6964
Cf: [[2316   17]
 [  30   20]]
Epoch: 4/15
Train loss:0.1223, Valid loss:0.0948
Val metric mean prob: 0.2247
Best metric at epoch 4: 0.5234 0.3340 0.7738
Cf: [[2304   29]
 [  22   28]]
Model improve: 0.4948 -> 0.5234
Epoch: 5/15
Train loss:0.1097, Valid loss:0.1105
Val metric mean prob: 0.2256
Best metric at epoch 5: 0.4706 0.4010 0.7712
Cf: [[2292   41]
 [  22   28]]
Epoch: 6/15
Train loss:0.0981, Valid loss:0.0961
Val metric mean prob: 0.2848
Best metric at epoch 6: 0.4828 0.4400 0.7066
Cf: [[2317   16]
 [  29   21]]
Epoch: 7/15
Train loss:0.0881, Valid loss:0.0966
Val metric mean prob: 0.2586
Best metric at epoch 7: 0.5000 0.2340 0.6885
Cf: [[2326    7]
 [  31   19]]
Epoch: 8/15
10 fold
Fold: 2
Model name: tf_efficientnet_b2_ns
Len train df: 50276
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0861
Val metric mean prob: 0.2790
Best metric at epoch 1: 0.5283 0.2700 0.7740
Cf: [[2305   28]
 [  22   28]]
Model improve: 0.0000 -> 0.5283
Epoch: 2/15
10 fold
Fold: 2
Model name: tf_efficientnet_b2_ns
Len train df: 50276
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0846
Val metric mean prob: 0.2579
Best metric at epoch 1: 0.5238 0.4220 0.7174
Cf: [[2321   12]
 [  28   22]]
Model improve: 0.0000 -> 0.5238
Epoch: 2/15
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0795
Val metric mean prob: 0.3405
Best metric at epoch 1: 0.6304 0.4190 0.7929
Cf: [[2320   14]
 [  20   29]]
Model improve: 0.0000 -> 0.6304
Epoch: 2/15
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0747
Val metric mean prob: 0.3508
Best metric at epoch 1: 0.6263 0.3160 0.8123
Cf: [[2315   19]
 [  18   31]]
Model improve: 0.0000 -> 0.6263
Epoch: 2/15
Date :02/08/2023, 13:22:19
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/08/2023, 14:18:16
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2045, Valid loss:0.1126
Val metric mean prob: 0.0474
Best metric at epoch 1: 0.1395 0.1150 0.6427
Cf: [[2142  191]
 [  31   18]]
Model improve: 0.0000 -> 0.1395
Epoch: 2/15
Train loss:0.1503, Valid loss:0.0912
Val metric mean prob: 0.1860
Best metric at epoch 2: 0.4706 0.3700 0.7007
Cf: [[2317   16]
 [  29   20]]
Model improve: 0.1395 -> 0.4706
Epoch: 3/15
Train loss:0.1330, Valid loss:0.0821
Val metric mean prob: 0.2020
Best metric at epoch 3: 0.3953 0.2750 0.6692
Cf: [[2313   20]
 [  32   17]]
Epoch: 4/15
Train loss:0.1191, Valid loss:0.0830
Val metric mean prob: 0.2152
Best metric at epoch 4: 0.4267 0.3250 0.6611
Cf: [[2323   10]
 [  33   16]]
Epoch: 5/15
Train loss:0.1084, Valid loss:0.1017
Val metric mean prob: 0.2414
Best metric at epoch 5: 0.4474 0.5390 0.6713
Cf: [[2323   10]
 [  32   17]]
Epoch: 6/15
Train loss:0.0968, Valid loss:0.0891
Val metric mean prob: 0.2601
Best metric at epoch 6: 0.4500 0.3970 0.6809
Cf: [[2320   13]
 [  31   18]]
Epoch: 7/15
Train loss:0.0843, Valid loss:0.0937
Val metric mean prob: 0.2601
Best metric at epoch 7: 0.4557 0.4260 0.6811
Cf: [[2321   12]
 [  31   18]]
Epoch: 8/15
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/08/2023, 20:37:35
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0984
Val metric mean prob: 0.2295
Best metric at epoch 1: 0.5106 0.4550 0.7404
Cf: [[2312   21]
 [  25   24]]
Model improve: 0.0000 -> 0.5106
Epoch: 2/15
Date :02/08/2023, 20:40:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 44652
Len valid df: 10979
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2064, Valid loss:0.1076
Val metric mean prob: 0.0334
Best metric at epoch 1: 0.0727 0.0660 0.5626
Cf: [[4130  536]
 [  76   24]]
Model improve: 0.0000 -> 0.0727
Epoch: 2/15
Train loss:0.1571, Valid loss:0.1056
Val metric mean prob: 0.1523
Best metric at epoch 2: 0.2949 0.4400 0.6115
Cf: [[4633   33]
 [  77   23]]
Model improve: 0.0727 -> 0.2949
Epoch: 3/15
Train loss:0.1367, Valid loss:0.0847
Val metric mean prob: 0.1868
Best metric at epoch 3: 0.3270 0.2580 0.6265
Cf: [[4633   33]
 [  74   26]]
Model improve: 0.2949 -> 0.3270
Epoch: 4/15
Train loss:0.1249, Valid loss:0.0933
Val metric mean prob: 0.1857
Best metric at epoch 4: 0.3944 0.4360 0.6385
Cf: [[4652   14]
 [  72   28]]
Model improve: 0.3270 -> 0.3944
Epoch: 5/15
Train loss:0.1126, Valid loss:0.0916
Val metric mean prob: 0.2236
Best metric at epoch 5: 0.3981 0.2800 0.7026
Cf: [[4597   69]
 [  58   42]]
Model improve: 0.3944 -> 0.3981
Epoch: 6/15
Train loss:0.1012, Valid loss:0.0889
Val metric mean prob: 0.2418
Best metric at epoch 6: 0.3908 0.2730 0.6657
Cf: [[4626   40]
 [  66   34]]
Epoch: 7/15
Date :02/09/2023, 01:47:17
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/09/2023, 02:03:15
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.1955, Valid loss:0.1498
Val metric mean prob: 0.0393
Best metric at epoch 1: 0.1282 0.1540 0.5459
Cf: [[2310   24]
 [  44    5]]
Model improve: 0.0000 -> 0.1282
Date :02/09/2023, 02:40:10
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.1982, Valid loss:0.1469
Val metric mean prob: 0.0402
Best metric at epoch 1: 0.1270 0.1660 0.5387
Cf: [[2324   10]
 [  45    4]]
Model improve: 0.0000 -> 0.1270
Epoch: 2/15
Train loss:0.1613, Valid loss:0.0877
Val metric mean prob: 0.1551
Best metric at epoch 2: 0.4889 0.2270 0.7204
Cf: [[2315   19]
 [  27   22]]
Model improve: 0.1270 -> 0.4889
Epoch: 3/15
Train loss:0.1405, Valid loss:0.0963
Val metric mean prob: 0.1260
Best metric at epoch 3: 0.5361 0.1930 0.7606
Cf: [[2312   22]
 [  23   26]]
Model improve: 0.4889 -> 0.5361
Epoch: 4/15
Train loss:0.1293, Valid loss:0.0919
Val metric mean prob: 0.1945
Best metric at epoch 4: 0.5747 0.3470 0.7523
Cf: [[2321   13]
 [  24   25]]
Model improve: 0.5361 -> 0.5747
Epoch: 5/15
Train loss:0.1178, Valid loss:0.0964
Val metric mean prob: 0.1875
Best metric at epoch 5: 0.5185 0.4090 0.7119
Cf: [[2323   11]
 [  28   21]]
Epoch: 6/15
Train loss:0.1072, Valid loss:0.0823
Val metric mean prob: 0.2513
Best metric at epoch 6: 0.5750 0.4340 0.7330
Cf: [[2326    8]
 [  26   23]]
Model improve: 0.5747 -> 0.5750
Epoch: 7/15
Train loss:0.0960, Valid loss:0.0838
Val metric mean prob: 0.2389
Best metric at epoch 7: 0.5122 0.3820 0.7117
Cf: [[2322   12]
 [  28   21]]
Epoch: 8/15
Train loss:0.0827, Valid loss:0.0922
Val metric mean prob: 0.2453
Best metric at epoch 8: 0.5618 0.4260 0.7519
Cf: [[2319   15]
 [  24   25]]
Epoch: 9/15
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0964
Val metric mean prob: 0.2064
Best metric at epoch 1: 0.5570 0.4630 0.7228
Cf: [[2326    8]
 [  27   22]]
Model improve: 0.0000 -> 0.5570
Epoch: 2/15
Date :02/09/2023, 07:24:12
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Train loss:0.2086, Valid loss:0.1059
Val metric mean prob: 0.0881
Best metric at epoch 1: 0.3265 0.2540 0.6562
Cf: [[2301   33]
 [  33   16]]
Model improve: 0.0000 -> 0.3265
Epoch: 2/13
Train loss:0.1509, Valid loss:0.0811
Val metric mean prob: 0.1592
Best metric at epoch 2: 0.4330 0.2380 0.7085
Cf: [[2307   27]
 [  28   21]]
Model improve: 0.3265 -> 0.4330
Epoch: 3/13
Train loss:0.1363, Valid loss:0.0762
Val metric mean prob: 0.1851
Best metric at epoch 3: 0.5517 0.1890 0.7419
Cf: [[2320   14]
 [  25   24]]
Model improve: 0.4330 -> 0.5517
Epoch: 4/13
Train loss:0.1234, Valid loss:0.0773
Val metric mean prob: 0.2569
Best metric at epoch 4: 0.5679 0.3830 0.7328
Cf: [[2325    9]
 [  26   23]]
Model improve: 0.5517 -> 0.5679
Epoch: 5/13
Train loss:0.1126, Valid loss:0.0817
Val metric mean prob: 0.2460
Best metric at epoch 5: 0.5455 0.3230 0.7417
Cf: [[2319   15]
 [  25   24]]
Epoch: 6/13
Train loss:0.1038, Valid loss:0.0739
Val metric mean prob: 0.3192
Best metric at epoch 6: 0.5545 0.2530 0.7806
Cf: [[2310   24]
 [  21   28]]
Epoch: 7/13
Train loss:0.0920, Valid loss:0.0768
Val metric mean prob: 0.3139
Best metric at epoch 7: 0.5636 0.1530 0.8099
Cf: [[2304   30]
 [  18   31]]
Epoch: 8/13
Train loss:0.0786, Valid loss:0.0779
Val metric mean prob: 0.3206
Best metric at epoch 8: 0.5581 0.3870 0.7421
Cf: [[2321   13]
 [  25   24]]
Epoch: 9/13
Train loss:0.0691, Valid loss:0.0841
Val metric mean prob: 0.3268
Best metric at epoch 9: 0.5455 0.3580 0.7417
Cf: [[2319   15]
 [  25   24]]
Epoch: 10/13
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Valid loss:0.0708
Val metric mean prob: 0.3169
Best metric at epoch 1: 0.5843 0.3050 0.7623
Cf: [[2320   14]
 [  23   26]]
Model improve: 0.0000 -> 0.5843
Epoch: 2/13
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Valid loss:0.0713
Val metric mean prob: 0.3396
Best metric at epoch 1: 0.6047 0.3850 0.7629
Cf: [[2323   11]
 [  23   26]]
Model improve: 0.0000 -> 0.6047
Epoch: 2/13
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Valid loss:0.0704
Val metric mean prob: 0.3117
Best metric at epoch 1: 0.6024 0.3580 0.7532
Cf: [[2325    9]
 [  24   25]]
Model improve: 0.0000 -> 0.6024
Epoch: 2/13
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Valid loss:0.0715
Val metric mean prob: 0.3394
Best metric at epoch 1: 0.6047 0.3790 0.7629
Cf: [[2323   11]
 [  23   26]]
Model improve: 0.0000 -> 0.6047
Epoch: 2/13
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Valid loss:0.0704
Val metric mean prob: 0.3117
Best metric at epoch 1: 0.6024 0.3580 0.7532
Cf: [[2325    9]
 [  24   25]]
Model improve: 0.0000 -> 0.6024
Epoch: 2/13
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Valid loss:0.0713
Val metric mean prob: 0.3396
Best metric at epoch 1: 0.6047 0.3850 0.7629
Cf: [[2323   11]
 [  23   26]]
Model improve: 0.0000 -> 0.6047
Epoch: 2/13
Date :02/09/2023, 12:31:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :10
Warmup: 1
Epoch: 1/10
Train loss:0.2086, Valid loss:0.1059
Val metric mean prob: 0.0881
Best metric at epoch 1: 0.3265 0.2540 0.6562
Cf: [[2301   33]
 [  33   16]]
Model improve: 0.0000 -> 0.3265
Epoch: 2/10
Train loss:0.1508, Valid loss:0.0791
Val metric mean prob: 0.1691
Best metric at epoch 2: 0.4494 0.2680 0.6998
Cf: [[2314   20]
 [  29   20]]
Model improve: 0.3265 -> 0.4494
Epoch: 3/10
Train loss:0.1362, Valid loss:0.0754
Val metric mean prob: 0.1833
Best metric at epoch 3: 0.5393 0.1830 0.7415
Cf: [[2318   16]
 [  25   24]]
Model improve: 0.4494 -> 0.5393
Epoch: 4/10
Train loss:0.1218, Valid loss:0.0793
Val metric mean prob: 0.2641
Best metric at epoch 4: 0.5641 0.4080 0.7230
Cf: [[2327    7]
 [  27   22]]
Model improve: 0.5393 -> 0.5641
Epoch: 5/10
Train loss:0.1091, Valid loss:0.0804
Val metric mean prob: 0.2731
Best metric at epoch 5: 0.5349 0.3560 0.7317
Cf: [[2320   14]
 [  26   23]]
Epoch: 6/10
Date :02/09/2023, 15:17:04
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Train loss:0.2088, Valid loss:0.1107
Val metric mean prob: 0.0612
Best metric at epoch 1: 0.2308 0.2100 0.5876
Cf: [[2313   20]
 [  40    9]]
Model improve: 0.0000 -> 0.2308
Epoch: 2/13
Train loss:0.1509, Valid loss:0.0919
Val metric mean prob: 0.1363
Best metric at epoch 2: 0.4000 0.3030 0.6694
Cf: [[2314   19]
 [  32   17]]
Model improve: 0.2308 -> 0.4000
Epoch: 3/13
Train loss:0.1353, Valid loss:0.0879
Val metric mean prob: 0.1699
Best metric at epoch 3: 0.4000 0.3420 0.6601
Cf: [[2318   15]
 [  33   16]]
Model improve: 0.4000 -> 0.4000
Epoch: 4/13
Train loss:0.1236, Valid loss:0.0853
Val metric mean prob: 0.1678
Best metric at epoch 4: 0.3956 0.2630 0.6785
Cf: [[2309   24]
 [  31   18]]
Epoch: 5/13
Date :02/09/2023, 18:07:55
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Date :02/09/2023, 18:13:58
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Date :02/09/2023, 18:15:10
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Date :02/09/2023, 18:32:21
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Train loss:0.2129, Valid loss:0.1037
Val metric mean prob: 0.0511
Best metric at epoch 1: 0.2390 0.1040 0.6370
Cf: [[4545  121]
 [  70   30]]
Model improve: 0.0000 -> 0.2390
Epoch: 2/13
Train loss:0.1523, Valid loss:0.0853
Val metric mean prob: 0.1266
Best metric at epoch 2: 0.3490 0.2190 0.6275
Cf: [[4643   23]
 [  74   26]]
Model improve: 0.2390 -> 0.3490
Epoch: 3/13
Train loss:0.1338, Valid loss:0.0996
Val metric mean prob: 0.2261
Best metric at epoch 3: 0.4121 0.3880 0.6988
Cf: [[4608   58]
 [  59   41]]
Model improve: 0.3490 -> 0.4121
Epoch: 4/13
Train loss:0.1211, Valid loss:0.0825
Val metric mean prob: 0.2091
Best metric at epoch 4: 0.4321 0.2360 0.6721
Cf: [[4639   27]
 [  65   35]]
Model improve: 0.4121 -> 0.4321
Epoch: 5/13
Train loss:0.1091, Valid loss:0.0881
Val metric mean prob: 0.1959
Best metric at epoch 5: 0.3846 0.3600 0.6472
Cf: [[4640   26]
 [  70   30]]
Epoch: 6/13
Train loss:0.0973, Valid loss:0.0898
Val metric mean prob: 0.2377
Best metric at epoch 6: 0.4354 0.3830 0.6584
Cf: [[4651   15]
 [  68   32]]
Model improve: 0.4321 -> 0.4354
Epoch: 7/13
Train loss:0.0855, Valid loss:0.0928
Val metric mean prob: 0.2440
Best metric at epoch 7: 0.4216 0.2430 0.7085
Cf: [[4605   61]
 [  57   43]]
Date :02/10/2023, 01:20:02
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/10/2023, 01:20:34
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2060, Valid loss:0.1220
Val metric mean prob: 0.0354
Best metric at epoch 1: 0.0639 0.0680 0.6002
Cf: [[3221 1445]
 [  49   51]]
Model improve: 0.0000 -> 0.0639
Epoch: 2/15
Date :02/10/2023, 03:26:51
Date :02/10/2023, 03:26:51
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
5 fold
Fold: 0
Fold: 0
Model name: tf_efficientnetv2_b2
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len train df: 44652
Len valid df: 10979
Len valid df: 10979
Train bs: 16
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
total_epoch :15
Warmup: 1
Warmup: 1
Epoch: 1/15
Epoch: 1/15
Date :02/10/2023, 03:29:11
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Date :02/10/2023, 03:29:44
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Date :02/10/2023, 03:33:49
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Date :02/10/2023, 03:43:21
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :13
Warmup: 1
Epoch: 1/13
Date :02/10/2023, 03:47:31
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2062, Valid loss:0.1294
Val metric mean prob: 0.0379
Best metric at epoch 1: 0.0770 0.0910 0.5990
Cf: [[3817  849]
 [  62   38]]
Model improve: 0.0000 -> 0.0770
Epoch: 2/15
Train loss:0.1634, Valid loss:0.1599
Val metric mean prob: 0.0934
Best metric at epoch 2: 0.3529 0.4310 0.6457
Cf: [[4626   40]
 [  70   30]]
Model improve: 0.0770 -> 0.3529
Epoch: 3/15
Train loss:0.1441, Valid loss:0.0955
Val metric mean prob: 0.1414
Best metric at epoch 3: 0.3452 0.2670 0.6408
Cf: [[4627   39]
 [  71   29]]
Epoch: 4/15
Train loss:0.1295, Valid loss:0.1379
Val metric mean prob: 0.1668
Best metric at epoch 4: 0.4039 0.4940 0.6984
Cf: [[4604   62]
 [  59   41]]
Model improve: 0.3529 -> 0.4039
Epoch: 5/15
Train loss:0.1199, Valid loss:0.0877
Val metric mean prob: 0.1998
Best metric at epoch 5: 0.4599 0.2810 0.7103
Cf: [[4622   44]
 [  57   43]]
Model improve: 0.4039 -> 0.4599
Epoch: 6/15
Train loss:0.1077, Valid loss:0.0894
Val metric mean prob: 0.2076
Best metric at epoch 6: 0.4239 0.3380 0.6902
Cf: [[4621   45]
 [  61   39]]
Epoch: 7/15
Date :02/10/2023, 09:05:20
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 20
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.8433, Valid loss:0.8504
Val metric mean prob: 0.0514
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 20
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.8433, Valid loss:0.8504
Val metric mean prob: 0.0514
Best metric at epoch 1: 0.0704 0.5680 0.0704 0.6134
Cf: [[ 85 131]
 [  1   5]]
Model improve: 0.0000 -> 0.0704
Epoch: 2/15
Train loss:0.8255, Valid loss:0.8221
Val metric mean prob: 0.0513
Best metric at epoch 2: 0.0800 0.5720 0.0800 0.6250
Cf: [[126  90]
 [  2   4]]
Model improve: 0.0704 -> 0.0800
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 20
Len valid df: 500
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.8433, Valid loss:0.8504
Val metric mean prob: 0.0514
Best metric at epoch 1: 0.5980 0.0667 0.5463
Cf: [[164  52]
 [  4   2]]
Date :02/10/2023, 09:15:54
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2187, Valid loss:0.1136
Val metric mean prob: 0.0460
Best metric at epoch 1: 0.1830 0.0179 0.5038
Cf: [[4655   11]
 [  99    1]]
Model improve: 0.0000 -> 0.0179
Epoch: 2/15
Train loss:0.1560, Valid loss:0.0873
Val metric mean prob: 0.1516
Best metric at epoch 2: 0.5980 0.1593 0.5446
Cf: [[4662    4]
 [  91    9]]
Model improve: 0.0179 -> 0.1593
Epoch: 3/15
Date :02/10/2023, 11:10:09
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/10/2023, 11:10:51
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.1987, Valid loss:0.1507
Val metric mean prob: 0.0398
Best metric at epoch 1: 0.0364 0.2480  0.5091
Cf: [[2328    5]
 [  48    1]]
Model improve: 0.0000 -> 0.0364
Epoch: 2/15
Date :02/10/2023, 12:11:50
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.1963, Valid loss:0.1449
Val metric mean prob: 0.0455
Best metric at epoch 1: 0.1240 0.1910  0.5662
Cf: [[2261   72]
 [  41    8]]
Model improve: 0.0000 -> 0.1240
Epoch: 2/15
Train loss:0.1582, Valid loss:0.1028
Val metric mean prob: 0.1091
Best metric at epoch 2: 0.3564 0.2400  0.6764
Cf: [[2299   34]
 [  31   18]]
Model improve: 0.1240 -> 0.3564
Epoch: 3/15
Train loss:0.1378, Valid loss:0.1006
Val metric mean prob: 0.1428
Best metric at epoch 3: 0.4348 0.3310  0.6992
Cf: [[2310   23]
 [  29   20]]
Model improve: 0.3564 -> 0.4348
Epoch: 4/15
Train loss:0.1271, Valid loss:0.0977
Val metric mean prob: 0.1431
Best metric at epoch 4: 0.4110 0.3680  0.6511
Cf: [[2324    9]
 [  34   15]]
Epoch: 5/15
Train loss:0.1147, Valid loss:0.0812
Val metric mean prob: 0.1801
Best metric at epoch 5: 0.4545 0.2500  0.7000
Cf: [[2314   19]
 [  29   20]]
Model improve: 0.4348 -> 0.4545
Epoch: 6/15
Train loss:0.1041, Valid loss:0.0784
Val metric mean prob: 0.2148
Best metric at epoch 6: 0.4211 0.2850  0.6609
Cf: [[2322   11]
 [  33   16]]
Epoch: 7/15
Train loss:0.0938, Valid loss:0.0821
Val metric mean prob: 0.1794
Best metric at epoch 7: 0.4225 0.2910  0.6516
Cf: [[2326    7]
 [  34   15]]
Epoch: 8/15
Train loss:0.0822, Valid loss:0.0820
Val metric mean prob: 0.2188
Best metric at epoch 8: 0.3947 0.3420  0.6505
Cf: [[2321   12]
 [  34   15]]
Epoch: 9/15
Train loss:0.0718, Valid loss:0.0899
Val metric mean prob: 0.2383
Best metric at epoch 9: 0.3855 0.3310  0.6594
Cf: [[2315   18]
 [  33   16]]
Epoch: 10/15
Train loss:0.0615, Valid loss:0.0863
Val metric mean prob: 0.2449
Best metric at epoch 10: 0.4048 0.3160  0.6696
Cf: [[2315   18]
 [  32   17]]
Epoch: 11/15
Train loss:0.0544, Valid loss:0.0885
Val metric mean prob: 0.2721
Best metric at epoch 11: 0.4186 0.3290  0.6796
Cf: [[2314   19]
 [  31   18]]
Epoch: 12/15
Train loss:0.0473, Valid loss:0.0976
Val metric mean prob: 0.2680
Best metric at epoch 12: 0.4048 0.3300  0.6696
Cf: [[2315   18]
 [  32   17]]
Epoch: 13/15
Train loss:0.0413, Valid loss:0.0939
Val metric mean prob: 0.2683
Best metric at epoch 13: 0.4337 0.3150  0.6802
Cf: [[2317   16]
 [  31   18]]
Epoch: 14/15
Date :02/10/2023, 23:41:30
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/10/2023, 23:47:30
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2149, Valid loss:0.1017
Val metric mean prob: 0.0472
Best metric at epoch 1: 0.1546 0.0930  0.6196
Cf: [[4406  256]
 [  72   30]]
Model improve: 0.0000 -> 0.1546
Epoch: 2/15
Train loss:0.1556, Valid loss:0.0905
Val metric mean prob: 0.1136
Best metric at epoch 2: 0.3536 0.1510  0.6518
Cf: [[4615   47]
 [  70   32]]
Model improve: 0.1546 -> 0.3536
Epoch: 3/15
Train loss:0.1380, Valid loss:0.0895
Val metric mean prob: 0.1927
Best metric at epoch 3: 0.3488 0.3590  0.6428
Cf: [[4622   40]
 [  72   30]]
Epoch: 4/15
Train loss:0.1265, Valid loss:0.0870
Val metric mean prob: 0.1763
Best metric at epoch 4: 0.3592 0.2480  0.6742
Cf: [[4595   67]
 [  65   37]]
Model improve: 0.3536 -> 0.3592
Epoch: 5/15
Date :02/11/2023, 05:02:55
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0007
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/11/2023, 05:42:55
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0007
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2179, Valid loss:0.1003
Val metric mean prob: 0.0438
Best metric at epoch 1: 0.1641 0.1110  0.5702
Cf: [[4585   77]
 [  86   16]]
Model improve: 0.0000 -> 0.1641
Epoch: 2/15
Train loss:0.1566, Valid loss:0.0914
Val metric mean prob: 0.1310
Best metric at epoch 2: 0.3318 0.1660  0.6680
Cf: [[4583   79]
 [  66   36]]
Model improve: 0.1641 -> 0.3318
Epoch: 3/15
Train loss:0.1371, Valid loss:0.0916
Val metric mean prob: 0.1902
Best metric at epoch 3: 0.4233 0.3300  0.6910
Cf: [[4615   47]
 [  62   40]]
Model improve: 0.3318 -> 0.4233
Epoch: 4/15
Train loss:0.1276, Valid loss:0.0798
Val metric mean prob: 0.1810
Best metric at epoch 4: 0.4211 0.1490  0.7269
Cf: [[4584   78]
 [  54   48]]
Epoch: 5/15
Train loss:0.1143, Valid loss:0.0870
Val metric mean prob: 0.2237
Best metric at epoch 5: 0.4509 0.3380  0.6877
Cf: [[4630   32]
 [  63   39]]
Model improve: 0.4233 -> 0.4509
Epoch: 6/15
Train loss:0.1043, Valid loss:0.1011
Val metric mean prob: 0.2396
Best metric at epoch 6: 0.4309 0.4280  0.6869
Cf: [[4622   40]
 [  63   39]]
Epoch: 7/15
Train loss:0.0931, Valid loss:0.0897
Val metric mean prob: 0.2359
Best metric at epoch 7: 0.4348 0.2920  0.7142
Cf: [[4602   60]
 [  57   45]]
Epoch: 8/15
Train loss:0.0830, Valid loss:0.0931
Val metric mean prob: 0.2651
Best metric at epoch 8: 0.4221 0.2290  0.7000
Cf: [[4607   55]
 [  60   42]]
Epoch: 9/15
Date :02/11/2023, 11:41:41
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0007
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2008, Valid loss:0.1536
Val metric mean prob: 0.0397
Best metric at epoch 1: 0.0807 0.1290  0.5791
Cf: [[4074  588]
 [  73   29]]
Model improve: 0.0000 -> 0.0807
Epoch: 2/15
Train loss:0.1613, Valid loss:0.0860
Val metric mean prob: 0.1118
Best metric at epoch 2: 0.3388 0.1000  0.6904
Cf: [[4563   99]
 [  61   41]]
Model improve: 0.0807 -> 0.3388
Epoch: 3/15
Train loss:0.1418, Valid loss:0.1081
Val metric mean prob: 0.1214
Best metric at epoch 3: 0.3938 0.2640  0.6806
Cf: [[4609   53]
 [  64   38]]
Model improve: 0.3388 -> 0.3938
Epoch: 4/15
Train loss:0.1297, Valid loss:0.1026
Val metric mean prob: 0.1489
Best metric at epoch 4: 0.3957 0.3010  0.6762
Cf: [[4614   48]
 [  65   37]]
Model improve: 0.3938 -> 0.3957
Epoch: 5/15
Date :02/11/2023, 13:51:01
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2008, Valid loss:0.1530
Val metric mean prob: 0.0397
Best metric at epoch 1: 0.0801 0.1230  0.5972
Cf: [[3877  785]
 [  65   37]]
Model improve: 0.0000 -> 0.0801
Epoch: 2/15
Train loss:0.1612, Valid loss:0.0864
Val metric mean prob: 0.1074
Best metric at epoch 2: 0.3850 0.1220  0.6712
Cf: [[4613   49]
 [  66   36]]
Model improve: 0.0801 -> 0.3850
Epoch: 3/15
Train loss:0.1419, Valid loss:0.1093
Val metric mean prob: 0.1236
Best metric at epoch 3: 0.4268 0.2960  0.6687
Cf: [[4635   27]
 [  67   35]]
Model improve: 0.3850 -> 0.4268
Epoch: 4/15
Train loss:0.1288, Valid loss:0.0962
Val metric mean prob: 0.1500
Best metric at epoch 4: 0.3953 0.2830  0.6628
Cf: [[4626   36]
 [  68   34]]
Epoch: 5/15
Train loss:0.1168, Valid loss:0.1049
Val metric mean prob: 0.1766
Best metric at epoch 5: 0.4837 0.4550  0.6799
Cf: [[4648   14]
 [  65   37]]
Model improve: 0.4268 -> 0.4837
Epoch: 6/15
Train loss:0.1063, Valid loss:0.1016
Val metric mean prob: 0.1729
Best metric at epoch 6: 0.4636 0.4540  0.6701
Cf: [[4648   14]
 [  67   35]]
Epoch: 7/15
Train loss:0.0963, Valid loss:0.0881
Val metric mean prob: 0.2167
Best metric at epoch 7: 0.4624 0.3290  0.6928
Cf: [[4631   31]
 [  62   40]]
Epoch: 8/15
Train loss:0.0827, Valid loss:0.0862
Val metric mean prob: 0.2517
Best metric at epoch 8: 0.4516 0.2710  0.7014
Cf: [[4620   42]
 [  60   42]]
Epoch: 9/15
Train loss:0.0738, Valid loss:0.0983
Val metric mean prob: 0.2543
Best metric at epoch 9: 0.4295 0.3060  0.6553
Cf: [[4647   15]
 [  70   32]]
Epoch: 10/15
Train loss:0.0617, Valid loss:0.0975
Val metric mean prob: 0.2774
Best metric at epoch 10: 0.4524 0.4130  0.6833
Cf: [[4634   28]
 [  64   38]]
Epoch: 11/15
Train loss:0.0542, Valid loss:0.1113
Val metric mean prob: 0.2909
Best metric at epoch 11: 0.4497 0.3040  0.6832
Cf: [[4633   29]
 [  64   38]]
Epoch: 12/15
Train loss:0.0475, Valid loss:0.1090
Val metric mean prob: 0.2759
Best metric at epoch 12: 0.4352 0.3370  0.7006
Cf: [[4613   49]
 [  60   42]]
Epoch: 13/15
Train loss:0.0413, Valid loss:0.1150
Val metric mean prob: 0.2968
Best metric at epoch 13: 0.4419 0.3180  0.6828
Cf: [[4630   32]
 [  64   38]]
Epoch: 14/15
Train loss:0.0389, Valid loss:0.1184
Val metric mean prob: 0.2989
Best metric at epoch 14: 0.4444 0.3150  0.6829
Cf: [[4631   31]
 [  64   38]]
Epoch: 15/15
Train loss:0.0373, Valid loss:0.1153
Val metric mean prob: 0.2916
Best metric at epoch 15: 0.4598 0.3240  0.6926
Cf: [[4630   32]
 [  62   40]]
Date :02/11/2023, 21:59:15
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/11/2023, 23:38:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/11/2023, 23:39:23
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.1986, Valid loss:0.1732
Val metric mean prob: 0.0405
Best metric at epoch 1: 0.1003 0.1520  0.6147
Cf: [[4103  563]
 [  65   35]]
Model improve: 0.0000 -> 0.1003
Epoch: 2/15
Train loss:0.1668, Valid loss:0.1017
Val metric mean prob: 0.0736
Best metric at epoch 2: 0.2560 0.2310  0.5790
Cf: [[4657    9]
 [  84   16]]
Model improve: 0.1003 -> 0.2560
Epoch: 3/15
Train loss:0.1452, Valid loss:0.1077
Val metric mean prob: 0.1459
Best metric at epoch 3: 0.4025 0.4290  0.6571
Cf: [[4639   27]
 [  68   32]]
Model improve: 0.2560 -> 0.4025
Epoch: 4/15
Train loss:0.1314, Valid loss:0.0912
Val metric mean prob: 0.1320
Best metric at epoch 4: 0.3797 0.2210  0.6470
Cf: [[4638   28]
 [  70   30]]
Epoch: 5/15
Train loss:0.1176, Valid loss:0.0919
Val metric mean prob: 0.1544
Best metric at epoch 5: 0.3784 0.2260  0.7014
Cf: [[4586   80]
 [  58   42]]
Epoch: 6/15
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.1027
Val metric mean prob: 0.1826
Best metric at epoch 1: 0.4910 0.4320  0.6984
Cf: [[4638   24]
 [  61   41]]
Model improve: 0.0000 -> 0.4910
Epoch: 2/15
Date :02/12/2023, 03:09:20
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.1298
Val metric mean prob: 0.0421
Best metric at epoch 1: 0.1173 0.1270  0.5697
Cf: [[4477  189]
 [  82   18]]
Model improve: 0.0000 -> 0.1173
Epoch: 2/15
Valid loss:0.0914
Val metric mean prob: 0.0805
Best metric at epoch 2: 0.2422 0.0980  0.6416
Cf: [[4541  125]
 [  69   31]]
Model improve: 0.1173 -> 0.2422
Epoch: 3/15
Valid loss:0.1035
Val metric mean prob: 0.1816
Best metric at epoch 3: 0.3611 0.5610  0.6281
Cf: [[4648   18]
 [  74   26]]
Model improve: 0.2422 -> 0.3611
Epoch: 4/15
Valid loss:0.0817
Val metric mean prob: 0.1763
Best metric at epoch 4: 0.3926 0.2020  0.6567
Cf: [[4635   31]
 [  68   32]]
Model improve: 0.3611 -> 0.3926
Epoch: 5/15
Date :02/12/2023, 05:28:35
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.1020
Val metric mean prob: 0.0578
Best metric at epoch 1: 0.1543 0.1290  0.6000
Cf: [[4479  187]
 [  76   24]]
Model improve: 0.0000 -> 0.1543
Epoch: 2/15
Valid loss:0.0898
Val metric mean prob: 0.1126
Best metric at epoch 2: 0.3152 0.1870  0.6258
Cf: [[4627   39]
 [  74   26]]
Model improve: 0.1543 -> 0.3152
Epoch: 3/15
Valid loss:0.0912
Val metric mean prob: 0.1492
Best metric at epoch 3: 0.3158 0.3070  0.6170
Cf: [[4638   28]
 [  76   24]]
Model improve: 0.3152 -> 0.3158
Epoch: 4/15
Valid loss:0.0872
Val metric mean prob: 0.1656
Best metric at epoch 4: 0.3546 0.3400  0.6233
Cf: [[4650   16]
 [  75   25]]
Model improve: 0.3158 -> 0.3546
Epoch: 5/15
Date :02/12/2023, 07:42:44
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.1474
Val metric mean prob: 0.0408
Best metric at epoch 1: 0.0753 0.1730  0.5356
Cf: [[4485  181]
 [  89   11]]
Model improve: 0.0000 -> 0.0753
Epoch: 2/15
Valid loss:0.1493
Val metric mean prob: 0.0723
Best metric at epoch 2: 0.2994 0.3020  0.6205
Cf: [[4624   42]
 [  75   25]]
Model improve: 0.0753 -> 0.2994
Epoch: 3/15
Valid loss:0.0988
Val metric mean prob: 0.1238
Best metric at epoch 3: 0.3776 0.2970  0.6333
Cf: [[4650   16]
 [  73   27]]
Model improve: 0.2994 -> 0.3776
Epoch: 4/15
Valid loss:0.1261
Val metric mean prob: 0.1623
Best metric at epoch 4: 0.3780 0.5220  0.6515
Cf: [[4633   33]
 [  69   31]]
Model improve: 0.3776 -> 0.3780
Epoch: 5/15
Valid loss:0.0869
Val metric mean prob: 0.1675
Best metric at epoch 5: 0.4130 0.1440  0.7447
Cf: [[4570   96]
 [  49   51]]
Model improve: 0.3780 -> 0.4130
Epoch: 6/15
Valid loss:0.0884
Val metric mean prob: 0.1794
Best metric at epoch 6: 0.4216 0.2680  0.6901
Cf: [[4620   46]
 [  61   39]]
Model improve: 0.4130 -> 0.4216
Epoch: 7/15
Valid loss:0.0921
Val metric mean prob: 0.1912
Best metric at epoch 7: 0.3721 0.3150  0.6557
Cf: [[4626   40]
 [  68   32]]
Date :02/12/2023, 12:30:35
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/12/2023, 12:32:45
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2017, Valid loss:0.1533
Val metric mean prob: 0.0398
Best metric at epoch 1: 0.0959 0.1390  0.5682
Cf: [[4369  297]
 [  80   20]]
Model improve: 0.0000 -> 0.0959
Epoch: 2/15
Train loss:0.1627, Valid loss:0.1049
Val metric mean prob: 0.1073
Best metric at epoch 2: 0.3026 0.2760  0.6119
Cf: [[4637   29]
 [  77   23]]
Model improve: 0.0959 -> 0.3026
Epoch: 3/15
Train loss:0.1422, Valid loss:0.1041
Val metric mean prob: 0.1796
Best metric at epoch 3: 0.4393 0.4400  0.6862
Cf: [[4631   35]
 [  62   38]]
Model improve: 0.3026 -> 0.4393
Epoch: 4/15
Train loss:0.1282, Valid loss:0.0876
Val metric mean prob: 0.1590
Best metric at epoch 4: 0.3886 0.2030  0.6975
Cf: [[4596   70]
 [  59   41]]
Epoch: 5/15
Date :02/12/2023, 22:36:34
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2017, Valid loss:0.1533
Val metric mean prob: 0.0398
Best metric at epoch 1: 0.0959 0.1390  0.5682
Cf: [[4369  297]
 [  80   20]]
Model improve: 0.0000 -> 0.0959
Epoch: 2/15
Train loss:0.1627, Valid loss:0.1049
Val metric mean prob: 0.1073
Best metric at epoch 2: 0.3026 0.2760  0.6119
Cf: [[4637   29]
 [  77   23]]
Model improve: 0.0959 -> 0.3026
Epoch: 3/15
Train loss:0.1422, Valid loss:0.1041
Val metric mean prob: 0.1796
Best metric at epoch 3: 0.4393 0.4400  0.6862
Cf: [[4631   35]
 [  62   38]]
Model improve: 0.3026 -> 0.4393
Epoch: 4/15
Train loss:0.1282, Valid loss:0.0876
Val metric mean prob: 0.1590
Best metric at epoch 4: 0.3886 0.2030  0.6975
Cf: [[4596   70]
 [  59   41]]
Epoch: 5/15
Train loss:0.1161, Valid loss:0.1018
Val metric mean prob: 0.1670
Best metric at epoch 5: 0.3871 0.4230  0.6473
Cf: [[4641   25]
 [  70   30]]
Epoch: 6/15
Train loss:0.1041, Valid loss:0.0881
Val metric mean prob: 0.1989
Best metric at epoch 6: 0.4044 0.2880  0.6801
Cf: [[4620   46]
 [  63   37]]
Epoch: 7/15
Train loss:0.0942, Valid loss:0.0868
Val metric mean prob: 0.2017
Best metric at epoch 7: 0.4205 0.2670  0.6808
Cf: [[4627   39]
 [  63   37]]
Epoch: 8/15
Train loss:0.0815, Valid loss:0.0943
Val metric mean prob: 0.2270
Best metric at epoch 8: 0.4756 0.4000  0.6923
Cf: [[4641   25]
 [  61   39]]
Model improve: 0.4393 -> 0.4756
Epoch: 9/15
Train loss:0.0699, Valid loss:0.0976
Val metric mean prob: 0.2375
Best metric at epoch 9: 0.4490 0.4790  0.6635
Cf: [[4652   14]
 [  67   33]]
Epoch: 10/15
Train loss:0.0604, Valid loss:0.1025
Val metric mean prob: 0.2339
Best metric at epoch 10: 0.3974 0.3880  0.6523
Cf: [[4641   25]
 [  69   31]]
Epoch: 11/15
Train loss:0.0504, Valid loss:0.1120
Val metric mean prob: 0.2633
Best metric at epoch 11: 0.4302 0.3200  0.6812
Cf: [[4631   35]
 [  63   37]]
Epoch: 12/15
Train loss:0.0462, Valid loss:0.1117
Val metric mean prob: 0.2455
Best metric at epoch 12: 0.4064 0.3090  0.6847
Cf: [[4617   49]
 [  62   38]]
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0948
Val metric mean prob: 0.2377
Best metric at epoch 1: 0.4643 0.4120  0.6919
Cf: [[4637   29]
 [  61   39]]
Model improve: 0.0000 -> 0.4643
Date :02/13/2023, 05:22:31
Date :02/13/2023, 05:22:31
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
10 fold
Fold: 0
Fold: 0
Model name: tf_efficientnetv2_b2
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len train df: 50278
Len valid df: 5471
Len valid df: 5471
Train bs: 16
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
total_epoch :15
Warmup: 1
Warmup: 1
Epoch: 1/15
Epoch: 1/15
Date :02/13/2023, 05:22:46
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.1982, Valid loss:0.1469
Val metric mean prob: 0.0402
Best metric at epoch 1: 0.1270 0.1660  0.5387
Cf: [[2324   10]
 [  45    4]]
Model improve: 0.0000 -> 0.1270
Epoch: 2/15
Train loss:0.1613, Valid loss:0.0877
Val metric mean prob: 0.1551
Best metric at epoch 2: 0.4889 0.2270  0.7204
Cf: [[2315   19]
 [  27   22]]
Model improve: 0.1270 -> 0.4889
Epoch: 3/15
Train loss:0.1405, Valid loss:0.0963
Val metric mean prob: 0.1260
Best metric at epoch 3: 0.5361 0.1930  0.7606
Cf: [[2312   22]
 [  23   26]]
Model improve: 0.4889 -> 0.5361
Epoch: 4/15
Date :02/13/2023, 07:23:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 0
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5471
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2022, Valid loss:0.0990
Val metric mean prob: 0.0447
Best metric at epoch 1: 0.2000 0.1250  0.5684
Cf: [[2320   14]
 [  42    7]]
Model improve: 0.0000 -> 0.2000
Epoch: 2/15
Train loss:0.1647, Valid loss:0.1223
Val metric mean prob: 0.1307
Best metric at epoch 2: 0.4337 0.3770  0.6802
Cf: [[2318   16]
 [  31   18]]
Model improve: 0.2000 -> 0.4337
Epoch: 3/15
Train loss:0.1447, Valid loss:0.1024
Val metric mean prob: 0.1666
Best metric at epoch 3: 0.5227 0.3170  0.7313
Cf: [[2318   16]
 [  26   23]]
Model improve: 0.4337 -> 0.5227
Epoch: 4/15
Train loss:0.1299, Valid loss:0.0994
Val metric mean prob: 0.1915
Best metric at epoch 4: 0.5135 0.4860  0.6926
Cf: [[2328    6]
 [  30   19]]
Epoch: 5/15
Train loss:0.1179, Valid loss:0.0831
Val metric mean prob: 0.2464
Best metric at epoch 5: 0.5545 0.2600  0.7806
Cf: [[2310   24]
 [  21   28]]
Model improve: 0.5227 -> 0.5545
Epoch: 6/15
Train loss:0.1059, Valid loss:0.1011
Val metric mean prob: 0.1968
Best metric at epoch 6: 0.5455 0.4590  0.7128
Cf: [[2327    7]
 [  28   21]]
Epoch: 7/15
Date :02/13/2023, 12:40:12
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/13/2023, 12:46:13
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2045, Valid loss:0.1126
Val metric mean prob: 0.0474
Best metric at epoch 1: 0.1395 0.1150  0.6427
Cf: [[2142  191]
 [  31   18]]
Model improve: 0.0000 -> 0.1395
Epoch: 2/15
Train loss:0.1503, Valid loss:0.0912
Val metric mean prob: 0.1860
Best metric at epoch 2: 0.4706 0.3700  0.7007
Cf: [[2317   16]
 [  29   20]]
Model improve: 0.1395 -> 0.4706
Epoch: 3/15
Train loss:0.1330, Valid loss:0.0821
Val metric mean prob: 0.2020
Best metric at epoch 3: 0.3953 0.2750  0.6692
Cf: [[2313   20]
 [  32   17]]
Epoch: 4/15
Train loss:0.1191, Valid loss:0.0830
Val metric mean prob: 0.2152
Best metric at epoch 4: 0.4267 0.3250  0.6611
Cf: [[2323   10]
 [  33   16]]
Epoch: 5/15
Train loss:0.1084, Valid loss:0.1017
Val metric mean prob: 0.2414
Best metric at epoch 5: 0.4474 0.5390  0.6713
Cf: [[2323   10]
 [  32   17]]
Epoch: 6/15
Date :02/13/2023, 22:36:39
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/13/2023, 22:39:58
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/13/2023, 22:54:31
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
ModelOneChannelAvgPool
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/13/2023, 22:57:09
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
10 fold
Fold: 1
Model name: tf_efficientnet_b2_ns
Len train df: 50278
Len valid df: 5470
Train bs: 12
ModelOneChannelAvgPool
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/13/2023, 23:22:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 44603
Len valid df: 11012
Train bs: 20
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
Date :02/13/2023, 23:23:26
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 44603
Len valid df: 11012
Train bs: 20
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
Date :02/13/2023, 23:27:41
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 44603
Len valid df: 11012
Train bs: 20
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
Date :02/14/2023, 00:08:23
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 1
Len train df: 44750
Train bs: 16
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :20
Epoch: 1/20
Date :02/14/2023, 00:09:29
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 20
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
Train loss:0.2215, Valid loss:0.1009
Val metric mean prob: 0.0433
Best metric at epoch 1: 0.1274 0.0780  0.5874
Cf: [[4426  236]
 [  79   23]]
Model improve: 0.0000 -> 0.1274
Epoch: 2/30
Date :02/14/2023, 02:18:00
Date :02/14/2023, 02:18:00
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
5 fold
Fold: 1
Fold: 1
Model name: tf_efficientnetv2_b2
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len train df: 44750
Len valid df: 10879
Len valid df: 10879
Train bs: 20
Train bs: 20
ModelOld
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
total_epoch :30
Warmup: 1
Warmup: 1
Epoch: 1/30
Epoch: 1/30
Date :02/14/2023, 02:18:28
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 20
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
Date :02/14/2023, 02:19:27
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 20
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
Date :02/14/2023, 02:29:59
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 20
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
Date :02/14/2023, 02:36:11
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b0
Len train df: 44750
Len valid df: 10879
Train bs: 24
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
Date :02/14/2023, 02:52:14
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
Train loss:0.2179, Valid loss:0.1000
Val metric mean prob: 0.0425
Best metric at epoch 1: 0.1432 0.0690  0.6058
Cf: [[4414  248]
 [  75   27]]
Model improve: 0.0000 -> 0.1432
Epoch: 2/30
Train loss:0.1582, Valid loss:0.0892
Val metric mean prob: 0.1021
Best metric at epoch 2: 0.3398 0.0980  0.6642
Cf: [[4593   69]
 [  67   35]]
Model improve: 0.1432 -> 0.3398
Epoch: 3/30
Train loss:0.1390, Valid loss:0.0889
Val metric mean prob: 0.1924
Best metric at epoch 3: 0.4046 0.3190  0.6677
Cf: [[4626   36]
 [  67   35]]
Model improve: 0.3398 -> 0.4046
Epoch: 4/30
Train loss:0.1294, Valid loss:0.0792
Val metric mean prob: 0.1869
Best metric at epoch 4: 0.4693 0.2230  0.7021
Cf: [[4627   35]
 [  60   42]]
Model improve: 0.4046 -> 0.4693
Epoch: 5/30
Train loss:0.1175, Valid loss:0.0888
Val metric mean prob: 0.2016
Best metric at epoch 5: 0.4239 0.2880  0.6866
Cf: [[4619   43]
 [  63   39]]
Epoch: 6/30
Train loss:0.1079, Valid loss:0.0889
Val metric mean prob: 0.2314
Best metric at epoch 6: 0.4044 0.3350  0.6767
Cf: [[4618   44]
 [  65   37]]
Epoch: 7/30
Date :02/14/2023, 10:34:58
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
Date :02/14/2023, 10:51:49
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :30
Warmup: 1
Epoch: 1/30
Valid loss:0.0898
Val metric mean prob: 0.2521
Best metric at epoch 1: 0.4578 0.3820  0.6835
Cf: [[4636   26]
 [  64   38]]
Model improve: 0.0000 -> 0.4578
Epoch: 2/30
Valid loss:0.0898
Val metric mean prob: 0.2521
Best metric at epoch 2: 0.4578 0.3820  0.6835
Cf: [[4636   26]
 [  64   38]]
Epoch: 3/30
Valid loss:0.0898
Val metric mean prob: 0.2521
Best metric at epoch 3: 0.4578 0.3820  0.6835
Cf: [[4636   26]
 [  64   38]]
Epoch: 4/30
Valid loss:0.0898
Val metric mean prob: 0.2521
Best metric at epoch 4: 0.4578 0.3820  0.6835
Cf: [[4636   26]
 [  64   38]]
Epoch: 5/30
Valid loss:0.0898
Val metric mean prob: 0.2521
Best metric at epoch 5: 0.4578 0.3820  0.6835
Cf: [[4636   26]
 [  64   38]]
Epoch: 6/30
Valid loss:0.0898
Val metric mean prob: 0.2521
Best metric at epoch 6: 0.4578 0.3820  0.6835
Cf: [[4636   26]
 [  64   38]]
Epoch: 7/30
Valid loss:0.0898
Val metric mean prob: 0.2521
Best metric at epoch 7: 0.4578 0.3820  0.6835
Cf: [[4636   26]
 [  64   38]]
Epoch: 8/30
Date :02/14/2023, 12:05:19
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Date :02/14/2023, 12:23:18
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Date :02/14/2023, 13:01:51
Date :02/14/2023, 13:01:51
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
5 fold
Fold: 0
Fold: 0
Model name: tf_efficientnetv2_b2
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len train df: 50278
Len valid df: 5471
Len valid df: 5471
Valid loss:0.0934
Valid loss:0.0934
Val metric mean prob: 0.3450
Val metric mean prob: 0.3450
Best metric at: 0.5714 0.4650  0.7232
Best metric at: 0.5714 0.4650  0.7232
Cf: [[2328    6]
 [  27   22]]
Cf: [[2328    6]
 [  27   22]]
Valid loss:0.0934
Valid loss:0.0934
Val metric mean prob: 0.3450
Val metric mean prob: 0.3450
Valid loss:0.0934
Valid loss:0.0934
Val metric mean prob: 0.3450
Val metric mean prob: 0.3450
Best metric at: 0.5714 0.4650
Best metric at: 0.5714 0.4650
Cf: [[2328    6]
 [  27   22]]
Cf: [[2328    6]
 [  27   22]]
Valid loss:0.0934
Valid loss:0.0934
Val metric mean prob: 0.3479
Val metric mean prob: 0.3479
Best metric at: 0.5714 0.4800
Best metric at: 0.5714 0.4800
Cf: [[2328    6]
 [  27   22]]
Cf: [[2328    6]
 [  27   22]]
Valid loss:0.0937
Valid loss:0.0937
Val metric mean prob: 0.3397
Val metric mean prob: 0.3397
Best metric at: 0.5610 0.4410
Best metric at: 0.5610 0.4410
Cf: [[2324   10]
 [  26   23]]
Cf: [[2324   10]
 [  26   23]]
Valid loss:0.0935
Valid loss:0.0935
Val metric mean prob: 0.3436
Val metric mean prob: 0.3436
Best metric at: 0.5714 0.4600
Best metric at: 0.5714 0.4600
Cf: [[2328    6]
 [  27   22]]
Cf: [[2328    6]
 [  27   22]]
Valid loss:0.0780
Valid loss:0.0780
Val metric mean prob: 0.2692
Val metric mean prob: 0.2692
Best metric at: 0.5747 0.3630
Best metric at: 0.5747 0.3630
Cf: [[2321   13]
 [  24   25]]
Cf: [[2321   13]
 [  24   25]]
Valid loss:0.0945
Valid loss:0.0945
Val metric mean prob: 0.2632
Val metric mean prob: 0.2632
Best metric at: 0.5349 0.4810
Best metric at: 0.5349 0.4810
Cf: [[2320   14]
 [  26   23]]
Cf: [[2320   14]
 [  26   23]]
Valid loss:0.0756
Valid loss:0.0756
Val metric mean prob: 0.2553
Val metric mean prob: 0.2553
Best metric at: 0.5714 0.2880
Best metric at: 0.5714 0.2880
Cf: [[2318   16]
 [  23   26]]
Cf: [[2318   16]
 [  23   26]]
Valid loss:0.0795
Valid loss:0.0795
Val metric mean prob: 0.3191
Val metric mean prob: 0.3191
Best metric at: 0.5495 0.4040
Best metric at: 0.5495 0.4040
Cf: [[2317   17]
 [  24   25]]
Cf: [[2317   17]
 [  24   25]]
Valid loss:0.0854
Valid loss:0.0854
Val metric mean prob: 0.1312
Val metric mean prob: 0.1312
Best metric at: 0.5400 0.1500
Best metric at: 0.5400 0.1500
Cf: [[2310   24]
 [  22   27]]
Cf: [[2310   24]
 [  22   27]]
Valid loss:0.0777
Valid loss:0.0777
Val metric mean prob: 0.3030
Val metric mean prob: 0.3030
Best metric at: 0.5542 0.4340
Best metric at: 0.5542 0.4340
Cf: [[2323   11]
 [  26   23]]
Cf: [[2323   11]
 [  26   23]]
Valid loss:0.0791
Valid loss:0.0791
Val metric mean prob: 0.3154
Val metric mean prob: 0.3154
Best metric at: 0.5412 0.4430
Best metric at: 0.5412 0.4430
Cf: [[2321   13]
 [  26   23]]
Cf: [[2321   13]
 [  26   23]]
Date :02/14/2023, 15:47:20
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 50276
Len valid df: 5471
Date :02/14/2023, 16:03:19
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/14/2023, 16:26:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2153, Valid loss:0.1128
Val metric mean prob: 0.0469
Best metric at epoch 1: 0.2308 0.1460  0.5876
Cf: [[2313   20]
 [  40    9]]
Model improve: 0.0000 -> 0.2308
Epoch: 2/15
Train loss:0.1551, Valid loss:0.0917
Val metric mean prob: 0.1040
Best metric at epoch 2: 0.3243 0.2140  0.6197
Cf: [[2320   13]
 [  37   12]]
Model improve: 0.2308 -> 0.3243
Epoch: 3/15
Train loss:0.1368, Valid loss:0.0969
Val metric mean prob: 0.1871
Best metric at epoch 3: 0.5055 0.3600  0.7306
Cf: [[2314   19]
 [  26   23]]
Model improve: 0.3243 -> 0.5055
Epoch: 4/15
Train loss:0.1242, Valid loss:0.0866
Val metric mean prob: 0.1720
Best metric at epoch 4: 0.4110 0.3340  0.6511
Cf: [[2324    9]
 [  34   15]]
Epoch: 5/15
Train loss:0.1143, Valid loss:0.0779
Val metric mean prob: 0.2275
Best metric at epoch 5: 0.4865 0.3240  0.6822
Cf: [[2326    7]
 [  31   18]]
Epoch: 6/15
Train loss:0.1029, Valid loss:0.0904
Val metric mean prob: 0.2248
Best metric at epoch 6: 0.4176 0.3440  0.6889
Cf: [[2310   23]
 [  30   19]]
Epoch: 7/15
Train loss:0.0932, Valid loss:0.1020
Val metric mean prob: 0.2228
Best metric at epoch 7: 0.4186 0.4460  0.6796
Cf: [[2314   19]
 [  31   18]]
Epoch: 8/15
Train loss:0.0808, Valid loss:0.0894
Val metric mean prob: 0.2436
Best metric at epoch 8: 0.4255 0.2280  0.6987
Cf: [[2308   25]
 [  29   20]]
Epoch: 9/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Valid loss:0.0767
Val metric mean prob: 0.2882
Best metric at: 0.5591 0.3410  0.7615
Cf: [[2316   18]
 [  23   26]]
Valid loss:0.0756
Val metric mean prob: 0.2541
Best metric at: 0.5714 0.2860  0.7619
Cf: [[2318   16]
 [  23   26]]
Valid loss:0.0770
Val metric mean prob: 0.2932
Best metric at: 0.5476 0.4070  0.7321
Cf: [[2322   12]
 [  26   23]]
Valid loss:0.0764
Val metric mean prob: 0.2822
Best metric at: 0.5714 0.3340  0.7619
Cf: [[2318   16]
 [  23   26]]
Date :02/15/2023, 03:13:58
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Valid loss:0.0767
Val metric mean prob: 0.2882
Best metric at: 0.5591 0.3410  0.7615
Cf: [[2316   18]
 [  23   26]]
Valid loss:0.0756
Val metric mean prob: 0.2541
Best metric at: 0.5714 0.2860  0.7619
Cf: [[2318   16]
 [  23   26]]
Valid loss:0.0770
Val metric mean prob: 0.2932
Best metric at: 0.5476 0.4070  0.7321
Cf: [[2322   12]
 [  26   23]]
Valid loss:0.0764
Val metric mean prob: 0.2822
Best metric at: 0.5714 0.3340  0.7619
Cf: [[2318   16]
 [  23   26]]
Date :02/15/2023, 03:37:03
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0803
Val metric mean prob: 0.2334
Best metric at epoch 1: 0.5067 0.3870  0.6924
Cf: [[2326    7]
 [  30   19]]
Model improve: 0.0000 -> 0.5067
Epoch: 2/15
Date :02/15/2023, 03:46:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2165, Valid loss:0.1024
Val metric mean prob: 0.0471
Best metric at epoch 1: 0.2051 0.1160  0.5771
Cf: [[2313   21]
 [  41    8]]
Model improve: 0.0000 -> 0.2051
Epoch: 2/15
Train loss:0.1559, Valid loss:0.0869
Val metric mean prob: 0.1385
Best metric at epoch 2: 0.4835 0.2210  0.7202
Cf: [[2314   20]
 [  27   22]]
Model improve: 0.2051 -> 0.4835
Epoch: 3/15
Train loss:0.1392, Valid loss:0.0937
Val metric mean prob: 0.1885
Best metric at epoch 3: 0.5306 0.3210  0.7604
Cf: [[2311   23]
 [  23   26]]
Model improve: 0.4835 -> 0.5306
Epoch: 4/15
Train loss:0.1266, Valid loss:0.0735
Val metric mean prob: 0.2644
Best metric at epoch 4: 0.5435 0.2890  0.7512
Cf: [[2316   18]
 [  24   25]]
Model improve: 0.5306 -> 0.5435
Epoch: 5/15
Train loss:0.1176, Valid loss:0.0684
Val metric mean prob: 0.2736
Best metric at epoch 5: 0.5825 0.1370  0.8010
Cf: [[2310   24]
 [  19   30]]
Model improve: 0.5435 -> 0.5825
Epoch: 6/15
Train loss:0.1061, Valid loss:0.0710
Val metric mean prob: 0.2776
Best metric at epoch 6: 0.5316 0.1860  0.7124
Cf: [[2325    9]
 [  28   21]]
Epoch: 7/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/15/2023, 14:11:52
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/15/2023, 14:27:58
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 5000
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/15/2023, 14:29:40
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 5000
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 5000
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/15/2023, 14:40:18
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 5000
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 5000
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 5000
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/15/2023, 14:58:56
train transform Compose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transform Compose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Date :02/15/2023, 15:02:34
train transform Compose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/15/2023, 15:22:58
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 5000
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/15/2023, 15:23:55
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 5000
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/15/2023, 15:24:54
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2106, Valid loss:0.1054
Val metric mean prob: 0.0397
Best metric at epoch 1: 0.1212 0.0850  0.5822
Cf: [[4423  239]
 [  80   22]]
Model improve: 0.0000 -> 0.1212
Epoch: 2/15
Train loss:0.1588, Valid loss:0.0882
Val metric mean prob: 0.1153
Best metric at epoch 2: 0.3394 0.1490  0.6335
Cf: [[4627   35]
 [  74   28]]
Model improve: 0.1212 -> 0.3394
Epoch: 3/15
Train loss:0.1402, Valid loss:0.0918
Val metric mean prob: 0.1818
Best metric at epoch 3: 0.3879 0.3690  0.6535
Cf: [[4631   31]
 [  70   32]]
Model improve: 0.3394 -> 0.3879
Epoch: 4/15
Train loss:0.1278, Valid loss:0.0804
Val metric mean prob: 0.1842
Best metric at epoch 4: 0.4259 0.1520  0.7182
Cf: [[4594   68]
 [  56   46]]
Model improve: 0.3879 -> 0.4259
Epoch: 5/15
Train loss:0.1162, Valid loss:0.0834
Val metric mean prob: 0.2175
Best metric at epoch 5: 0.4271 0.2290  0.6957
Cf: [[4613   49]
 [  61   41]]
Model improve: 0.4259 -> 0.4271
Epoch: 6/15
Train loss:0.1054, Valid loss:0.0861
Val metric mean prob: 0.2264
Best metric at epoch 6: 0.4332 0.2410  0.7231
Cf: [[4594   68]
 [  55   47]]
Model improve: 0.4271 -> 0.4332
Epoch: 7/15
Train loss:0.0947, Valid loss:0.0935
Val metric mean prob: 0.2428
Best metric at epoch 7: 0.4387 0.4680  0.6646
Cf: [[4643   19]
 [  68   34]]
Model improve: 0.4332 -> 0.4387
Epoch: 8/15
Train loss:0.0865, Valid loss:0.0893
Val metric mean prob: 0.2758
Best metric at epoch 8: 0.4625 0.3670  0.6791
Cf: [[4641   21]
 [  65   37]]
Model improve: 0.4387 -> 0.4625
Epoch: 9/15
Train loss:0.0756, Valid loss:0.1021
Val metric mean prob: 0.2772
Best metric at epoch 9: 0.4606 0.4420  0.6836
Cf: [[4637   25]
 [  64   38]]
Epoch: 10/15
Train loss:0.0644, Valid loss:0.1008
Val metric mean prob: 0.3004
Best metric at epoch 10: 0.4766 0.2510  0.7435
Cf: [[4601   61]
 [  51   51]]
Model improve: 0.4625 -> 0.4766
Epoch: 11/15
Train loss:0.0555, Valid loss:0.1106
Val metric mean prob: 0.3134
Best metric at epoch 11: 0.4524 0.3890  0.6833
Cf: [[4634   28]
 [  64   38]]
Epoch: 12/15
Train loss:0.0494, Valid loss:0.1159
Val metric mean prob: 0.3212
Best metric at epoch 12: 0.4824 0.2970  0.7300
Cf: [[4613   49]
 [  54   48]]
Model improve: 0.4766 -> 0.4824
Epoch: 13/15
Train loss:0.0437, Valid loss:0.1173
Val metric mean prob: 0.3277
Best metric at epoch 13: 0.4771 0.2410  0.7480
Cf: [[4598   64]
 [  50   52]]
Epoch: 14/15
Train loss:0.0414, Valid loss:0.1176
Val metric mean prob: 0.3140
Best metric at epoch 14: 0.4646 0.2280  0.7201
Cf: [[4612   50]
 [  56   46]]
Epoch: 15/15
Train loss:0.0395, Valid loss:0.1190
Val metric mean prob: 0.3193
Best metric at epoch 15: 0.4878 0.2420  0.7394
Cf: [[4609   53]
 [  52   50]]
Model improve: 0.4824 -> 0.4878
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.1189
Val metric mean prob: 0.3193
Best metric at epoch 1: 0.4878 0.2420  0.7394
Cf: [[4609   53]
 [  52   50]]
Model improve: 0.0000 -> 0.4878
Epoch: 2/15
Valid loss:0.1173
Val metric mean prob: 0.3222
Best metric at: 0.4834 0.2410  0.7438
Cf: [[4604   58]
 [  51   51]]
Valid loss:0.1165
Val metric mean prob: 0.3224
Best metric at: 0.4752 0.2680  0.7297
Cf: [[4610   52]
 [  54   48]]
Valid loss:0.1189
Val metric mean prob: 0.3194
Best metric at: 0.4878 0.2420  0.7394
Cf: [[4609   53]
 [  52   50]]
Valid loss:0.1178
Val metric mean prob: 0.3221
Best metric at: 0.4880 0.2330  0.7440
Cf: [[4606   56]
 [  51   51]]
Valid loss:0.1183
Val metric mean prob: 0.3210
Best metric at: 0.4828 0.2420  0.7346
Cf: [[4610   52]
 [  53   49]]
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
Valid loss:0.1181
Val metric mean prob: 0.3237
Best metric at: 0.4883 0.2310  0.7486
Cf: [[4603   59]
 [  50   52]]
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
Valid loss:0.1176
Val metric mean prob: 0.3258
Best metric at: 0.4837 0.2400  0.7484
Cf: [[4601   61]
 [  50   52]]
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
Valid loss:0.1177
Val metric mean prob: 0.3257
Best metric at: 0.4860 0.2430  0.7485
Cf: [[4602   60]
 [  50   52]]
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
Valid loss:0.1175
Val metric mean prob: 0.3267
Best metric at: 0.4793 0.2380  0.7481
Cf: [[4599   63]
 [  50   52]]
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
Valid loss:0.1177
Val metric mean prob: 0.3256
Best metric at: 0.4906 0.2440  0.7487
Cf: [[4604   58]
 [  50   52]]
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
Valid loss:0.1176
Val metric mean prob: 0.3259
Best metric at: 0.4837 0.2400  0.7484
Cf: [[4601   61]
 [  50   52]]
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
Valid loss:0.1173
Val metric mean prob: 0.3273
Best metric at: 0.4793 0.2430  0.7481
Cf: [[4599   63]
 [  50   52]]
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_12_0.4824_0.297.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
Valid loss:0.1082
Val metric mean prob: 0.1884
Best metric at: 0.3265 0.1380  0.6502
Cf: [[4600   62]
 [  70   32]]
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_12_0.4824_0.297.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_13_0.4771_0.241.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_12_0.4824_0.297.pth
fold1/tf_efficientnetv2_b2_fold_1_model_epoch_15_0.4878_0.242.pth
Valid loss:0.1179
Val metric mean prob: 0.3222
Best metric at: 0.4834 0.2290  0.7438
Cf: [[4604   58]
 [  51   51]]
Valid loss:0.1178
Val metric mean prob: 0.3226
Best metric at: 0.4857 0.2310  0.7439
Cf: [[4605   57]
 [  51   51]]
Valid loss:0.1188
Val metric mean prob: 0.3199
Best metric at: 0.4878 0.2410  0.7394
Cf: [[4609   53]
 [  52   50]]
Valid loss:0.1177
Val metric mean prob: 0.3251
Best metric at: 0.4883 0.2410  0.7486
Cf: [[4603   59]
 [  50   52]]
Valid loss:0.1164
Val metric mean prob: 0.3262
Best metric at: 0.4925 0.2930  0.7350
Cf: [[4614   48]
 [  53   49]]
Valid loss:0.1165
Val metric mean prob: 0.3243
Best metric at: 0.4876 0.2790  0.7348
Cf: [[4612   50]
 [  53   49]]
Valid loss:0.1164
Val metric mean prob: 0.3246
Best metric at: 0.4876 0.2770  0.7348
Cf: [[4612   50]
 [  53   49]]
Valid loss:0.1167
Val metric mean prob: 0.3240
Best metric at: 0.4876 0.2740  0.7348
Cf: [[4612   50]
 [  53   49]]
Valid loss:0.1169
Val metric mean prob: 0.3276
Best metric at: 0.4854 0.2680  0.7393
Cf: [[4608   54]
 [  52   50]]
Valid loss:0.1168
Val metric mean prob: 0.3271
Best metric at: 0.4828 0.2760  0.7346
Cf: [[4610   52]
 [  53   49]]
Valid loss:0.1169
Val metric mean prob: 0.3240
Best metric at: 0.4851 0.2710  0.7347
Cf: [[4611   51]
 [  53   49]]
Valid loss:0.1170
Val metric mean prob: 0.3245
Best metric at: 0.4851 0.2670  0.7347
Cf: [[4611   51]
 [  53   49]]
Valid loss:0.1160
Val metric mean prob: 0.3238
Best metric at: 0.4824 0.2950  0.7300
Cf: [[4613   49]
 [  54   48]]
Valid loss:0.1179
Val metric mean prob: 0.3244
Best metric at: 0.4883 0.2350  0.7486
Cf: [[4603   59]
 [  50   52]]
Valid loss:0.1173
Val metric mean prob: 0.3263
Best metric at: 0.4860 0.2430  0.7485
Cf: [[4602   60]
 [  50   52]]
Valid loss:0.1166
Val metric mean prob: 0.3268
Best metric at: 0.4876 0.2940  0.7348
Cf: [[4612   50]
 [  53   49]]
Valid loss:0.1175
Val metric mean prob: 0.3258
Best metric at: 0.4952 0.2430  0.7489
Cf: [[4606   56]
 [  50   52]]
Valid loss:0.1173
Val metric mean prob: 0.3261
Best metric at: 0.4883 0.2430  0.7486
Cf: [[4603   59]
 [  50   52]]
Valid loss:0.1166
Val metric mean prob: 0.3266
Best metric at: 0.4876 0.2910  0.7348
Cf: [[4612   50]
 [  53   49]]
Valid loss:0.1178
Val metric mean prob: 0.3241
Best metric at: 0.4929 0.2380  0.7488
Cf: [[4605   57]
 [  50   52]]
Valid loss:0.1178
Val metric mean prob: 0.3240
Best metric at: 0.4883 0.2340  0.7486
Cf: [[4603   59]
 [  50   52]]
Valid loss:0.1179
Val metric mean prob: 0.3237
Best metric at: 0.4906 0.2330  0.7487
Cf: [[4604   58]
 [  50   52]]
Valid loss:0.1174
Val metric mean prob: 0.3249
Best metric at: 0.4929 0.2420  0.7488
Cf: [[4605   57]
 [  50   52]]
Valid loss:0.1175
Val metric mean prob: 0.3246
Best metric at: 0.4929 0.2400  0.7488
Cf: [[4605   57]
 [  50   52]]
Valid loss:0.1174
Val metric mean prob: 0.3258
Best metric at: 0.4906 0.2430  0.7487
Cf: [[4604   58]
 [  50   52]]
Valid loss:0.1178
Val metric mean prob: 0.3245
Best metric at: 0.4929 0.2390  0.7488
Cf: [[4605   57]
 [  50   52]]
Valid loss:0.1179
Val metric mean prob: 0.3236
Best metric at: 0.4883 0.2320  0.7486
Cf: [[4603   59]
 [  50   52]]
Valid loss:0.1174
Val metric mean prob: 0.3251
Best metric at: 0.4929 0.2420  0.7488
Cf: [[4605   57]
 [  50   52]]
Valid loss:0.1173
Val metric mean prob: 0.3223
Best metric at: 0.4831 0.2390  0.7392
Cf: [[4607   55]
 [  52   50]]
Valid loss:0.1173
Val metric mean prob: 0.3210
Best metric at: 0.4857 0.2200  0.7439
Cf: [[4605   57]
 [  51   51]]
Valid loss:0.1076
Val metric mean prob: 0.3228
Best metric at: 0.4744 0.2430  0.7434
Cf: [[4600   62]
 [  51   51]]
Valid loss:0.1121
Val metric mean prob: 0.3238
Best metric at: 0.4837 0.2410  0.7484
Cf: [[4601   61]
 [  50   52]]
Valid loss:0.0944
Val metric mean prob: 0.3081
Best metric at: 0.4671 0.3700  0.6884
Cf: [[4636   26]
 [  63   39]]
Valid loss:0.1092
Val metric mean prob: 0.3249
Best metric at: 0.4771 0.2340  0.7480
Cf: [[4598   64]
 [  50   52]]
Valid loss:0.1175
Val metric mean prob: 0.3222
Best metric at: 0.4831 0.2380  0.7392
Cf: [[4607   55]
 [  52   50]]
Valid loss:0.1176
Val metric mean prob: 0.3219
Best metric at: 0.4831 0.2360  0.7392
Cf: [[4607   55]
 [  52   50]]
Valid loss:0.1080
Val metric mean prob: 0.3163
Best metric at: 0.4718 0.2960  0.7204
Cf: [[4615   47]
 [  56   46]]
Valid loss:0.1152
Val metric mean prob: 0.3236
Best metric at: 0.4792 0.3030  0.7208
Cf: [[4618   44]
 [  56   46]]
Valid loss:0.1130
Val metric mean prob: 0.3225
Best metric at: 0.4837 0.2420  0.7484
Cf: [[4601   61]
 [  50   52]]
Valid loss:0.1140
Val metric mean prob: 0.3200
Best metric at: 0.4854 0.2370  0.7393
Cf: [[4608   54]
 [  52   50]]
Valid loss:0.1178
Val metric mean prob: 0.3221
Best metric at: 0.4880 0.2330  0.7440
Cf: [[4606   56]
 [  51   51]]
Valid loss:0.1183
Val metric mean prob: 0.3210
Best metric at: 0.4828 0.2430  0.7346
Cf: [[4610   52]
 [  53   49]]
Valid loss:0.1177
Val metric mean prob: 0.3220
Best metric at: 0.4904 0.2380  0.7441
Cf: [[4607   55]
 [  51   51]]
Valid loss:0.1179
Val metric mean prob: 0.3219
Best metric at: 0.4834 0.2270  0.7438
Cf: [[4604   58]
 [  51   51]]
Valid loss:0.1186
Val metric mean prob: 0.3198
Best metric at: 0.4808 0.2280  0.7391
Cf: [[4606   56]
 [  52   50]]
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 44603
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Valid loss:0.1168
Val metric mean prob: 0.3269
Best metric at: 0.4828 0.2750  0.7346
Cf: [[4610   52]
 [  53   49]]
Valid loss:0.1164
Val metric mean prob: 0.3267
Best metric at: 0.4925 0.2940  0.7350
Cf: [[4614   48]
 [  53   49]]
Valid loss:0.1182
Val metric mean prob: 0.3212
Best metric at: 0.4808 0.2320  0.7391
Cf: [[4606   56]
 [  52   50]]
Valid loss:0.1180
Val metric mean prob: 0.3223
Best metric at: 0.4811 0.2280  0.7437
Cf: [[4603   59]
 [  51   51]]
Valid loss:0.1167
Val metric mean prob: 0.3248
Best metric at: 0.4876 0.2770  0.7348
Cf: [[4612   50]
 [  53   49]]
Valid loss:0.1172
Val metric mean prob: 0.3272
Best metric at: 0.4831 0.2620  0.7392
Cf: [[4607   55]
 [  52   50]]
Valid loss:0.1177
Val metric mean prob: 0.3239
Best metric at: 0.4929 0.2360  0.7488
Cf: [[4605   57]
 [  50   52]]
Valid loss:0.1188
Val metric mean prob: 0.3195
Best metric at: 0.4878 0.2400  0.7394
Cf: [[4609   53]
 [  52   50]]
Valid loss:0.1179
Val metric mean prob: 0.3227
Best metric at: 0.4906 0.2300  0.7487
Cf: [[4604   58]
 [  50   52]]
Valid loss:0.1169
Val metric mean prob: 0.3260
Best metric at: 0.4811 0.2430  0.7437
Cf: [[4603   59]
 [  51   51]]
Valid loss:0.1177
Val metric mean prob: 0.3244
Best metric at: 0.4929 0.2400  0.7488
Cf: [[4605   57]
 [  50   52]]
Valid loss:0.1176
Val metric mean prob: 0.3252
Best metric at: 0.4952 0.2430  0.7489
Cf: [[4606   56]
 [  50   52]]
Valid loss:0.1179
Val metric mean prob: 0.3246
Best metric at: 0.4883 0.2370  0.7486
Cf: [[4603   59]
 [  50   52]]
Valid loss:0.1176
Val metric mean prob: 0.3248
Best metric at: 0.4952 0.2420  0.7489
Cf: [[4606   56]
 [  50   52]]
Valid loss:0.1176
Val metric mean prob: 0.3250
Best metric at: 0.4929 0.2420  0.7488
Cf: [[4605   57]
 [  50   52]]
Valid loss:0.1170
Val metric mean prob: 0.3248
Best metric at: 0.4828 0.2650  0.7346
Cf: [[4610   52]
 [  53   49]]
Valid loss:0.1168
Val metric mean prob: 0.3231
Best metric at: 0.4780 0.2610  0.7344
Cf: [[4608   54]
 [  53   49]]
Valid loss:0.1179
Val metric mean prob: 0.3239
Best metric at: 0.4883 0.2330  0.7486
Cf: [[4603   59]
 [  50   52]]
Valid loss:0.1164
Val metric mean prob: 0.3223
Best metric at: 0.4772 0.2930  0.7252
Cf: [[4614   48]
 [  55   47]]
Valid loss:0.1173
Val metric mean prob: 0.3254
Best metric at: 0.4929 0.2410  0.7488
Cf: [[4605   57]
 [  50   52]]
Date :02/16/2023, 14:37:57
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: Lion (
Parameter Group 0
    betas: (0.9, 0.99)
    initial_lr: 0.0001
    lr: 0.0
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: Lion (
Parameter Group 0
    betas: (0.9, 0.99)
    initial_lr: 0.0001
    lr: 0.0
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2034, Valid loss:0.1123
Val metric mean prob: 0.0296
Best metric at epoch 1: 0.0529 0.0490  0.5677
Cf: [[2778 1888]
 [  46   54]]
Model improve: 0.0000 -> 0.0529
Epoch: 2/15
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Train loss:0.1779, Valid loss:0.1038
Val metric mean prob: 0.0270
Best metric at epoch 2: 0.0652 0.0370  0.5799
Cf: [[3639 1027]
 [  62   38]]
Model improve: 0.0529 -> 0.0652
Epoch: 3/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: Lion (
Parameter Group 0
    betas: (0.9, 0.99)
    initial_lr: 1e-05
    lr: 0.0
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
                  Train loss:0.2621, Valid loss:0.1118
Val metric mean prob: 0.0442
Best metric at epoch 1: 0.0999 0.0940  0.6143
Cf: [[4100  566]
 [  65   35]]
Model improve: 0.0000 -> 0.0999
Epoch: 2/15
Train loss:0.1544, Valid loss:0.0870
Val metric mean prob: 0.1504
Best metric at epoch 2: 0.3205 0.3120  0.6217
Cf: [[4635   31]
 [  75   25]]
Model improve: 0.0999 -> 0.3205
Epoch: 3/15
Train loss:0.1344, Valid loss:0.0943
Val metric mean prob: 0.2218
Best metric at epoch 3: 0.3951 0.4190  0.6568
Cf: [[4636   30]
 [  68   32]]
Model improve: 0.3205 -> 0.3951
Epoch: 4/15
Train loss:0.1258, Valid loss:0.0824
Val metric mean prob: 0.2167
Best metric at epoch 4: 0.4195 0.2120  0.7084
Cf: [[4604   62]
 [  57   43]]
Model improve: 0.3951 -> 0.4195
Epoch: 5/15
Train loss:0.1127, Valid loss:0.0793
Val metric mean prob: 0.1699
Best metric at epoch 5: 0.4022 0.1390  0.6754
Cf: [[4623   43]
 [  64   36]]
Epoch: 6/15
                                                                                                                                                                                                                        ]
 [  63   39]]
Valid loss:0.1233
Val metric mean prob: 0.2956
Best metric at: 0.4167 0.4060  0.6682
Cf: [[4631   31]
 [  67   35]]
Valid loss:0.1230
Val metric mean prob: 0.2970
Best metric at: 0.4167 0.4080  0.6682
Cf: [[4631   31]
 [  67   35]]
Train loss:0.1024, Valid loss:0.0831
Val metric mean prob: 0.2268
Best metric at epoch 6: 0.4588 0.3000  0.6917
Cf: [[4635   31]
 [  61   39]]
Model improve: 0.4195 -> 0.4588
Epoch: 7/15
Train loss:0.0931, Valid loss:0.0899
Val metric mean prob: 0.2200
Best metric at epoch 7: 0.4052 0.4010  0.6526
Cf: [[4644   22]
 [  69   31]]
Epoch: 8/15
Train loss:0.0820, Valid loss:0.0914
Val metric mean prob: 0.2646
Best metric at epoch 8: 0.4211 0.2630  0.6579
Cf: [[4646   20]
 [  68   32]]
Epoch: 9/15
Train loss:0.0727, Valid loss:0.0970
Val metric mean prob: 0.2753
Best metric at epoch 9: 0.4294 0.2830  0.6720
Cf: [[4638   28]
 [  65   35]]
Epoch: 10/15
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0871
Val metric mean prob: 0.2621
Best metric at: 0.4557 0.3730  0.6776
Cf: [[4644   22]
 [  64   36]]
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0871
Val metric mean prob: 0.2621
Best metric at epoch 1: 0.4557 0.3730  0.6776
Cf: [[4644   22]
 [  64   36]]
Model improve: 0.0000 -> 0.4557
Epoch: 2/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0855
Val metric mean prob: 0.2513
Best metric at: 0.4588 0.3440  0.6917
Cf: [[4635   31]
 [  61   39]]
Valid loss:0.0901
Val metric mean prob: 0.2682
Best metric at: 0.4393 0.3870  0.6862
Cf: [[4631   35]
 [  62   38]]
Date :02/17/2023, 00:06:18
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0855
Val metric mean prob: 0.2513
Best metric at: 0.4588 0.3440  0.6917
Cf: [[4635   31]
 [  61   39]]
Valid loss:0.0901
Val metric mean prob: 0.2682
Best metric at: 0.4393 0.3870  0.6862
Cf: [[4631   35]
 [  62   38]]
Valid loss:0.0845
Val metric mean prob: 0.2482
Best metric at: 0.4358 0.3460  0.6907
Cf: [[4626   40]
 [  61   39]]
Valid loss:0.0915
Val metric mean prob: 0.2783
Best metric at: 0.4509 0.3780  0.6914
Cf: [[4632   34]
 [  61   39]]
Valid loss:0.0891
Val metric mean prob: 0.2688
Best metric at: 0.4535 0.3900  0.6915
Cf: [[4633   33]
 [  61   39]]
Valid loss:0.0892
Val metric mean prob: 0.2706
Best metric at: 0.4556 0.3380  0.7008
Cf: [[4627   39]
 [  59   41]]
Valid loss:0.0874
Val metric mean prob: 0.2614
Best metric at: 0.4561 0.3960  0.6916
Cf: [[4634   32]
 [  61   39]]
Valid loss:0.0832
Val metric mean prob: 0.2356
Best metric at: 0.4130 0.3200  0.6851
Cf: [[4620   46]
 [  62   38]]
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0815
Val metric mean prob: 0.2083
Best metric at epoch 1: 0.4103 0.2490  0.6941
Cf: [[4611   55]
 [  60   40]]
Model improve: 0.0000 -> 0.4103
Epoch: 2/15
Date :02/17/2023, 00:42:00
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/17/2023, 00:42:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0859
Val metric mean prob: 0.2801
Best metric at: 0.5269 0.3530  0.7175
Cf: [[4643   23]
 [  56   44]]
Date :02/17/2023, 01:01:32
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 0
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2096, Valid loss:0.1051
Val metric mean prob: 0.0389
Best metric at epoch 1: 0.1287 0.0660  0.6312
Cf: [[4257  409]
 [  65   35]]
Model improve: 0.0000 -> 0.1287
Epoch: 2/15
Train loss:0.1564, Valid loss:0.0858
Val metric mean prob: 0.1129
Best metric at epoch 2: 0.3265 0.1970  0.6175
Cf: [[4643   23]
 [  76   24]]
Model improve: 0.1287 -> 0.3265
Epoch: 3/15
Train loss:0.1368, Valid loss:0.0929
Val metric mean prob: 0.2176
Best metric at epoch 3: 0.3567 0.4700  0.6369
Cf: [[4637   29]
 [  72   28]]
Model improve: 0.3265 -> 0.3567
Epoch: 4/15
Date :02/17/2023, 03:05:27
Date :02/17/2023, 03:05:27
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
5 fold
Fold: 0
Fold: 0
Model name: tf_efficientnetv2_b2
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len train df: 44652
Len valid df: 10979
Len valid df: 10979
Train bs: 16
Train bs: 16
ModelOld
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
total_epoch :15
Warmup: 1
Warmup: 1
Epoch: 1/15
Epoch: 1/15
Date :02/17/2023, 03:17:41
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 44752
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Valid loss:0.0911
Val metric mean prob: 0.2682
Best metric at: 0.4667 0.4420  0.6897
Cf: [[4647   24]
 [  56   35]]
Valid loss:0.0910
Val metric mean prob: 0.2687
Best metric at: 0.4690 0.4640  0.6847
Cf: [[4651   20]
 [  57   34]]
Valid loss:0.0913
Val metric mean prob: 0.2659
Best metric at: 0.4588 0.3800  0.7100
Cf: [[4631   40]
 [  52   39]]
Valid loss:0.0908
Val metric mean prob: 0.2656
Best metric at: 0.4789 0.4770  0.6850
Cf: [[4654   17]
 [  57   34]]
Valid loss:0.0899
Val metric mean prob: 0.2492
Best metric at: 0.4755 0.4500  0.6849
Cf: [[4653   18]
 [  57   34]]
Valid loss:0.0898
Val metric mean prob: 0.2431
Best metric at: 0.4658 0.4310  0.6846
Cf: [[4650   21]
 [  57   34]]
Valid loss:0.0903
Val metric mean prob: 0.2549
Best metric at: 0.4832 0.4470  0.6954
Cf: [[4649   22]
 [  55   36]]
Valid loss:0.0902
Val metric mean prob: 0.2528
Best metric at: 0.4828 0.4560  0.6903
Cf: [[4652   19]
 [  56   35]]
Valid loss:0.0910
Val metric mean prob: 0.2689
Best metric at: 0.4658 0.4510  0.6846
Cf: [[4650   21]
 [  57   34]]
Valid loss:0.0905
Val metric mean prob: 0.2590
Best metric at: 0.4898 0.4530  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0907
Val metric mean prob: 0.2606
Best metric at: 0.4898 0.4560  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0907
Val metric mean prob: 0.2608
Best metric at: 0.4898 0.4570  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0906
Val metric mean prob: 0.2602
Best metric at: 0.4898 0.4560  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0908
Val metric mean prob: 0.2654
Best metric at: 0.4789 0.4770  0.6850
Cf: [[4654   17]
 [  57   34]]
Valid loss:0.0905
Val metric mean prob: 0.2586
Best metric at: 0.4898 0.4530  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0897
Val metric mean prob: 0.2398
Best metric at: 0.4658 0.4260  0.6846
Cf: [[4650   21]
 [  57   34]]
Valid loss:0.0907
Val metric mean prob: 0.2636
Best metric at: 0.4800 0.4460  0.6953
Cf: [[4648   23]
 [  55   36]]
Valid loss:0.0903
Val metric mean prob: 0.2563
Best metric at: 0.4898 0.4510  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0900
Val metric mean prob: 0.2482
Best metric at: 0.4755 0.4500  0.6849
Cf: [[4653   18]
 [  57   34]]
Valid loss:0.0907
Val metric mean prob: 0.2631
Best metric at: 0.4832 0.4540  0.6954
Cf: [[4649   22]
 [  55   36]]
Valid loss:0.0909
Val metric mean prob: 0.2676
Best metric at: 0.4722 0.4710  0.6848
Cf: [[4652   19]
 [  57   34]]
Valid loss:0.0907
Val metric mean prob: 0.2607
Best metric at: 0.4898 0.4560  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0905
Val metric mean prob: 0.2591
Best metric at: 0.4898 0.4530  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0907
Val metric mean prob: 0.2624
Best metric at: 0.4865 0.4560  0.6956
Cf: [[4650   21]
 [  55   36]]
Valid loss:0.0903
Val metric mean prob: 0.2559
Best metric at: 0.4832 0.4470  0.6954
Cf: [[4649   22]
 [  55   36]]
Valid loss:0.0908
Val metric mean prob: 0.2651
Best metric at: 0.4789 0.4780  0.6850
Cf: [[4654   17]
 [  57   34]]
Valid loss:0.0857
Val metric mean prob: 0.2401
Best metric at: 0.4379 0.3910  0.6989
Cf: [[4630   41]
 [  54   37]]
Valid loss:0.0895
Val metric mean prob: 0.2627
Best metric at: 0.4832 0.4640  0.6954
Cf: [[4649   22]
 [  55   36]]
Valid loss:0.0894
Val metric mean prob: 0.2523
Best metric at: 0.4932 0.4530  0.6958
Cf: [[4652   19]
 [  55   36]]
Valid loss:0.0870
Val metric mean prob: 0.2395
Best metric at: 0.4578 0.4060  0.7048
Cf: [[4634   37]
 [  53   38]]
Valid loss:0.0891
Val metric mean prob: 0.2391
Best metric at: 0.4571 0.4970  0.6740
Cf: [[4654   17]
 [  59   32]]
Valid loss:0.0892
Val metric mean prob: 0.2536
Best metric at: 0.4768 0.4520  0.6952
Cf: [[4647   24]
 [  55   36]]
Valid loss:0.0871
Val metric mean prob: 0.2464
Best metric at: 0.4500 0.4370  0.6943
Cf: [[4638   33]
 [  55   36]]
Valid loss:0.0868
Val metric mean prob: 0.2475
Best metric at: 0.4528 0.4400  0.6944
Cf: [[4639   32]
 [  55   36]]
Valid loss:0.0899
Val metric mean prob: 0.2588
Best metric at: 0.4898 0.4580  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0858
Val metric mean prob: 0.2335
Best metric at: 0.4648 0.4930  0.6794
Cf: [[4653   18]
 [  58   33]]
Valid loss:0.0886
Val metric mean prob: 0.2396
Best metric at: 0.4755 0.4550  0.6849
Cf: [[4653   18]
 [  57   34]]
Valid loss:0.0887
Val metric mean prob: 0.2452
Best metric at: 0.4828 0.4490  0.6903
Cf: [[4652   19]
 [  56   35]]
Valid loss:0.0887
Val metric mean prob: 0.2457
Best metric at: 0.4828 0.4530  0.6903
Cf: [[4652   19]
 [  56   35]]
Valid loss:0.0894
Val metric mean prob: 0.2378
Best metric at: 0.4648 0.4440  0.6794
Cf: [[4653   18]
 [  58   33]]
Valid loss:0.0889
Val metric mean prob: 0.2596
Best metric at: 0.4865 0.4640  0.6956
Cf: [[4650   21]
 [  55   36]]
Valid loss:0.0893
Val metric mean prob: 0.2503
Best metric at: 0.4828 0.4520  0.6903
Cf: [[4652   19]
 [  56   35]]
Valid loss:0.0879
Val metric mean prob: 0.2489
Best metric at: 0.4615 0.4470  0.6947
Cf: [[4642   29]
 [  55   36]]
Valid loss:0.0892
Val metric mean prob: 0.2516
Best metric at: 0.4865 0.4480  0.6956
Cf: [[4650   21]
 [  55   36]]
Valid loss:0.0906
Val metric mean prob: 0.2675
Best metric at: 0.4795 0.4620  0.6902
Cf: [[4651   20]
 [  56   35]]
Valid loss:0.0887
Val metric mean prob: 0.2494
Best metric at: 0.4828 0.4610  0.6903
Cf: [[4652   19]
 [  56   35]]
Valid loss:0.0882
Val metric mean prob: 0.2511
Best metric at: 0.4737 0.4530  0.6951
Cf: [[4646   25]
 [  55   36]]
Valid loss:0.0886
Val metric mean prob: 0.2566
Best metric at: 0.4865 0.4630  0.6956
Cf: [[4650   21]
 [  55   36]]
Valid loss:0.0866
Val metric mean prob: 0.2482
Best metric at: 0.4444 0.4360  0.6941
Cf: [[4636   35]
 [  55   36]]
Valid loss:0.0892
Val metric mean prob: 0.2565
Best metric at: 0.4865 0.4610  0.6956
Cf: [[4650   21]
 [  55   36]]
Valid loss:0.0890
Val metric mean prob: 0.2597
Best metric at: 0.4865 0.4610  0.6956
Cf: [[4650   21]
 [  55   36]]
Valid loss:0.0891
Val metric mean prob: 0.2525
Best metric at: 0.4898 0.4530  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0890
Val metric mean prob: 0.2526
Best metric at: 0.4898 0.4510  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0889
Val metric mean prob: 0.2425
Best metric at: 0.4828 0.4490  0.6903
Cf: [[4652   19]
 [  56   35]]
Valid loss:0.0887
Val metric mean prob: 0.2489
Best metric at: 0.4828 0.4510  0.6903
Cf: [[4652   19]
 [  56   35]]
Valid loss:0.0890
Val metric mean prob: 0.2463
Best metric at: 0.4828 0.4580  0.6903
Cf: [[4652   19]
 [  56   35]]
Valid loss:0.0887
Val metric mean prob: 0.2498
Best metric at: 0.4828 0.4530  0.6903
Cf: [[4652   19]
 [  56   35]]
Valid loss:0.0889
Val metric mean prob: 0.2528
Best metric at: 0.4932 0.4560  0.6958
Cf: [[4652   19]
 [  55   36]]
Valid loss:0.0888
Val metric mean prob: 0.2530
Best metric at: 0.4898 0.4590  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0886
Val metric mean prob: 0.2531
Best metric at: 0.4832 0.4560  0.6954
Cf: [[4649   22]
 [  55   36]]
Valid loss:0.0885
Val metric mean prob: 0.2533
Best metric at: 0.4768 0.4560  0.6952
Cf: [[4647   24]
 [  55   36]]
Valid loss:0.0889
Val metric mean prob: 0.2526
Best metric at: 0.4898 0.4520  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0886
Val metric mean prob: 0.2511
Best metric at: 0.4898 0.4540  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0889
Val metric mean prob: 0.2488
Best metric at: 0.4828 0.4510  0.6903
Cf: [[4652   19]
 [  56   35]]
Valid loss:0.0891
Val metric mean prob: 0.2537
Best metric at: 0.4932 0.4590  0.6958
Cf: [[4652   19]
 [  55   36]]
Valid loss:0.0890
Val metric mean prob: 0.2549
Best metric at: 0.4966 0.4650  0.6959
Cf: [[4653   18]
 [  55   36]]
Valid loss:0.0886
Val metric mean prob: 0.2537
Best metric at: 0.4832 0.4510  0.6954
Cf: [[4649   22]
 [  55   36]]
Valid loss:0.0890
Val metric mean prob: 0.2554
Best metric at: 0.4932 0.4600  0.6958
Cf: [[4652   19]
 [  55   36]]
Valid loss:0.0889
Val metric mean prob: 0.2536
Best metric at: 0.4932 0.4560  0.6958
Cf: [[4652   19]
 [  55   36]]
Valid loss:0.0890
Val metric mean prob: 0.2552
Best metric at: 0.4932 0.4630  0.6958
Cf: [[4652   19]
 [  55   36]]
Valid loss:0.0886
Val metric mean prob: 0.2546
Best metric at: 0.4865 0.4660  0.6956
Cf: [[4650   21]
 [  55   36]]
Valid loss:0.0896
Val metric mean prob: 0.2520
Best metric at: 0.4898 0.4510  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0885
Val metric mean prob: 0.2541
Best metric at: 0.4932 0.4630  0.6958
Cf: [[4652   19]
 [  55   36]]
Valid loss:0.0888
Val metric mean prob: 0.2535
Best metric at: 0.4966 0.4650  0.6959
Cf: [[4653   18]
 [  55   36]]
Valid loss:0.0894
Val metric mean prob: 0.2533
Best metric at: 0.4932 0.4560  0.6958
Cf: [[4652   19]
 [  55   36]]
Valid loss:0.0885
Val metric mean prob: 0.2503
Best metric at: 0.4762 0.4570  0.6901
Cf: [[4650   21]
 [  56   35]]
Valid loss:0.0896
Val metric mean prob: 0.2516
Best metric at: 0.4832 0.4490  0.6954
Cf: [[4649   22]
 [  55   36]]
Valid loss:0.0887
Val metric mean prob: 0.2539
Best metric at: 0.4898 0.4590  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0889
Val metric mean prob: 0.2538
Best metric at: 0.4932 0.4560  0.6958
Cf: [[4652   19]
 [  55   36]]
Valid loss:0.0888
Val metric mean prob: 0.2552
Best metric at: 0.4865 0.4560  0.6956
Cf: [[4650   21]
 [  55   36]]
Valid loss:0.0894
Val metric mean prob: 0.2532
Best metric at: 0.4932 0.4550  0.6958
Cf: [[4652   19]
 [  55   36]]
Valid loss:0.0890
Val metric mean prob: 0.2544
Best metric at: 0.4898 0.4590  0.6957
Cf: [[4651   20]
 [  55   36]]
Valid loss:0.0891
Val metric mean prob: 0.2542
Best metric at: 0.4932 0.4540  0.6958
Cf: [[4652   19]
 [  55   36]]
Valid loss:0.0885
Val metric mean prob: 0.2533
Best metric at: 0.4768 0.4630  0.6952
Cf: [[4647   24]
 [  55   36]]
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Valid loss:0.0884
Val metric mean prob: 0.2931
Best metric at: 0.4731 0.3250  0.7114
Cf: [[4622   40]
 [  58   44]]
Valid loss:0.0839
Val metric mean prob: 0.2811
Best metric at: 0.4742 0.3050  0.7206
Cf: [[4616   46]
 [  56   46]]
Valid loss:0.0829
Val metric mean prob: 0.2515
Best metric at: 0.4683 0.2370  0.7294
Cf: [[4607   55]
 [  54   48]]
Date :02/17/2023, 08:44:55
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Date :02/17/2023, 08:47:13
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Date :02/17/2023, 08:55:29
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Valid loss:0.0884
Val metric mean prob: 0.2931
Best metric at: 0.4731 0.3250  0.7114
Cf: [[4622   40]
 [  58   44]]
Valid loss:0.0839
Val metric mean prob: 0.2811
Best metric at: 0.4742 0.3050  0.7206
Cf: [[4616   46]
 [  56   46]]
Valid loss:0.0829
Val metric mean prob: 0.2515
Best metric at: 0.4683 0.2370  0.7294
Cf: [[4607   55]
 [  54   48]]
Valid loss:0.0818
Val metric mean prob: 0.2523
Best metric at: 0.4921 0.2950  0.7259
Cf: [[4620   42]
 [  55   47]]
Valid loss:0.1031
Val metric mean prob: 0.3108
Best metric at: 0.4516 0.2940  0.7014
Cf: [[4620   42]
 [  60   42]]
Valid loss:0.0807
Val metric mean prob: 0.2372
Best metric at: 0.4828 0.2500  0.7346
Cf: [[4610   52]
 [  53   49]]
Valid loss:0.0884
Val metric mean prob: 0.2931
Best metric at: 0.4731 0.3250  0.7114
Cf: [[4622   40]
 [  58   44]]
Valid loss:0.0839
Val metric mean prob: 0.2812
Best metric at: 0.4742 0.3050  0.7206
Cf: [[4616   46]
 [  56   46]]
Valid loss:0.0829
Val metric mean prob: 0.2516
Best metric at: 0.4660 0.2360  0.7293
Cf: [[4606   56]
 [  54   48]]
Valid loss:0.0818
Val metric mean prob: 0.2524
Best metric at: 0.4947 0.2960  0.7260
Cf: [[4621   41]
 [  55   47]]
Valid loss:0.1032
Val metric mean prob: 0.3108
Best metric at: 0.4516 0.2920  0.7014
Cf: [[4620   42]
 [  60   42]]
Valid loss:0.0807
Val metric mean prob: 0.2372
Best metric at: 0.4828 0.2510  0.7346
Cf: [[4610   52]
 [  53   49]]
Valid loss:0.0951
Val metric mean prob: 0.3094
Best metric at: 0.4649 0.3310  0.7065
Cf: [[4622   40]
 [  59   43]]
Valid loss:0.0844
Val metric mean prob: 0.2696
Best metric at: 0.4762 0.3070  0.7161
Cf: [[4620   42]
 [  57   45]]
Valid loss:0.0898
Val metric mean prob: 0.3040
Best metric at: 0.4523 0.3100  0.7150
Cf: [[4610   52]
 [  57   45]]
Valid loss:0.0912
Val metric mean prob: 0.3041
Best metric at: 0.4699 0.3450  0.7067
Cf: [[4624   38]
 [  59   43]]
Valid loss:0.0887
Val metric mean prob: 0.2928
Best metric at: 0.4731 0.3170  0.7114
Cf: [[4622   40]
 [  58   44]]
Valid loss:0.0846
Val metric mean prob: 0.2841
Best metric at: 0.4828 0.2570  0.7346
Cf: [[4610   52]
 [  53   49]]
Valid loss:0.0832
Val metric mean prob: 0.2534
Best metric at: 0.4724 0.2480  0.7250
Cf: [[4612   50]
 [  55   47]]
Valid loss:0.0819
Val metric mean prob: 0.2534
Best metric at: 0.4948 0.2880  0.7306
Cf: [[4618   44]
 [  54   48]]
Valid loss:0.1032
Val metric mean prob: 0.3106
Best metric at: 0.4516 0.2920  0.7014
Cf: [[4620   42]
 [  60   42]]
Valid loss:0.0806
Val metric mean prob: 0.2377
Best metric at: 0.4828 0.2540  0.7346
Cf: [[4610   52]
 [  53   49]]
Valid loss:0.0951
Val metric mean prob: 0.3091
Best metric at: 0.4590 0.3400  0.7017
Cf: [[4623   39]
 [  60   42]]
Valid loss:0.0848
Val metric mean prob: 0.2707
Best metric at: 0.4767 0.2970  0.7207
Cf: [[4617   45]
 [  56   46]]
Valid loss:0.0943
Val metric mean prob: 0.2930
Best metric at: 0.4520 0.2980  0.6923
Cf: [[4627   35]
 [  62   40]]
Valid loss:0.0914
Val metric mean prob: 0.3049
Best metric at: 0.4663 0.3050  0.7157
Cf: [[4616   46]
 [  57   45]]
Valid loss:0.0812
Val metric mean prob: 0.1969
Best metric at: 0.4444 0.2210  0.6920
Cf: [[4624   38]
 [  62   40]]
Valid loss:0.0804
Val metric mean prob: 0.2265
Best metric at: 0.4821 0.2580  0.7255
Cf: [[4616   46]
 [  55   47]]
Valid loss:0.0832
Val metric mean prob: 0.2777
Best metric at: 0.4747 0.2940  0.7251
Cf: [[4613   49]
 [  55   47]]
Valid loss:0.0910
Val metric mean prob: 0.3028
Best metric at: 0.4712 0.2810  0.7341
Cf: [[4605   57]
 [  53   49]]
Valid loss:0.0846
Val metric mean prob: 0.2378
Best metric at: 0.4615 0.3010  0.7018
Cf: [[4624   38]
 [  60   42]]
Valid loss:0.0944
Val metric mean prob: 0.3079
Best metric at: 0.4551 0.3940  0.6834
Cf: [[4635   27]
 [  64   38]]
Valid loss:0.0813
Val metric mean prob: 0.2656
Best metric at: 0.4718 0.2770  0.7204
Cf: [[4615   47]
 [  56   46]]
Valid loss:0.0852
Val metric mean prob: 0.2858
Best metric at: 0.4824 0.2970  0.7300
Cf: [[4613   49]
 [  54   48]]
Valid loss:0.0800
Val metric mean prob: 0.2480
Best metric at: 0.4842 0.2700  0.7210
Cf: [[4620   42]
 [  56   46]]
Valid loss:0.0812
Val metric mean prob: 0.2591
Best metric at: 0.4894 0.2870  0.7212
Cf: [[4622   40]
 [  56   46]]
Valid loss:0.0818
Val metric mean prob: 0.2579
Best metric at: 0.4813 0.3050  0.7163
Cf: [[4622   40]
 [  57   45]]
Valid loss:0.0805
Val metric mean prob: 0.2516
Best metric at: 0.4817 0.2720  0.7209
Cf: [[4619   43]
 [  56   46]]
Valid loss:0.0801
Val metric mean prob: 0.2538
Best metric at: 0.4767 0.2670  0.7207
Cf: [[4617   45]
 [  56   46]]
Valid loss:0.0820
Val metric mean prob: 0.2697
Best metric at: 0.4811 0.2370  0.7437
Cf: [[4603   59]
 [  51   51]]
Valid loss:0.0805
Val metric mean prob: 0.2436
Best metric at: 0.4681 0.2580  0.7112
Cf: [[4620   42]
 [  58   44]]
Valid loss:0.0817
Val metric mean prob: 0.2616
Best metric at: 0.4842 0.2870  0.7210
Cf: [[4620   42]
 [  56   46]]
Valid loss:0.0839
Val metric mean prob: 0.2803
Best metric at: 0.4712 0.2940  0.7159
Cf: [[4618   44]
 [  57   45]]
Valid loss:0.0882
Val metric mean prob: 0.2968
Best metric at: 0.4615 0.2500  0.7291
Cf: [[4604   58]
 [  54   48]]
Valid loss:0.0882
Val metric mean prob: 0.2898
Best metric at: 0.4725 0.3580  0.7068
Cf: [[4625   37]
 [  59   43]]
Valid loss:0.0871
Val metric mean prob: 0.2753
Best metric at: 0.4767 0.3410  0.7207
Cf: [[4617   45]
 [  56   46]]
Valid loss:0.0873
Val metric mean prob: 0.2907
Best metric at: 0.4663 0.3220  0.7157
Cf: [[4616   46]
 [  57   45]]
Valid loss:0.0832
Val metric mean prob: 0.2500
Best metric at: 0.4747 0.2490  0.7251
Cf: [[4613   49]
 [  55   47]]
Valid loss:0.0886
Val metric mean prob: 0.2945
Best metric at: 0.4751 0.3670  0.7069
Cf: [[4626   36]
 [  59   43]]
Valid loss:0.0991
Val metric mean prob: 0.3114
Best metric at: 0.4516 0.3150  0.7014
Cf: [[4620   42]
 [  60   42]]
Date :02/17/2023, 12:29:27
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2144, Valid loss:0.1066
Val metric mean prob: 0.0484
Best metric at epoch 1: 0.1617 0.1050  0.6242
Cf: [[4425  241]
 [  70   30]]
Model improve: 0.0000 -> 0.1617
Epoch: 2/15
Train loss:0.1532, Valid loss:0.0847
Val metric mean prob: 0.1120
Best metric at epoch 2: 0.3069 0.1190  0.6386
Cf: [[4606   60]
 [  71   29]]
Model improve: 0.1617 -> 0.3069
Epoch: 3/15
Train loss:0.1351, Valid loss:0.0933
Val metric mean prob: 0.1619
Best metric at epoch 3: 0.3810 0.2630  0.6925
Cf: [[4596   70]
 [  60   40]]
Model improve: 0.3069 -> 0.3810
Epoch: 4/15
Train loss:0.1230, Valid loss:0.0811
Val metric mean prob: 0.1937
Best metric at epoch 4: 0.3736 0.2080  0.6649
Cf: [[4618   48]
 [  66   34]]
Epoch: 5/15
Train loss:0.1099, Valid loss:0.0888
Val metric mean prob: 0.2057
Best metric at epoch 5: 0.3973 0.4110  0.6432
Cf: [[4649   17]
 [  71   29]]
Model improve: 0.3810 -> 0.3973
Epoch: 6/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 1e-06
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 24196
Len valid df: 5835
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 1e-06
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/17/2023, 16:25:10
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 1000
Len valid df: 1000
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 1e-06
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 300
Len valid df: 1000
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 1e-06
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 300
Len valid df: 300
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.6039, Valid loss:0.4551
Val metric mean prob: 0.0403
Best metric at epoch 1: 0.0484 0.2660  0.5083
Cf: [[  2 118]
 [  0   3]]
Model improve: 0.0000 -> 0.0484
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 300
Len valid df: 300
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.5933, Valid loss:0.4249
Val metric mean prob: 0.0411
Best metric at epoch 1: 0.0845 0.3390  0.7695
Cf: [[76 65]
 [ 0  3]]
Model improve: 0.0000 -> 0.0845
site 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 24196
Len valid df: 5835
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
site 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 24196
Len valid df: 5835
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2325, Valid loss:0.1197
Val metric mean prob: 0.0474
Best metric at epoch 1: 0.1180 0.0780  0.6106
Cf: [[1951  274]
 [  40   21]]
Model improve: 0.0000 -> 0.1180
Epoch: 2/15
Train loss:0.1620, Valid loss:0.1138
Val metric mean prob: 0.0738
Best metric at epoch 2: 0.1938 0.1180  0.6480
Cf: [[2081  144]
 [  39   22]]
Model improve: 0.1180 -> 0.1938
Epoch: 3/15
Train loss:0.1518, Valid loss:0.1118
Val metric mean prob: 0.1129
Best metric at epoch 3: 0.2281 0.1940  0.5976
Cf: [[2185   40]
 [  48   13]]
Model improve: 0.1938 -> 0.2281
Epoch: 4/15
Train loss:0.1414, Valid loss:0.1054
Val metric mean prob: 0.1058
Best metric at epoch 4: 0.2642 0.1150  0.6548
Cf: [[2148   77]
 [  40   21]]
Model improve: 0.2281 -> 0.2642
Epoch: 5/15
Train loss:0.1277, Valid loss:0.1059
Val metric mean prob: 0.1411
Best metric at epoch 5: 0.2751 0.1220  0.6902
Cf: [[2123  102]
 [  35   26]]
Model improve: 0.2642 -> 0.2751
Epoch: 6/15
Train loss:0.1141, Valid loss:0.1112
Val metric mean prob: 0.1576
Best metric at epoch 6: 0.3014 0.1850  0.6662
Cf: [[2162   63]
 [  39   22]]
Model improve: 0.2751 -> 0.3014
Epoch: 7/15
Train loss:0.0976, Valid loss:0.1190
Val metric mean prob: 0.1430
Best metric at epoch 7: 0.2614 0.1490  0.6478
Cf: [[2153   72]
 [  41   20]]
Epoch: 8/15
Train loss:0.0809, Valid loss:0.1406
Val metric mean prob: 0.1749
Best metric at epoch 8: 0.2656 0.2990  0.6281
Cf: [[2175   50]
 [  44   17]]
Epoch: 9/15
Train loss:0.0676, Valid loss:0.1373
Val metric mean prob: 0.1709
Best metric at epoch 9: 0.2909 0.3120  0.6237
Cf: [[2192   33]
 [  45   16]]
Epoch: 10/15
Train loss:0.0563, Valid loss:0.1646
Val metric mean prob: 0.1926
Best metric at epoch 10: 0.2973 0.2750  0.6657
Cf: [[2160   65]
 [  39   22]]
Epoch: 11/15
Train loss:0.0457, Valid loss:0.1599
Val metric mean prob: 0.1793
Best metric at epoch 11: 0.2931 0.2830  0.6308
Cf: [[2187   38]
 [  44   17]]
Epoch: 12/15
Train loss:0.0402, Valid loss:0.1835
Val metric mean prob: 0.1820
Best metric at epoch 12: 0.2885 0.2310  0.6167
Cf: [[2197   28]
 [  46   15]]
Epoch: 13/15
Train loss:0.0346, Valid loss:0.1786
Val metric mean prob: 0.1789
Best metric at epoch 13: 0.2819 0.1250  0.6571
Cf: [[2158   67]
 [  40   21]]
Epoch: 14/15
Train loss:0.0328, Valid loss:0.1815
Val metric mean prob: 0.1694
Best metric at epoch 14: 0.2642 0.2710  0.6078
Cf: [[2194   31]
 [  47   14]]
Epoch: 15/15
Train loss:0.0308, Valid loss:0.1827
Val metric mean prob: 0.1670
Best metric at epoch 15: 0.2569 0.2800  0.6071
Cf: [[2191   34]
 [  47   14]]
site 2
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 20456
Len valid df: 5144
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2434, Valid loss:0.0814
Val metric mean prob: 0.0195
Best metric at epoch 1: 0.0662 0.0320  0.5422
Cf: [[2334  107]
 [  34    5]]
Model improve: 0.0000 -> 0.0662
Epoch: 2/15
Train loss:0.1660, Valid loss:0.0903
Val metric mean prob: 0.0561
Best metric at epoch 2: 0.1974 0.1560  0.6722
Cf: [[2343   98]
 [  24   15]]
Model improve: 0.0662 -> 0.1974
Epoch: 3/15
site 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 24196
Len valid df: 5835
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.1092
Val metric mean prob: 0.2359
Best metric at epoch 1: 0.4490 0.3530  0.6770
Cf: [[2210   15]
 [  39   22]]
Model improve: 0.0000 -> 0.4490
Epoch: 2/15
site 2
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 20456
Len valid df: 5144
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
site 2
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 20456
Len valid df: 5144
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0594
Val metric mean prob: 0.3379
Best metric at epoch 1: 0.6441 0.4400  0.7434
Cf: [[2440    1]
 [  20   19]]
Model improve: 0.0000 -> 0.6441
Epoch: 2/15
site 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 23955
Len valid df: 6094
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.1024
Val metric mean prob: 0.2345
Best metric at epoch 1: 0.4819 0.4520  0.6935
Cf: [[2335   12]
 [  31   20]]
Model improve: 0.0000 -> 0.4819
site 2
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 20648
Len valid df: 4918
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0857
Val metric mean prob: 0.3214
Best metric at epoch 1: 0.5684 0.4540  0.7426
Cf: [[2302   13]
 [  28   27]]
Model improve: 0.0000 -> 0.5684
site 2
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 20400
Len valid df: 5170
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0680
Val metric mean prob: 0.3213
Best metric at epoch 1: 0.6000 0.2880  0.8009
Cf: [[2435   23]
 [  21   33]]
Model improve: 0.0000 -> 0.6000
Epoch: 2/15
site 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 23955
Len valid df: 6094
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0539
Val metric mean prob: 0.3646
Best metric at epoch 1: 0.7593 0.2870  0.8986
Cf: [[2331   16]
 [  10   41]]
Model improve: 0.0000 -> 0.7593
site 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 24350
Len valid df: 5709
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0945
Val metric mean prob: 0.1851
Best metric at epoch 1: 0.3659 0.2940  0.6519
Cf: [[2185   19]
 [  33   15]]
Model improve: 0.0000 -> 0.3659
Epoch: 2/15
site 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Valid loss:0.0882
Val metric mean prob: 0.2898
Best metric at: 0.4725 0.3580  0.7068
Cf: [[4625   37]
 [  59   43]]
Valid loss:0.0871
Val metric mean prob: 0.2753
Best metric at: 0.4767 0.3410  0.7207
Cf: [[4617   45]
 [  56   46]]
Valid loss:0.0873
Val metric mean prob: 0.2907
Best metric at: 0.4663 0.3220  0.7157
Cf: [[4616   46]
 [  57   45]]
Valid loss:0.0832
Val metric mean prob: 0.2500
Best metric at: 0.4747 0.2490  0.7251
Cf: [[4613   49]
 [  55   47]]
Valid loss:0.0886
Val metric mean prob: 0.2945
Best metric at: 0.4751 0.3670  0.7069
Cf: [[4626   36]
 [  59   43]]
Valid loss:0.0991
Val metric mean prob: 0.3114
Best metric at: 0.4516 0.3150  0.7014
Cf: [[4620   42]
 [  60   42]]
Valid loss:0.1028
Val metric mean prob: 0.3112
Best metric at: 0.4541 0.2980  0.7015
Cf: [[4621   41]
 [  60   42]]
Valid loss:0.0827
Val metric mean prob: 0.2433
Best metric at: 0.4751 0.2900  0.7069
Cf: [[4626   36]
 [  59   43]]
Valid loss:0.1069
Val metric mean prob: 0.3065
Best metric at: 0.4432 0.2820  0.6965
Cf: [[4620   42]
 [  61   41]]
Valid loss:0.0951
Val metric mean prob: 0.3092
Best metric at: 0.4649 0.3250  0.7065
Cf: [[4622   40]
 [  59   43]]
Valid loss:0.0796
Val metric mean prob: 0.2277
Best metric at: 0.4787 0.2530  0.7162
Cf: [[4621   41]
 [  57   45]]
Valid loss:0.1082
Val metric mean prob: 0.2358
Best metric at: 0.4390 0.4660  0.6737
Cf: [[2334   13]
 [  33   18]]
Valid loss:0.1057
Val metric mean prob: 0.2324
Best metric at: 0.4337 0.4290  0.6735
Cf: [[2333   14]
 [  33   18]]
Valid loss:0.0998
Val metric mean prob: 0.2219
Best metric at: 0.4348 0.3980  0.6916
Cf: [[2326   21]
 [  31   20]]
Valid loss:0.1000
Val metric mean prob: 0.2254
Best metric at: 0.4390 0.4520  0.6737
Cf: [[2334   13]
 [  33   18]]
Valid loss:0.1009
Val metric mean prob: 0.2309
Best metric at: 0.4598 0.3980  0.6927
Cf: [[2331   16]
 [  31   20]]
Valid loss:0.1151
Val metric mean prob: 0.2308
Best metric at: 0.4000 0.3930  0.6989
Cf: [[2314   33]
 [  30   21]]
Valid loss:0.1028
Val metric mean prob: 0.2341
Best metric at: 0.4468 0.4410  0.7012
Cf: [[2325   22]
 [  30   21]]
Valid loss:0.1007
Val metric mean prob: 0.2184
Best metric at: 0.4146 0.4700  0.6637
Cf: [[2333   14]
 [  34   17]]
Valid loss:0.1011
Val metric mean prob: 0.2286
Best metric at: 0.4368 0.4430  0.6827
Cf: [[2330   17]
 [  32   19]]
Valid loss:0.1053
Val metric mean prob: 0.2366
Best metric at: 0.4419 0.4370  0.6829
Cf: [[2331   16]
 [  32   19]]
Valid loss:0.0966
Val metric mean prob: 0.2200
Best metric at: 0.4545 0.3690  0.6925
Cf: [[2330   17]
 [  31   20]]
Valid loss:0.0972
Val metric mean prob: 0.2213
Best metric at: 0.4545 0.3680  0.6925
Cf: [[2330   17]
 [  31   20]]
Valid loss:0.0969
Val metric mean prob: 0.2207
Best metric at: 0.4545 0.3720  0.6925
Cf: [[2330   17]
 [  31   20]]
Valid loss:0.0983
Val metric mean prob: 0.2252
Best metric at: 0.4651 0.4050  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.0987
Val metric mean prob: 0.2260
Best metric at: 0.4444 0.4150  0.6739
Cf: [[2335   12]
 [  33   18]]
Valid loss:0.1004
Val metric mean prob: 0.2296
Best metric at: 0.4651 0.4040  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1082
Val metric mean prob: 0.2358
Best metric at: 0.4390 0.4660  0.6737
Cf: [[2334   13]
 [  33   18]]
Valid loss:0.1057
Val metric mean prob: 0.2324
Best metric at: 0.4337 0.4290  0.6735
Cf: [[2333   14]
 [  33   18]]
Valid loss:0.0998
Val metric mean prob: 0.2219
Best metric at: 0.4348 0.3980  0.6916
Cf: [[2326   21]
 [  31   20]]
Valid loss:0.1000
Val metric mean prob: 0.2254
Best metric at: 0.4390 0.4520  0.6737
Cf: [[2334   13]
 [  33   18]]
Valid loss:0.1009
Val metric mean prob: 0.2309
Best metric at: 0.4598 0.3980  0.6927
Cf: [[2331   16]
 [  31   20]]
Valid loss:0.1151
Val metric mean prob: 0.2308
Best metric at: 0.4000 0.3930  0.6989
Cf: [[2314   33]
 [  30   21]]
Valid loss:0.1028
Val metric mean prob: 0.2341
Best metric at: 0.4468 0.4410  0.7012
Cf: [[2325   22]
 [  30   21]]
Valid loss:0.1007
Val metric mean prob: 0.2184
Best metric at: 0.4146 0.4700  0.6637
Cf: [[2333   14]
 [  34   17]]
Valid loss:0.1011
Val metric mean prob: 0.2286
Best metric at: 0.4368 0.4430  0.6827
Cf: [[2330   17]
 [  32   19]]
Valid loss:0.1053
Val metric mean prob: 0.2366
Best metric at: 0.4419 0.4370  0.6829
Cf: [[2331   16]
 [  32   19]]
Valid loss:0.0966
Val metric mean prob: 0.2200
Best metric at: 0.4545 0.3690  0.6925
Cf: [[2330   17]
 [  31   20]]
Valid loss:0.0972
Val metric mean prob: 0.2213
Best metric at: 0.4545 0.3680  0.6925
Cf: [[2330   17]
 [  31   20]]
Valid loss:0.0969
Val metric mean prob: 0.2207
Best metric at: 0.4545 0.3720  0.6925
Cf: [[2330   17]
 [  31   20]]
Valid loss:0.0983
Val metric mean prob: 0.2252
Best metric at: 0.4651 0.4050  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.0987
Val metric mean prob: 0.2260
Best metric at: 0.4444 0.4150  0.6739
Cf: [[2335   12]
 [  33   18]]
Valid loss:0.1004
Val metric mean prob: 0.2296
Best metric at: 0.4651 0.4040  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1006
Val metric mean prob: 0.2306
Best metric at: 0.4706 0.4310  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1006
Val metric mean prob: 0.2305
Best metric at: 0.4706 0.4330  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1006
Val metric mean prob: 0.2298
Best metric at: 0.4524 0.4360  0.6833
Cf: [[2333   14]
 [  32   19]]
Valid loss:0.0997
Val metric mean prob: 0.2271
Best metric at: 0.4390 0.4480  0.6737
Cf: [[2334   13]
 [  33   18]]
Valid loss:0.1006
Val metric mean prob: 0.2306
Best metric at: 0.4706 0.4310  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1006
Val metric mean prob: 0.2305
Best metric at: 0.4706 0.4290  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1015
Val metric mean prob: 0.2332
Best metric at: 0.4706 0.4330  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1002
Val metric mean prob: 0.2291
Best metric at: 0.4545 0.4180  0.6925
Cf: [[2330   17]
 [  31   20]]
Valid loss:0.1000
Val metric mean prob: 0.2294
Best metric at: 0.4706 0.4230  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1045
Val metric mean prob: 0.2369
Best metric at: 0.4471 0.4490  0.6831
Cf: [[2332   15]
 [  32   19]]
Valid loss:0.1018
Val metric mean prob: 0.2334
Best metric at: 0.4762 0.4430  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1000
Val metric mean prob: 0.2277
Best metric at: 0.4390 0.4530  0.6737
Cf: [[2334   13]
 [  33   18]]
Valid loss:0.1033
Val metric mean prob: 0.2335
Best metric at: 0.4471 0.4190  0.6831
Cf: [[2332   15]
 [  32   19]]
Valid loss:0.1086
Val metric mean prob: 0.2359
Best metric at: 0.4337 0.4650  0.6735
Cf: [[2333   14]
 [  33   18]]
Valid loss:0.1032
Val metric mean prob: 0.2356
Best metric at: 0.4500 0.4640  0.6741
Cf: [[2336   11]
 [  33   18]]
Valid loss:0.1011
Val metric mean prob: 0.2317
Best metric at: 0.4706 0.4400  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1009
Val metric mean prob: 0.2315
Best metric at: 0.4762 0.4360  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1018
Val metric mean prob: 0.2327
Best metric at: 0.4651 0.4190  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1015
Val metric mean prob: 0.2327
Best metric at: 0.4762 0.4420  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1037
Val metric mean prob: 0.2285
Best metric at: 0.4359 0.4200  0.6645
Cf: [[2337   10]
 [  34   17]]
Valid loss:0.1005
Val metric mean prob: 0.2311
Best metric at: 0.4706 0.4280  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.0998
Val metric mean prob: 0.2279
Best metric at: 0.4396 0.4040  0.6918
Cf: [[2327   20]
 [  31   20]]
Valid loss:0.0997
Val metric mean prob: 0.2260
Best metric at: 0.4419 0.4250  0.6829
Cf: [[2331   16]
 [  32   19]]
Valid loss:0.1003
Val metric mean prob: 0.2293
Best metric at: 0.4396 0.4110  0.6918
Cf: [[2327   20]
 [  31   20]]
Valid loss:0.1025
Val metric mean prob: 0.2345
Best metric at: 0.4634 0.4610  0.6837
Cf: [[2335   12]
 [  32   19]]
Valid loss:0.1013
Val metric mean prob: 0.2327
Best metric at: 0.4706 0.4370  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1017
Val metric mean prob: 0.2333
Best metric at: 0.4651 0.4460  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.0996
Val metric mean prob: 0.2259
Best metric at: 0.4337 0.4380  0.6735
Cf: [[2333   14]
 [  33   18]]
Valid loss:0.1004
Val metric mean prob: 0.2302
Best metric at: 0.4706 0.4290  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.0998
Val metric mean prob: 0.2295
Best metric at: 0.4691 0.4360  0.6839
Cf: [[2336   11]
 [  32   19]]
Valid loss:0.1002
Val metric mean prob: 0.2304
Best metric at: 0.4706 0.4240  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.0995
Val metric mean prob: 0.2276
Best metric at: 0.4444 0.4350  0.6739
Cf: [[2335   12]
 [  33   18]]
Valid loss:0.1008
Val metric mean prob: 0.2311
Best metric at: 0.4651 0.4330  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1067
Val metric mean prob: 0.2379
Best metric at: 0.4337 0.4720  0.6735
Cf: [[2333   14]
 [  33   18]]
Valid loss:0.1012
Val metric mean prob: 0.2320
Best metric at: 0.4706 0.4240  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1006
Val metric mean prob: 0.2313
Best metric at: 0.4762 0.4340  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1005
Val metric mean prob: 0.2307
Best metric at: 0.4762 0.4330  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1011
Val metric mean prob: 0.2319
Best metric at: 0.4706 0.4270  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1008
Val metric mean prob: 0.2315
Best metric at: 0.4706 0.4300  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1003
Val metric mean prob: 0.2302
Best metric at: 0.4706 0.4190  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1001
Val metric mean prob: 0.2294
Best metric at: 0.4598 0.4190  0.6927
Cf: [[2331   16]
 [  31   20]]
Valid loss:0.1018
Val metric mean prob: 0.2331
Best metric at: 0.4762 0.4420  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1029
Val metric mean prob: 0.2356
Best metric at: 0.4500 0.4640  0.6741
Cf: [[2336   11]
 [  33   18]]
Valid loss:0.1016
Val metric mean prob: 0.2328
Best metric at: 0.4762 0.4430  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1022
Val metric mean prob: 0.2333
Best metric at: 0.4598 0.4120  0.6927
Cf: [[2331   16]
 [  31   20]]
Valid loss:0.1017
Val metric mean prob: 0.2329
Best metric at: 0.4819 0.4440  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1027
Val metric mean prob: 0.2353
Best metric at: 0.4651 0.4320  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1015
Val metric mean prob: 0.2328
Best metric at: 0.4762 0.4420  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.0995
Val metric mean prob: 0.2275
Best metric at: 0.4444 0.4060  0.6920
Cf: [[2328   19]
 [  31   20]]
Valid loss:0.1007
Val metric mean prob: 0.2308
Best metric at: 0.4706 0.4350  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1037
Val metric mean prob: 0.2363
Best metric at: 0.4500 0.4660  0.6741
Cf: [[2336   11]
 [  33   18]]
Valid loss:0.1023
Val metric mean prob: 0.2348
Best metric at: 0.4651 0.4350  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1000
Val metric mean prob: 0.2287
Best metric at: 0.4545 0.4150  0.6925
Cf: [[2330   17]
 [  31   20]]
Valid loss:0.1000
Val metric mean prob: 0.2293
Best metric at: 0.4706 0.4220  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1025
Val metric mean prob: 0.2349
Best metric at: 0.4651 0.4380  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1009
Val metric mean prob: 0.2311
Best metric at: 0.4651 0.4360  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1015
Val metric mean prob: 0.2329
Best metric at: 0.4762 0.4430  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1010
Val metric mean prob: 0.2318
Best metric at: 0.4762 0.4380  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1005
Val metric mean prob: 0.2306
Best metric at: 0.4762 0.4340  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1039
Val metric mean prob: 0.2367
Best metric at: 0.4500 0.4690  0.6741
Cf: [[2336   11]
 [  33   18]]
Valid loss:0.1007
Val metric mean prob: 0.2306
Best metric at: 0.4598 0.4260  0.6927
Cf: [[2331   16]
 [  31   20]]
Valid loss:0.0994
Val metric mean prob: 0.2271
Best metric at: 0.4390 0.4380  0.6737
Cf: [[2334   13]
 [  33   18]]
Valid loss:0.1023
Val metric mean prob: 0.2346
Best metric at: 0.4819 0.4500  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1039
Val metric mean prob: 0.2363
Best metric at: 0.4471 0.4420  0.6831
Cf: [[2332   15]
 [  32   19]]
Valid loss:0.1025
Val metric mean prob: 0.2348
Best metric at: 0.4651 0.4390  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1027
Val metric mean prob: 0.2350
Best metric at: 0.4706 0.4510  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1012
Val metric mean prob: 0.2319
Best metric at: 0.4706 0.4410  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1011
Val metric mean prob: 0.2318
Best metric at: 0.4706 0.4250  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1012
Val metric mean prob: 0.2320
Best metric at: 0.4706 0.4340  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1011
Val metric mean prob: 0.2325
Best metric at: 0.4762 0.4370  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.0996
Val metric mean prob: 0.2278
Best metric at: 0.4444 0.4090  0.6920
Cf: [[2328   19]
 [  31   20]]
Valid loss:0.1025
Val metric mean prob: 0.2352
Best metric at: 0.4651 0.4370  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1006
Val metric mean prob: 0.2304
Best metric at: 0.4651 0.4310  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1018
Val metric mean prob: 0.2333
Best metric at: 0.4762 0.4450  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1038
Val metric mean prob: 0.2364
Best metric at: 0.4500 0.4680  0.6741
Cf: [[2336   11]
 [  33   18]]
Valid loss:0.1016
Val metric mean prob: 0.2330
Best metric at: 0.4819 0.4440  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1018
Val metric mean prob: 0.2336
Best metric at: 0.4819 0.4440  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1022
Val metric mean prob: 0.2344
Best metric at: 0.4706 0.4440  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1006
Val metric mean prob: 0.2306
Best metric at: 0.4706 0.4310  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1008
Val metric mean prob: 0.2311
Best metric at: 0.4598 0.4280  0.6927
Cf: [[2331   16]
 [  31   20]]
Valid loss:0.1039
Val metric mean prob: 0.2367
Best metric at: 0.4500 0.4690  0.6741
Cf: [[2336   11]
 [  33   18]]
Valid loss:0.1006
Val metric mean prob: 0.2312
Best metric at: 0.4706 0.4280  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1005
Val metric mean prob: 0.2304
Best metric at: 0.4651 0.4280  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1020
Val metric mean prob: 0.2339
Best metric at: 0.4819 0.4460  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1046
Val metric mean prob: 0.2367
Best metric at: 0.4471 0.4470  0.6831
Cf: [[2332   15]
 [  32   19]]
Valid loss:0.1018
Val metric mean prob: 0.2334
Best metric at: 0.4762 0.4430  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1026
Val metric mean prob: 0.2349
Best metric at: 0.4651 0.4430  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1020
Val metric mean prob: 0.2342
Best metric at: 0.4706 0.4410  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1033
Val metric mean prob: 0.2357
Best metric at: 0.4500 0.4640  0.6741
Cf: [[2336   11]
 [  33   18]]
Valid loss:0.1011
Val metric mean prob: 0.2317
Best metric at: 0.4706 0.4400  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1009
Val metric mean prob: 0.2310
Best metric at: 0.4598 0.4310  0.6927
Cf: [[2331   16]
 [  31   20]]
Valid loss:0.1012
Val metric mean prob: 0.2324
Best metric at: 0.4762 0.4400  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1014
Val metric mean prob: 0.2322
Best metric at: 0.4706 0.4310  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1016
Val metric mean prob: 0.2328
Best metric at: 0.4762 0.4420  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1022
Val metric mean prob: 0.2339
Best metric at: 0.4819 0.4500  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1019
Val metric mean prob: 0.2334
Best metric at: 0.4762 0.4440  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1027
Val metric mean prob: 0.2351
Best metric at: 0.4651 0.4440  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1010
Val metric mean prob: 0.2314
Best metric at: 0.4598 0.4320  0.6927
Cf: [[2331   16]
 [  31   20]]
Valid loss:0.1008
Val metric mean prob: 0.2307
Best metric at: 0.4706 0.4330  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1033
Val metric mean prob: 0.2360
Best metric at: 0.4500 0.4670  0.6741
Cf: [[2336   11]
 [  33   18]]
Valid loss:0.1009
Val metric mean prob: 0.2312
Best metric at: 0.4651 0.4340  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1023
Val metric mean prob: 0.2341
Best metric at: 0.4819 0.4470  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1011
Val metric mean prob: 0.2311
Best metric at: 0.4524 0.4450  0.6833
Cf: [[2333   14]
 [  32   19]]
Valid loss:0.1028
Val metric mean prob: 0.2354
Best metric at: 0.4819 0.4530  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1032
Val metric mean prob: 0.2359
Best metric at: 0.4634 0.4580  0.6837
Cf: [[2335   12]
 [  32   19]]
Valid loss:0.1026
Val metric mean prob: 0.2348
Best metric at: 0.4819 0.4500  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1017
Val metric mean prob: 0.2332
Best metric at: 0.4651 0.4460  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1024
Val metric mean prob: 0.2343
Best metric at: 0.4819 0.4510  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1023
Val metric mean prob: 0.2341
Best metric at: 0.4819 0.4540  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1017
Val metric mean prob: 0.2323
Best metric at: 0.4578 0.4560  0.6835
Cf: [[2334   13]
 [  32   19]]
Valid loss:0.1025
Val metric mean prob: 0.2347
Best metric at: 0.4819 0.4530  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1028
Val metric mean prob: 0.2354
Best metric at: 0.4819 0.4540  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1026
Val metric mean prob: 0.2350
Best metric at: 0.4819 0.4550  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1018
Val metric mean prob: 0.2324
Best metric at: 0.4524 0.4540  0.6833
Cf: [[2333   14]
 [  32   19]]
Valid loss:0.1019
Val metric mean prob: 0.2336
Best metric at: 0.4634 0.4550  0.6837
Cf: [[2335   12]
 [  32   19]]
Valid loss:0.1028
Val metric mean prob: 0.2352
Best metric at: 0.4819 0.4560  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1027
Val metric mean prob: 0.2350
Best metric at: 0.4819 0.4560  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1034
Val metric mean prob: 0.2362
Best metric at: 0.4634 0.4610  0.6837
Cf: [[2335   12]
 [  32   19]]
Valid loss:0.1020
Val metric mean prob: 0.2338
Best metric at: 0.4706 0.4500  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1035
Val metric mean prob: 0.2360
Best metric at: 0.4500 0.4690  0.6741
Cf: [[2336   11]
 [  33   18]]
Valid loss:0.1018
Val metric mean prob: 0.2325
Best metric at: 0.4578 0.4580  0.6835
Cf: [[2334   13]
 [  32   19]]
Valid loss:0.1009
Val metric mean prob: 0.2302
Best metric at: 0.4348 0.4170  0.6916
Cf: [[2326   21]
 [  31   20]]
Valid loss:0.1033
Val metric mean prob: 0.2359
Best metric at: 0.4634 0.4610  0.6837
Cf: [[2335   12]
 [  32   19]]
Valid loss:0.1041
Val metric mean prob: 0.2371
Best metric at: 0.4500 0.4710  0.6741
Cf: [[2336   11]
 [  33   18]]
Valid loss:0.1023
Val metric mean prob: 0.2342
Best metric at: 0.4819 0.4480  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1025
Val metric mean prob: 0.2346
Best metric at: 0.4819 0.4540  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1021
Val metric mean prob: 0.2337
Best metric at: 0.4651 0.4480  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1029
Val metric mean prob: 0.2354
Best metric at: 0.4819 0.4570  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1041
Val metric mean prob: 0.2371
Best metric at: 0.4524 0.4630  0.6833
Cf: [[2333   14]
 [  32   19]]
Valid loss:0.1029
Val metric mean prob: 0.2353
Best metric at: 0.4706 0.4530  0.6931
Cf: [[2333   14]
 [  31   20]]
Valid loss:0.1021
Val metric mean prob: 0.2338
Best metric at: 0.4634 0.4590  0.6837
Cf: [[2335   12]
 [  32   19]]
Valid loss:0.1046
Val metric mean prob: 0.2375
Best metric at: 0.4524 0.4660  0.6833
Cf: [[2333   14]
 [  32   19]]
Valid loss:0.1019
Val metric mean prob: 0.2336
Best metric at: 0.4762 0.4490  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1035
Val metric mean prob: 0.2362
Best metric at: 0.4578 0.4600  0.6835
Cf: [[2334   13]
 [  32   19]]
Valid loss:0.1015
Val metric mean prob: 0.2323
Best metric at: 0.4634 0.4510  0.6837
Cf: [[2335   12]
 [  32   19]]
Valid loss:0.1028
Val metric mean prob: 0.2353
Best metric at: 0.4819 0.4550  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1022
Val metric mean prob: 0.2343
Best metric at: 0.4819 0.4540  0.6935
Cf: [[2335   12]
 [  31   20]]
Valid loss:0.1036
Val metric mean prob: 0.2364
Best metric at: 0.4524 0.4590  0.6833
Cf: [[2333   14]
 [  32   19]]
Valid loss:0.1031
Val metric mean prob: 0.2354
Best metric at: 0.4634 0.4570  0.6837
Cf: [[2335   12]
 [  32   19]]
Valid loss:0.1028
Val metric mean prob: 0.2353
Best metric at: 0.4651 0.4430  0.6929
Cf: [[2332   15]
 [  31   20]]
Valid loss:0.1023
Val metric mean prob: 0.2342
Best metric at: 0.4762 0.4540  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1019
Val metric mean prob: 0.2334
Best metric at: 0.4762 0.4430  0.6933
Cf: [[2334   13]
 [  31   20]]
Valid loss:0.1017
Val metric mean prob: 0.2327
Best metric at: 0.4634 0.4540  0.6837
Cf: [[2335   12]
 [  32   19]]
Valid loss:0.1020
Val metric mean prob: 0.2328
Best metric at: 0.4524 0.4590  0.6833
Cf: [[2333   14]
 [  32   19]]
Date :02/18/2023, 05:39:55
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Warmup: 1
Epoch: 1/15
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/18/2023, 05:43:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/18/2023, 06:02:15
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/18/2023, 06:04:25
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 42
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2138, Valid loss:0.1012
Val metric mean prob: 0.0462
Best metric at epoch 1: 0.1593 0.0630  0.6461
Cf: [[4350  316]
 [  64   36]]
Model improve: 0.0000 -> 0.1593
Epoch: 2/15
Train loss:0.1521, Valid loss:0.0886
Val metric mean prob: 0.1314
Best metric at epoch 2: 0.3103 0.2430  0.6300
Cf: [[4619   47]
 [  73   27]]
Model improve: 0.1593 -> 0.3103
Epoch: 3/15
Train loss:0.1377, Valid loss:0.0922
Val metric mean prob: 0.1463
Best metric at epoch 3: 0.3373 0.3080  0.6359
Cf: [[4628   38]
 [  72   28]]
Model improve: 0.3103 -> 0.3373
Epoch: 4/15
Train loss:0.1259, Valid loss:0.0877
Val metric mean prob: 0.2067
Best metric at epoch 4: 0.4144 0.2490  0.7219
Cf: [[4590   76]
 [  54   46]]
Model improve: 0.3373 -> 0.4144
Epoch: 5/15
Train loss:0.1152, Valid loss:0.0892
Val metric mean prob: 0.2010
Best metric at epoch 5: 0.4249 0.3210  0.6994
Cf: [[4614   52]
 [  59   41]]
Model improve: 0.4144 -> 0.4249
Epoch: 6/15
Train loss:0.1015, Valid loss:0.0809
Val metric mean prob: 0.2115
Best metric at epoch 6: 0.4023 0.1680  0.6708
Cf: [[4627   39]
 [  65   35]]
Epoch: 7/15
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0649
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0649
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0649
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0649
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0649
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0649
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0649
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 500
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0649
Val metric mean prob: 0.6000
Best metric at epoch 1: 0.6000 0.0010  0.7477
Cf: [[215   1]
 [  3   3]]
Model improve: 0.0000 -> 0.6000
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Valid loss:0.0859
Val metric mean prob: 0.5190
Best metric at epoch 1: 0.5190 0.0010  0.7032
Cf: [[4649   17]
 [  59   41]]
Model improve: 0.0000 -> 0.5190
Epoch: 2/15
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamP (
Parameter Group 0
    betas: (0.9, 0.999)
    delta: 0.1
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0
    nesterov: False
    wd_ratio: 0.1
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2183, Valid loss:0.1114
Val metric mean prob: 0.0463
Best metric at epoch 1: 0.0938 0.1250  0.5644
Cf: [[4380  286]
 [  81   19]]
Model improve: 0.0000 -> 0.0938
Epoch: 2/15
Train loss:0.1562, Valid loss:0.0915
Val metric mean prob: 0.1242
Best metric at epoch 2: 0.2564 0.2240  0.6175
Cf: [[4596   70]
 [  75   25]]
Model improve: 0.0938 -> 0.2564
Epoch: 3/15
Train loss:0.1376, Valid loss:0.0941
Val metric mean prob: 0.1748
Best metric at epoch 3: 0.3529 0.4770  0.6187
Cf: [[4654   12]
 [  76   24]]
Model improve: 0.2564 -> 0.3529
Epoch: 4/15
Train loss:0.1268, Valid loss:0.0865
Val metric mean prob: 0.1892
Best metric at epoch 4: 0.3947 0.3380  0.6476
Cf: [[4644   22]
 [  70   30]]
Model improve: 0.3529 -> 0.3947
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Best metric at: 0.8743 0.0010  0.8997
Cf: [[4663    3]
 [  20   80]]
Best metric at: 0.6289 0.0010  0.7490
Cf: [[4657    9]
 [  50   50]]
Best metric at: 0.5035 0.0010  0.6792
Cf: [[4659    7]
 [  64   36]]
Best metric at: 0.5170 0.0010  0.6890
Cf: [[4657    9]
 [  62   38]]
Best metric at: 0.5035 0.0010  0.6792
Cf: [[4659    7]
 [  64   36]]
Best metric at: 0.7976 0.0010  0.8349
Cf: [[4665    1]
 [  33   67]]
Best metric at: 0.5000 0.0010  0.6791
Cf: [[4658    8]
 [  64   36]]
Best metric at: 0.5270 0.0010  0.6940
Cf: [[4657    9]
 [  61   39]]
Best metric at: 0.8743 0.0010  0.8997
Cf: [[4663    3]
 [  20   80]]
Best metric at: 0.6289 0.0010  0.7490
Cf: [[4657    9]
 [  50   50]]
Best metric at: 0.5035 0.0010  0.6792
Cf: [[4659    7]
 [  64   36]]
Best metric at: 0.5170 0.0010  0.6890
Cf: [[4657    9]
 [  62   38]]
Best metric at: 0.5035 0.0010  0.6792
Cf: [[4659    7]
 [  64   36]]
Best metric at: 0.7976 0.0010  0.8349
Cf: [[4665    1]
 [  33   67]]
Best metric at: 0.5000 0.0010  0.6791
Cf: [[4658    8]
 [  64   36]]
Best metric at: 0.5270 0.0010  0.6940
Cf: [[4657    9]
 [  61   39]]
Best metric at: 0.5270 0.0010  0.6940
Cf: [[4657    9]
 [  61   39]]
Best metric at: 0.5479 0.0010  0.6994
Cf: [[4660    6]
 [  60   40]]
Best metric at: 0.6923 0.0010  0.7698
Cf: [[4664    2]
 [  46   54]]
Best metric at: 0.9184 0.0010  0.9494
Cf: [[4660    6]
 [  10   90]]
Best metric at: 0.9140 0.0010  0.9249
Cf: [[4665    1]
 [  15   85]]
Best metric at: 0.9158 0.0010  0.9347
Cf: [[4663    3]
 [  13   87]]
Best metric at: 0.8743 0.0010  0.8997
Cf: [[4663    3]
 [  20   80]]
Best metric at: 0.6289 0.0010  0.7490
Cf: [[4657    9]
 [  50   50]]
Best metric at: 0.5035 0.0010  0.6792
Cf: [[4659    7]
 [  64   36]]
Best metric at: 0.5170 0.0010  0.6890
Cf: [[4657    9]
 [  62   38]]
Best metric at: 0.5035 0.0010  0.6792
Cf: [[4659    7]
 [  64   36]]
Best metric at: 0.7976 0.0010  0.8349
Cf: [[4665    1]
 [  33   67]]
Best metric at: 0.5000 0.0010  0.6791
Cf: [[4658    8]
 [  64   36]]
Best metric at: 0.5270 0.0010  0.6940
Cf: [[4657    9]
 [  61   39]]
Best metric at: 0.5270 0.0010  0.6940
Cf: [[4657    9]
 [  61   39]]
Best metric at: 0.5479 0.0010  0.6994
Cf: [[4660    6]
 [  60   40]]
Best metric at: 0.6923 0.0010  0.7698
Cf: [[4664    2]
 [  46   54]]
Best metric at: 0.9184 0.0010  0.9494
Cf: [[4660    6]
 [  10   90]]
Best metric at: 0.9140 0.0010  0.9249
Cf: [[4665    1]
 [  15   85]]
Best metric at: 0.9158 0.0010  0.9347
Cf: [[4663    3]
 [  13   87]]
Best metric at: 0.8715 0.0010  0.8899
Cf: [[4665    1]
 [  22   78]]
Best metric at: 0.9081 0.0010  0.9199
Cf: [[4665    1]
 [  16   84]]
Best metric at: 0.8000 0.0010  0.8398
Cf: [[4664    2]
 [  32   68]]
Best metric at: 0.7375 0.0010  0.7949
Cf: [[4665    1]
 [  41   59]]
Best metric at: 0.9184 0.0010  0.9494
Cf: [[4660    6]
 [  10   90]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9082 0.0010  0.9442
Cf: [[4659    7]
 [  11   89]]
Best metric at: 0.9184 0.0010  0.9494
Cf: [[4660    6]
 [  10   90]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9146 0.0010  0.9541
Cf: [[4658    8]
 [   9   91]]
Best metric at: 0.9216 0.0010  0.9689
Cf: [[4656   10]
 [   6   94]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9216 0.0010  0.9689
Cf: [[4656   10]
 [   6   94]]
Best metric at: 0.9171 0.0010  0.9688
Cf: [[4655   11]
 [   6   94]]
Best metric at: 0.8934 0.0010  0.9390
Cf: [[4657    9]
 [  12   88]]
Best metric at: 0.9184 0.0010  0.9494
Cf: [[4660    6]
 [  10   90]]
Best metric at: 0.9171 0.0010  0.9688
Cf: [[4655   11]
 [   6   94]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9192 0.0010  0.9542
Cf: [[4659    7]
 [   9   91]]
Best metric at: 0.9192 0.0010  0.9542
Cf: [[4659    7]
 [   9   91]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9109 0.0010  0.9589
Cf: [[4656   10]
 [   8   92]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9167 0.0010  0.9396
Cf: [[4662    4]
 [  12   88]]
Best metric at: 0.9216 0.0010  0.9689
Cf: [[4656   10]
 [   6   94]]
Best metric at: 0.8995 0.0010  0.9246
Cf: [[4662    4]
 [  15   85]]
Best metric at: 0.8889 0.0010  0.9389
Cf: [[4656   10]
 [  12   88]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.8617 0.0010  0.9042
Cf: [[4659    7]
 [  19   81]]
Best metric at: 0.7765 0.0010  0.8296
Cf: [[4662    4]
 [  34   66]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9216 0.0010  0.9689
Cf: [[4656   10]
 [   6   94]]
Best metric at: 0.9171 0.0010  0.9688
Cf: [[4655   11]
 [   6   94]]
Best metric at: 0.8571 0.0010  0.9187
Cf: [[4654   12]
 [  16   84]]
Best metric at: 0.9109 0.0010  0.9589
Cf: [[4656   10]
 [   8   92]]
Best metric at: 0.9126 0.0010  0.9687
Cf: [[4654   12]
 [   6   94]]
Best metric at: 0.9146 0.0010  0.9541
Cf: [[4658    8]
 [   9   91]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9163 0.0010  0.9639
Cf: [[4656   10]
 [   7   93]]
Best metric at: 0.9192 0.0010  0.9542
Cf: [[4659    7]
 [   9   91]]
Best metric at: 0.9091 0.0010  0.9491
Cf: [[4658    8]
 [  10   90]]
Best metric at: 0.9072 0.0010  0.9394
Cf: [[4660    6]
 [  12   88]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9216 0.0010  0.9689
Cf: [[4656   10]
 [   6   94]]
Best metric at: 0.9216 0.0010  0.9689
Cf: [[4656   10]
 [   6   94]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9184 0.0010  0.9494
Cf: [[4660    6]
 [  10   90]]
Best metric at: 0.9216 0.0010  0.9689
Cf: [[4656   10]
 [   6   94]]
Best metric at: 0.9154 0.0010  0.9590
Cf: [[4657    9]
 [   8   92]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9192 0.0010  0.9542
Cf: [[4659    7]
 [   9   91]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9163 0.0010  0.9639
Cf: [[4656   10]
 [   7   93]]
Best metric at: 0.9184 0.0010  0.9494
Cf: [[4660    6]
 [  10   90]]
Best metric at: 0.9175 0.0010  0.9445
Cf: [[4661    5]
 [  11   89]]
Best metric at: 0.9192 0.0010  0.9542
Cf: [[4659    7]
 [   9   91]]
Best metric at: 0.9163 0.0010  0.9639
Cf: [[4656   10]
 [   7   93]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9192 0.0010  0.9542
Cf: [[4659    7]
 [   9   91]]
Best metric at: 0.9184 0.0010  0.9494
Cf: [[4660    6]
 [  10   90]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9216 0.0010  0.9689
Cf: [[4656   10]
 [   6   94]]
Best metric at: 0.9163 0.0010  0.9639
Cf: [[4656   10]
 [   7   93]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9154 0.0010  0.9590
Cf: [[4657    9]
 [   8   92]]
Best metric at: 0.5109 0.0010  0.6748
Cf: [[4664    2]
 [  65   35]]
Best metric at: 0.9055 0.0010  0.9539
Cf: [[4656   10]
 [   9   91]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9154 0.0010  0.9590
Cf: [[4657    9]
 [   8   92]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9216 0.0010  0.9689
Cf: [[4656   10]
 [   6   94]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9171 0.0010  0.9688
Cf: [[4655   11]
 [   6   94]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9146 0.0010  0.9541
Cf: [[4658    8]
 [   9   91]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9171 0.0010  0.9688
Cf: [[4655   11]
 [   6   94]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9137 0.0010  0.9492
Cf: [[4659    7]
 [  10   90]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9118 0.0010  0.9638
Cf: [[4655   11]
 [   7   93]]
Best metric at: 0.9216 0.0010  0.9689
Cf: [[4656   10]
 [   6   94]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9154 0.0010  0.9590
Cf: [[4657    9]
 [   8   92]]
Best metric at: 0.9192 0.0010  0.9542
Cf: [[4659    7]
 [   9   91]]
Best metric at: 0.9208 0.0010  0.9640
Cf: [[4657    9]
 [   7   93]]
Best metric at: 0.9154 0.0010  0.9590
Cf: [[4657    9]
 [   8   92]]
Best metric at: 0.9163 0.0010  0.9639
Cf: [[4656   10]
 [   7   93]]
Best metric at: 0.9126 0.0010  0.9687
Cf: [[4654   12]
 [   6   94]]
Best metric at: 0.9163 0.0010  0.9639
Cf: [[4656   10]
 [   7   93]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.9200 0.0010  0.9591
Cf: [[4658    8]
 [   8   92]]
Best metric at: 0.6452 0.0010  0.7495
Cf: [[4661    5]
 [  50   50]]
Best metric at: 0.9062 0.0010  0.9345
Cf: [[4661    5]
 [  13   87]]
Best metric at: 0.8877 0.0010  0.9146
Cf: [[4662    4]
 [  17   83]]
Best metric at: 0.7886 0.0010  0.8444
Cf: [[4660    6]
 [  31   69]]
Best metric at: 0.9137 0.0010  0.9492
Cf: [[4659    7]
 [  10   90]]
Best metric at: 0.9192 0.0010  0.9542
Cf: [[4659    7]
 [   9   91]]
Best metric at: 0.9154 0.0010  0.9590
Cf: [[4657    9]
 [   8   92]]
Best metric at: 0.9163 0.0010  0.9639
Cf: [[4656   10]
 [   7   93]]
Best metric at: 0.9192 0.0010  0.9542
Cf: [[4659    7]
 [   9   91]]
Best metric at: 0.9192 0.0010  0.9542
Cf: [[4659    7]
 [   9   91]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.8743 0.0010  0.8997
Cf: [[4663    3]
 [  20   80]]
Best metric at: 0.6289 0.0010  0.7490
Cf: [[4657    9]
 [  50   50]]
Best metric at: 0.5035 0.0010  0.6792
Cf: [[4659    7]
 [  64   36]]
Best metric at: 0.5170 0.0010  0.6890
Cf: [[4657    9]
 [  62   38]]
Best metric at: 0.5035 0.0010  0.6792
Cf: [[4659    7]
 [  64   36]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0187 0.0010  0.5044
Cf: [[4660    6]
 [  99    1]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0196 0.0010  0.5049
Cf: [[4665    1]
 [  99    1]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0179 0.0010  0.5038
Cf: [[4655   11]
 [  99    1]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0190 0.0010  0.5046
Cf: [[4662    4]
 [  99    1]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0189 0.0010  0.5045
Cf: [[4661    5]
 [  99    1]]
Best metric at: 0.0189 0.0010  0.5045
Cf: [[4661    5]
 [  99    1]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0189 0.0010  0.5045
Cf: [[4661    5]
 [  99    1]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0183 0.0010  0.5041
Cf: [[4658    8]
 [  99    1]]
Best metric at: 0.0185 0.0010  0.5042
Cf: [[4659    7]
 [  99    1]]
Best metric at: 0.0192 0.0010  0.5047
Cf: [[4663    3]
 [  99    1]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0187 0.0010  0.5044
Cf: [[4660    6]
 [  99    1]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0196 0.0010  0.5049
Cf: [[4665    1]
 [  99    1]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0179 0.0010  0.5038
Cf: [[4655   11]
 [  99    1]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0190 0.0010  0.5046
Cf: [[4662    4]
 [  99    1]]
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
Best metric at: 0.0000 0.0000  0.0000
Cf: 0
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelCVN
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/18/2023, 15:14:20
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelCVN
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelCVN
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2023, Valid loss:0.1148
Val metric mean prob: 0.0318
Best metric at epoch 1: 0.0607 0.0630  0.5438
Cf: [[4095  571]
 [  79   21]]
Model improve: 0.0000 -> 0.0607
Epoch: 2/15
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Epoch: 2/15
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 44603
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Epoch: 2/15
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 44603
Len valid df: 11012
Train bs: 16
ModelCVN
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/18/2023, 16:40:02
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 44603
Len valid df: 11012
Train bs: 16
ModelCVN
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelCVN
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/18/2023, 16:40:45
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelCVN
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2031, Valid loss:0.1036
Val metric mean prob: 0.0226
Best metric at epoch 1: 0.0554 0.0280  0.5269
Cf: [[4273  389]
 [  88   14]]
Model improve: 0.0000 -> 0.0554
Epoch: 2/15
Train loss:0.1754, Valid loss:0.1166
Val metric mean prob: 0.0309
Best metric at epoch 2: 0.0524 0.0580  0.5155
Cf: [[4578   84]
 [  97    5]]
Epoch: 3/15
Train loss:0.1742, Valid loss:0.1091
Val metric mean prob: 0.0285
Best metric at epoch 3: 0.0505 0.0430  0.5446
Cf: [[3067 1595]
 [  58   44]]
Epoch: 4/15
Train loss:0.1739, Valid loss:0.1070
Val metric mean prob: 0.0281
Best metric at epoch 4: 0.0670 0.0450  0.5218
Cf: [[4591   71]
 [  96    6]]
Model improve: 0.0554 -> 0.0670
Epoch: 5/15
Train loss:0.1734, Valid loss:0.1089
Val metric mean prob: 0.0293
Best metric at epoch 5: 0.0505 0.0420  0.5628
Cf: [[2140 2522]
 [  34   68]]
Epoch: 6/15
Train loss:0.1727, Valid loss:0.1087
Val metric mean prob: 0.0304
Best metric at epoch 6: 0.0575 0.0690  0.5173
Cf: [[4595   67]
 [  97    5]]
Epoch: 7/15
Train loss:0.1720, Valid loss:0.1060
Val metric mean prob: 0.0283
Best metric at epoch 7: 0.0602 0.0530  0.5167
Cf: [[4635   27]
 [  98    4]]
Epoch: 8/15
Date :02/18/2023, 23:17:58
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelCVN
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.01
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/18/2023, 23:37:33
Date :02/18/2023, 23:37:56
Date :02/18/2023, 23:37:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-20, 20), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-20, 20), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
seed: 1
5 fold
5 fold
Fold: 0
Fold: 0
Model name: tf_efficientnetv2_b2
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len train df: 44652
Len valid df: 10979
Len valid df: 10979
Train bs: 16
Train bs: 16
ModelOld
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
total_epoch :15
Warmup: 1
Warmup: 1
Epoch: 1/15
Epoch: 1/15
Date :02/18/2023, 23:38:25
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-20, 20), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2183, Valid loss:0.1099
Val metric mean prob: 0.0431
Best metric at epoch 1: 0.1142 0.1080  0.5915
Cf: [[4353  313]
 [  75   25]]
Model improve: 0.0000 -> 0.1142
Epoch: 2/15
Train loss:0.1606, Valid loss:0.0882
Val metric mean prob: 0.0772
Best metric at epoch 2: 0.2447 0.0930  0.6080
Cf: [[4601   65]
 [  77   23]]
Model improve: 0.1142 -> 0.2447
Epoch: 3/15
Train loss:0.1442, Valid loss:0.1079
Val metric mean prob: 0.1721
Best metric at epoch 3: 0.4000 0.4770  0.6570
Cf: [[4638   28]
 [  68   32]]
Model improve: 0.2447 -> 0.4000
Epoch: 4/15
Train loss:0.1326, Valid loss:0.0812
Val metric mean prob: 0.1888
Best metric at epoch 4: 0.4049 0.2370  0.6618
Cf: [[4636   30]
 [  67   33]]
Model improve: 0.4000 -> 0.4049
Epoch: 5/15
Train loss:0.1237, Valid loss:0.0820
Val metric mean prob: 0.2119
Best metric at epoch 5: 0.3925 0.2240  0.7023
Cf: [[4594   72]
 [  58   42]]
Epoch: 6/15
Train loss:0.1154, Valid loss:0.0830
Val metric mean prob: 0.2113
Best metric at epoch 6: 0.4028 0.2280  0.6434
Cf: [[4651   15]
 [  71   29]]
Epoch: 7/15
Train loss:0.1100, Valid loss:0.0857
Val metric mean prob: 0.2272
Best metric at epoch 7: 0.4267 0.3570  0.6581
Cf: [[4648   18]
 [  68   32]]
Model improve: 0.4049 -> 0.4267
Epoch: 8/15
Train loss:0.0997, Valid loss:0.0895
Val metric mean prob: 0.2568
Best metric at epoch 8: 0.4658 0.4810  0.6687
Cf: [[4654   12]
 [  66   34]]
Model improve: 0.4267 -> 0.4658
Epoch: 9/15
Train loss:0.0920, Valid loss:0.0897
Val metric mean prob: 0.2675
Best metric at epoch 9: 0.4272 0.1860  0.7134
Cf: [[4604   62]
 [  56   44]]
Epoch: 10/15
Train loss:0.0821, Valid loss:0.0892
Val metric mean prob: 0.2758
Best metric at epoch 10: 0.4331 0.3870  0.6675
Cf: [[4643   23]
 [  66   34]]
Epoch: 11/15
Train loss:0.0788, Valid loss:0.0911
Val metric mean prob: 0.2710
Best metric at epoch 11: 0.4540 0.3960  0.6822
Cf: [[4640   26]
 [  63   37]]
Epoch: 12/15
Train loss:0.0716, Valid loss:0.0922
Val metric mean prob: 0.2815
Best metric at epoch 12: 0.4474 0.3940  0.6681
Cf: [[4648   18]
 [  66   34]]
Epoch: 13/15
Train loss:0.0673, Valid loss:0.0977
Val metric mean prob: 0.2822
Best metric at epoch 13: 0.4387 0.4060  0.6677
Cf: [[4645   21]
 [  66   34]]
Epoch: 14/15
Train loss:0.0648, Valid loss:0.0969
Val metric mean prob: 0.2847
Best metric at epoch 14: 0.4368 0.3070  0.6861
Cf: [[4630   36]
 [  62   38]]
Epoch: 15/15
Valid loss:0.0894
Val metric mean prob: 0.2877
Best metric at: 0.4744 0.4130  0.6830
Cf: [[4647   19]
 [  63   37]]
Valid loss:0.0894
Val metric mean prob: 0.2877
Best metric at: 0.4744 0.4130  0.6830
Cf: [[4647   19]
 [  63   37]]
Valid loss:0.0900
Val metric mean prob: 0.2842
Best metric at: 0.4588 0.3610  0.6917
Cf: [[4635   31]
 [  61   39]]
Valid loss:0.0878
Val metric mean prob: 0.2697
Best metric at: 0.4588 0.3920  0.6917
Cf: [[4635   31]
 [  61   39]]
Valid loss:0.0873
Val metric mean prob: 0.2759
Best metric at: 0.4643 0.3940  0.6919
Cf: [[4637   29]
 [  61   39]]
Valid loss:0.0881
Val metric mean prob: 0.2862
Best metric at: 0.4841 0.4220  0.6880
Cf: [[4647   19]
 [  62   38]]
Valid loss:0.0905
Val metric mean prob: 0.2865
Best metric at: 0.4565 0.3120  0.7055
Cf: [[4624   42]
 [  58   42]]
Valid loss:0.0876
Val metric mean prob: 0.2825
Best metric at: 0.4663 0.4110  0.6873
Cf: [[4641   25]
 [  62   38]]
Valid loss:0.0893
Val metric mean prob: 0.2585
Best metric at: 0.4626 0.4800  0.6686
Cf: [[4653   13]
 [  66   34]]
Valid loss:0.0874
Val metric mean prob: 0.2784
Best metric at: 0.4634 0.4110  0.6872
Cf: [[4640   26]
 [  62   38]]
Valid loss:0.0884
Val metric mean prob: 0.2885
Best metric at: 0.4810 0.4230  0.6879
Cf: [[4646   20]
 [  62   38]]
Date :02/19/2023, 08:25:58
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-20, 20), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Valid loss:0.0918
Val metric mean prob: 0.2917
Best metric at: 0.4512 0.3870  0.6821
Cf: [[4639   27]
 [  63   37]]
Valid loss:0.0878
Val metric mean prob: 0.2697
Best metric at: 0.4588 0.3920  0.6917
Cf: [[4635   31]
 [  61   39]]
Valid loss:0.0889
Val metric mean prob: 0.2886
Best metric at: 0.4780 0.4190  0.6877
Cf: [[4645   21]
 [  62   38]]
Valid loss:0.0876
Val metric mean prob: 0.2826
Best metric at: 0.4663 0.4110  0.6873
Cf: [[4641   25]
 [  62   38]]
Valid loss:0.0876
Val metric mean prob: 0.2799
Best metric at: 0.4658 0.4820  0.6687
Cf: [[4654   12]
 [  66   34]]
Valid loss:0.0905
Val metric mean prob: 0.2929
Best metric at: 0.4727 0.3910  0.6922
Cf: [[4640   26]
 [  61   39]]
Valid loss:0.0870
Val metric mean prob: 0.2804
Best metric at: 0.4675 0.4500  0.6781
Cf: [[4648   18]
 [  64   36]]
Valid loss:0.0889
Val metric mean prob: 0.2836
Best metric at: 0.4654 0.4150  0.6826
Cf: [[4644   22]
 [  63   37]]
Valid loss:0.0875
Val metric mean prob: 0.2855
Best metric at: 0.4720 0.4120  0.6875
Cf: [[4643   23]
 [  62   38]]
Valid loss:0.0870
Val metric mean prob: 0.2823
Best metric at: 0.4706 0.4560  0.6782
Cf: [[4649   17]
 [  64   36]]
Valid loss:0.0971
Val metric mean prob: 0.2844
Best metric at: 0.4444 0.4110  0.6680
Cf: [[4647   19]
 [  66   34]]
Valid loss:0.0877
Val metric mean prob: 0.2871
Best metric at: 0.4713 0.4430  0.6829
Cf: [[4646   20]
 [  63   37]]
Valid loss:0.0960
Val metric mean prob: 0.2860
Best metric at: 0.4444 0.4170  0.6680
Cf: [[4647   19]
 [  66   34]]
Valid loss:0.0904
Val metric mean prob: 0.2883
Best metric at: 0.4720 0.3750  0.6875
Cf: [[4643   23]
 [  62   38]]
Valid loss:0.0925
Val metric mean prob: 0.2946
Best metric at: 0.4625 0.4020  0.6825
Cf: [[4643   23]
 [  63   37]]
Valid loss:0.0968
Val metric mean prob: 0.2850
Best metric at: 0.4416 0.4080  0.6679
Cf: [[4646   20]
 [  66   34]]
Valid loss:0.0908
Val metric mean prob: 0.2900
Best metric at: 0.4663 0.4050  0.6873
Cf: [[4641   25]
 [  62   38]]
Valid loss:0.0945
Val metric mean prob: 0.2854
Best metric at: 0.4459 0.4300  0.6634
Cf: [[4651   15]
 [  67   33]]
Valid loss:0.0851
Val metric mean prob: 0.2867
Best metric at: 0.5026 0.3210  0.7354
Cf: [[4623   43]
 [  52   48]]
Valid loss:0.0819
Val metric mean prob: 0.2490
Best metric at: 0.4880 0.2550  0.7488
Cf: [[4608   58]
 [  49   51]]
Valid loss:0.0851
Val metric mean prob: 0.2866
Best metric at: 0.5053 0.3230  0.7355
Cf: [[4624   42]
 [  52   48]]
Valid loss:0.0819
Val metric mean prob: 0.2490
Best metric at: 0.4880 0.2560  0.7488
Cf: [[4608   58]
 [  49   51]]
Valid loss:0.0796
Val metric mean prob: 0.2426
Best metric at: 0.4785 0.2340  0.7437
Cf: [[4607   59]
 [  50   50]]
Valid loss:0.0826
Val metric mean prob: 0.2725
Best metric at: 0.4889 0.3450  0.7161
Cf: [[4630   36]
 [  56   44]]
Valid loss:0.0825
Val metric mean prob: 0.2568
Best metric at: 0.4785 0.2620  0.7437
Cf: [[4607   59]
 [  50   50]]
Valid loss:0.0839
Val metric mean prob: 0.2776
Best metric at: 0.4792 0.3210  0.7251
Cf: [[4620   46]
 [  54   46]]
Valid loss:0.0832
Val metric mean prob: 0.2630
Best metric at: 0.4800 0.3580  0.7065
Cf: [[4633   33]
 [  58   42]]
Valid loss:0.0800
Val metric mean prob: 0.2415
Best metric at: 0.4929 0.2360  0.7537
Cf: [[4607   59]
 [  48   52]]
Valid loss:0.0841
Val metric mean prob: 0.2699
Best metric at: 0.4862 0.3530  0.7160
Cf: [[4629   37]
 [  56   44]]
Valid loss:0.0815
Val metric mean prob: 0.2657
Best metric at: 0.4831 0.3240  0.7112
Cf: [[4631   35]
 [  57   43]]
Valid loss:0.0806
Val metric mean prob: 0.2646
Best metric at: 0.5000 0.2550  0.7212
Cf: [[4631   35]
 [  55   45]]
Valid loss:0.0843
Val metric mean prob: 0.2665
Best metric at: 0.4855 0.3390  0.7067
Cf: [[4635   31]
 [  58   42]]
Valid loss:0.0845
Val metric mean prob: 0.2656
Best metric at: 0.4677 0.3010  0.7292
Cf: [[4612   54]
 [  53   47]]
Valid loss:0.0882
Val metric mean prob: 0.2523
Best metric at: 0.4588 0.3280  0.6917
Cf: [[4635   31]
 [  61   39]]
Valid loss:0.0842
Val metric mean prob: 0.2779
Best metric at: 0.5153 0.3700  0.7077
Cf: [[4645   21]
 [  58   42]]
Valid loss:0.0874
Val metric mean prob: 0.2606
Best metric at: 0.4767 0.3260  0.7017
Cf: [[4635   31]
 [  59   41]]
Valid loss:0.0849
Val metric mean prob: 0.2804
Best metric at: 0.4971 0.3630  0.7118
Cf: [[4636   30]
 [  57   43]]
Valid loss:0.0816
Val metric mean prob: 0.2564
Best metric at: 0.4943 0.3210  0.7117
Cf: [[4635   31]
 [  57   43]]
Valid loss:0.0872
Val metric mean prob: 0.2738
Best metric at: 0.5030 0.3550  0.7073
Cf: [[4641   25]
 [  58   42]]
Valid loss:0.0904
Val metric mean prob: 0.2944
Best metric at: 0.4940 0.3900  0.7023
Cf: [[4641   25]
 [  59   41]]
Valid loss:0.0810
Val metric mean prob: 0.2488
Best metric at: 0.4851 0.2650  0.7393
Cf: [[4613   53]
 [  51   49]]
Valid loss:0.0895
Val metric mean prob: 0.2873
Best metric at: 0.4881 0.3830  0.7021
Cf: [[4639   27]
 [  59   41]]
Valid loss:0.0883
Val metric mean prob: 0.2817
Best metric at: 0.5116 0.3390  0.7170
Cf: [[4638   28]
 [  56   44]]
Valid loss:0.0891
Val metric mean prob: 0.2885
Best metric at: 0.4940 0.3690  0.7023
Cf: [[4641   25]
 [  59   41]]
Valid loss:0.0883
Val metric mean prob: 0.2918
Best metric at: 0.5031 0.3820  0.7026
Cf: [[4644   22]
 [  59   41]]
Valid loss:0.0931
Val metric mean prob: 0.3041
Best metric at: 0.4757 0.2620  0.7389
Cf: [[4609   57]
 [  51   49]]
Valid loss:0.0829
Val metric mean prob: 0.2596
Best metric at: 0.4756 0.2550  0.6923
Cf: [[4641   25]
 [  61   39]]
Valid loss:0.0830
Val metric mean prob: 0.2660
Best metric at: 0.4891 0.2820  0.7208
Cf: [[4627   39]
 [  55   45]]
Valid loss:0.0880
Val metric mean prob: 0.2850
Best metric at: 0.5146 0.3490  0.7171
Cf: [[4639   27]
 [  56   44]]
Valid loss:0.0889
Val metric mean prob: 0.2883
Best metric at: 0.4970 0.3820  0.7024
Cf: [[4642   24]
 [  59   41]]
Valid loss:0.0873
Val metric mean prob: 0.2834
Best metric at: 0.5176 0.3510  0.7172
Cf: [[4640   26]
 [  56   44]]
Valid loss:0.0879
Val metric mean prob: 0.2888
Best metric at: 0.5176 0.3460  0.7172
Cf: [[4640   26]
 [  56   44]]
Valid loss:0.0879
Val metric mean prob: 0.2909
Best metric at: 0.5031 0.3840  0.7026
Cf: [[4644   22]
 [  59   41]]
Valid loss:0.0871
Val metric mean prob: 0.2918
Best metric at: 0.5031 0.3710  0.7026
Cf: [[4644   22]
 [  59   41]]
Valid loss:0.0839
Val metric mean prob: 0.2743
Best metric at: 0.4938 0.3100  0.6976
Cf: [[4644   22]
 [  60   40]]
Valid loss:0.0865
Val metric mean prob: 0.2884
Best metric at: 0.5062 0.3980  0.7027
Cf: [[4645   21]
 [  59   41]]
Valid loss:0.0887
Val metric mean prob: 0.2950
Best metric at: 0.5030 0.3700  0.7073
Cf: [[4641   25]
 [  58   42]]
Valid loss:0.0864
Val metric mean prob: 0.2873
Best metric at: 0.5030 0.3520  0.7073
Cf: [[4641   25]
 [  58   42]]
Valid loss:0.0872
Val metric mean prob: 0.2893
Best metric at: 0.5060 0.3740  0.7074
Cf: [[4642   24]
 [  58   42]]
Valid loss:0.0940
Val metric mean prob: 0.3026
Best metric at: 0.4824 0.3540  0.7019
Cf: [[4637   29]
 [  59   41]]
Valid loss:0.0894
Val metric mean prob: 0.2904
Best metric at: 0.5000 0.3840  0.7025
Cf: [[4643   23]
 [  59   41]]
Valid loss:0.0879
Val metric mean prob: 0.2850
Best metric at: 0.5146 0.3490  0.7171
Cf: [[4639   27]
 [  56   44]]
Valid loss:0.0909
Val metric mean prob: 0.2877
Best metric at: 0.4785 0.3980  0.6924
Cf: [[4642   24]
 [  61   39]]
Valid loss:0.0884
Val metric mean prob: 0.2853
Best metric at: 0.5176 0.3640  0.7172
Cf: [[4640   26]
 [  56   44]]
Valid loss:0.0873
Val metric mean prob: 0.2885
Best metric at: 0.5029 0.3430  0.7167
Cf: [[4635   31]
 [  56   44]]
Valid loss:0.0966
Val metric mean prob: 0.3034
Best metric at: 0.4615 0.2730  0.7196
Cf: [[4616   50]
 [  55   45]]
Valid loss:0.0893
Val metric mean prob: 0.2954
Best metric at: 0.4941 0.3480  0.7070
Cf: [[4638   28]
 [  58   42]]
Valid loss:0.0889
Val metric mean prob: 0.2976
Best metric at: 0.4910 0.3560  0.7022
Cf: [[4640   26]
 [  59   41]]
Valid loss:0.0860
Val metric mean prob: 0.2753
Best metric at: 0.4859 0.3860  0.7114
Cf: [[4632   34]
 [  57   43]]
Valid loss:0.0814
Val metric mean prob: 0.2395
Best metric at: 0.4840 0.2270  0.7579
Cf: [[4600   66]
 [  47   53]]
Valid loss:0.0844
Val metric mean prob: 0.2746
Best metric at: 0.4859 0.3700  0.7114
Cf: [[4632   34]
 [  57   43]]
Valid loss:0.0796
Val metric mean prob: 0.2428
Best metric at: 0.4785 0.2340  0.7437
Cf: [[4607   59]
 [  50   50]]
Valid loss:0.0808
Val metric mean prob: 0.2481
Best metric at: 0.4885 0.2380  0.7581
Cf: [[4602   64]
 [  47   53]]
Valid loss:0.0838
Val metric mean prob: 0.2714
Best metric at: 0.4795 0.3970  0.7018
Cf: [[4636   30]
 [  59   41]]
Valid loss:0.0826
Val metric mean prob: 0.2570
Best metric at: 0.4739 0.2570  0.7435
Cf: [[4605   61]
 [  50   50]]
Date :02/19/2023, 13:01:54
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-20, 20), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Date :02/19/2023, 13:05:25
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-20, 20), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=204, max_w_size=204),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Valid loss:0.0894
Val metric mean prob: 0.2875
Best metric at: 0.4744 0.4100  0.6830
Cf: [[4647   19]
 [  63   37]]
Valid loss:0.0894
Val metric mean prob: 0.2875
Best metric at: 0.4744 0.4100  0.6830
Cf: [[4647   19]
 [  63   37]]
Valid loss:0.0901
Val metric mean prob: 0.2837
Best metric at: 0.4588 0.3610  0.6917
Cf: [[4635   31]
 [  61   39]]
Valid loss:0.0878
Val metric mean prob: 0.2698
Best metric at: 0.4588 0.3920  0.6917
Cf: [[4635   31]
 [  61   39]]
Valid loss:0.0873
Val metric mean prob: 0.2760
Best metric at: 0.4626 0.4820  0.6686
Cf: [[4653   13]
 [  66   34]]
Valid loss:0.0881
Val metric mean prob: 0.2862
Best metric at: 0.4841 0.4220  0.6880
Cf: [[4647   19]
 [  62   38]]
Valid loss:0.0866
Val metric mean prob: 0.2926
Best metric at: 0.4941 0.3870  0.7070
Cf: [[4638   28]
 [  58   42]]
Valid loss:0.0858
Val metric mean prob: 0.2851
Best metric at: 0.4912 0.3970  0.7069
Cf: [[4637   29]
 [  58   42]]
Valid loss:0.0873
Val metric mean prob: 0.2919
Best metric at: 0.4932 0.4860  0.6789
Cf: [[4656   10]
 [  64   36]]
Valid loss:0.0847
Val metric mean prob: 0.2781
Best metric at: 0.4972 0.3620  0.7211
Cf: [[4630   36]
 [  55   45]]
Valid loss:0.0838
Val metric mean prob: 0.2797
Best metric at: 0.5055 0.3220  0.7261
Cf: [[4630   36]
 [  54   46]]
Valid loss:0.0847
Val metric mean prob: 0.2805
Best metric at: 0.5150 0.3610  0.7124
Cf: [[4642   24]
 [  57   43]]
Valid loss:0.0854
Val metric mean prob: 0.2805
Best metric at: 0.5238 0.3560  0.7174
Cf: [[4642   24]
 [  56   44]]
Valid loss:0.0857
Val metric mean prob: 0.2905
Best metric at: 0.5000 0.3910  0.6979
Cf: [[4646   20]
 [  60   40]]
Valid loss:0.0857
Val metric mean prob: 0.2905
Best metric at: 0.5000 0.3910  0.6979
Cf: [[4646   20]
 [  60   40]]
Valid loss:0.0806
Val metric mean prob: 0.2305
Best metric at: 0.4811 0.2190  0.7485
Cf: [[4605   61]
 [  49   51]]
Valid loss:0.0811
Val metric mean prob: 0.2644
Best metric at: 0.4920 0.2990  0.7256
Cf: [[4625   41]
 [  54   46]]
Valid loss:0.0816
Val metric mean prob: 0.2538
Best metric at: 0.4789 0.2400  0.7484
Cf: [[4604   62]
 [  49   51]]
Valid loss:0.0818
Val metric mean prob: 0.2665
Best metric at: 0.4842 0.3050  0.7253
Cf: [[4622   44]
 [  54   46]]
Valid loss:0.0807
Val metric mean prob: 0.2338
Best metric at: 0.4834 0.2300  0.7486
Cf: [[4606   60]
 [  49   51]]
Valid loss:0.0839
Val metric mean prob: 0.2785
Best metric at: 0.4831 0.3630  0.7112
Cf: [[4631   35]
 [  57   43]]
Valid loss:0.0860
Val metric mean prob: 0.2744
Best metric at: 0.4828 0.3100  0.7392
Cf: [[4612   54]
 [  51   49]]
Valid loss:0.0830
Val metric mean prob: 0.2718
Best metric at: 0.4731 0.3250  0.7155
Cf: [[4624   42]
 [  56   44]]
Valid loss:0.0838
Val metric mean prob: 0.2791
Best metric at: 0.4831 0.3600  0.7112
Cf: [[4631   35]
 [  57   43]]
Valid loss:0.0839
Val metric mean prob: 0.2745
Best metric at: 0.4831 0.3570  0.7112
Cf: [[4631   35]
 [  57   43]]
Valid loss:0.0890
Val metric mean prob: 0.2926
Best metric at: 0.4881 0.3870  0.7021
Cf: [[4639   27]
 [  59   41]]
Valid loss:0.0853
Val metric mean prob: 0.2736
Best metric at: 0.5000 0.3660  0.7212
Cf: [[4631   35]
 [  55   45]]
Date :02/19/2023, 14:47:04
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2153, Valid loss:0.1129
Val metric mean prob: 0.0469
Best metric at epoch 1: 0.2308 0.1460  0.5876
Cf: [[2313   20]
 [  40    9]]
Model improve: 0.0000 -> 0.2308
Epoch: 2/15
Train loss:0.1551, Valid loss:0.0916
Val metric mean prob: 0.1041
Best metric at epoch 2: 0.3243 0.2120  0.6197
Cf: [[2320   13]
 [  37   12]]
Model improve: 0.2308 -> 0.3243
Epoch: 3/15
Train loss:0.1368, Valid loss:0.0972
Val metric mean prob: 0.1867
Best metric at epoch 3: 0.5111 0.3630  0.7308
Cf: [[2315   18]
 [  26   23]]
Model improve: 0.3243 -> 0.5111
Epoch: 4/15
Train loss:0.1242, Valid loss:0.0867
Val metric mean prob: 0.1720
Best metric at epoch 4: 0.4110 0.3340  0.6511
Cf: [[2324    9]
 [  34   15]]
Epoch: 5/15
Train loss:0.1143, Valid loss:0.0779
Val metric mean prob: 0.2275
Best metric at epoch 5: 0.4865 0.3240  0.6822
Cf: [[2326    7]
 [  31   18]]
Epoch: 6/15
Train loss:0.1029, Valid loss:0.0903
Val metric mean prob: 0.2241
Best metric at epoch 6: 0.4176 0.3420  0.6889
Cf: [[2310   23]
 [  30   19]]
Epoch: 7/15
Train loss:0.0932, Valid loss:0.1024
Val metric mean prob: 0.2218
Best metric at epoch 7: 0.4186 0.4510  0.6796
Cf: [[2314   19]
 [  31   18]]
Epoch: 8/15
Train loss:0.0808, Valid loss:0.0894
Val metric mean prob: 0.2434
Best metric at epoch 8: 0.4255 0.2260  0.6987
Cf: [[2308   25]
 [  29   20]]
Epoch: 9/15
seed: 1
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2165, Valid loss:0.1024
Val metric mean prob: 0.0472
Best metric at epoch 1: 0.2051 0.1160  0.5771
Cf: [[2313   21]
 [  41    8]]
Model improve: 0.0000 -> 0.2051
Epoch: 2/15
Train loss:0.1559, Valid loss:0.0869
Val metric mean prob: 0.1385
Best metric at epoch 2: 0.4835 0.2210  0.7202
Cf: [[2314   20]
 [  27   22]]
Model improve: 0.2051 -> 0.4835
Epoch: 3/15
Train loss:0.1392, Valid loss:0.0937
Val metric mean prob: 0.1887
Best metric at epoch 3: 0.5294 0.3110  0.7699
Cf: [[2308   26]
 [  22   27]]
Model improve: 0.4835 -> 0.5294
Epoch: 4/15
Train loss:0.1266, Valid loss:0.0736
Val metric mean prob: 0.2641
Best metric at epoch 4: 0.5495 0.2970  0.7515
Cf: [[2317   17]
 [  24   25]]
Model improve: 0.5294 -> 0.5495
Epoch: 5/15
Train loss:0.1176, Valid loss:0.0684
Val metric mean prob: 0.2736
Best metric at epoch 5: 0.5825 0.1370  0.8010
Cf: [[2310   24]
 [  19   30]]
Model improve: 0.5495 -> 0.5825
Epoch: 6/15
Train loss:0.1061, Valid loss:0.0710
Val metric mean prob: 0.2774
Best metric at epoch 6: 0.5316 0.1880  0.7124
Cf: [[2325    9]
 [  28   21]]
Epoch: 7/15
Train loss:0.0962, Valid loss:0.0746
Val metric mean prob: 0.3359
Best metric at epoch 7: 0.5679 0.3800  0.7328
Cf: [[2325    9]
 [  26   23]]
Epoch: 8/15
Train loss:0.0843, Valid loss:0.0722
Val metric mean prob: 0.3402
Best metric at epoch 8: 0.5333 0.3700  0.7028
Cf: [[2328    6]
 [  29   20]]
Epoch: 9/15
Train loss:0.0738, Valid loss:0.0778
Val metric mean prob: 0.3430
Best metric at epoch 9: 0.5542 0.3100  0.7323
Cf: [[2323   11]
 [  26   23]]
Epoch: 10/15
Valid loss:0.0736
Val metric mean prob: 0.2584
Best metric at: 0.5647 0.3190  0.7423
Cf: [[2322   12]
 [  25   24]]
Valid loss:0.0742
Val metric mean prob: 0.3455
Best metric at: 0.5897 0.4560  0.7334
Cf: [[2328    6]
 [  26   23]]
Valid loss:0.0679
Val metric mean prob: 0.3185
Best metric at: 0.5952 0.3180  0.7530
Cf: [[2324   10]
 [  24   25]]
Valid loss:0.0681
Val metric mean prob: 0.2618
Best metric at: 0.5934 0.1930  0.7723
Cf: [[2319   15]
 [  22   27]]
Valid loss:0.0680
Val metric mean prob: 0.3375
Best metric at: 0.6078 0.2200  0.8116
Cf: [[2312   22]
 [  18   31]]
Valid loss:0.0689
Val metric mean prob: 0.3278
Best metric at: 0.5870 0.2960  0.7721
Cf: [[2318   16]
 [  22   27]]
Valid loss:0.0719
Val metric mean prob: 0.2931
Best metric at: 0.5581 0.3500  0.7421
Cf: [[2321   13]
 [  25   24]]
Valid loss:0.0736
Val metric mean prob: 0.2921
Best metric at: 0.5714 0.3770  0.7425
Cf: [[2323   11]
 [  25   24]]
Valid loss:0.0705
Val metric mean prob: 0.3349
Best metric at: 0.5867 0.4390  0.7236
Cf: [[2330    4]
 [  27   22]]
Valid loss:0.0701
Val metric mean prob: 0.3389
Best metric at: 0.5952 0.3610  0.7530
Cf: [[2324   10]
 [  24   25]]
Valid loss:0.0672
Val metric mean prob: 0.2967
Best metric at: 0.6042 0.1810  0.7921
Cf: [[2316   18]
 [  20   29]]
Valid loss:0.0678
Val metric mean prob: 0.2771
Best metric at: 0.6022 0.1620  0.7823
Cf: [[2318   16]
 [  21   28]]
Valid loss:0.0673
Val metric mean prob: 0.2888
Best metric at: 0.6087 0.1830  0.7825
Cf: [[2319   15]
 [  21   28]]
Valid loss:0.0670
Val metric mean prob: 0.2937
Best metric at: 0.6042 0.1810  0.7921
Cf: [[2316   18]
 [  20   29]]
Valid loss:0.0686
Val metric mean prob: 0.3008
Best metric at: 0.5778 0.2570  0.7621
Cf: [[2319   15]
 [  23   26]]
Valid loss:0.0870
Val metric mean prob: 0.3627
Best metric at: 0.5542 0.4870  0.7323
Cf: [[2323   11]
 [  26   23]]
Valid loss:0.0668
Val metric mean prob: 0.3105
Best metric at: 0.6061 0.1840  0.8018
Cf: [[2314   20]
 [  19   30]]
Valid loss:0.0682
Val metric mean prob: 0.2752
Best metric at: 0.5895 0.1560  0.7819
Cf: [[2316   18]
 [  21   28]]
Valid loss:0.0672
Val metric mean prob: 0.3155
Best metric at: 0.6042 0.2110  0.7921
Cf: [[2316   18]
 [  20   29]]
Valid loss:0.0669
Val metric mean prob: 0.2917
Best metric at: 0.6042 0.1850  0.7921
Cf: [[2316   18]
 [  20   29]]
Valid loss:0.0682
Val metric mean prob: 0.3097
Best metric at: 0.5979 0.2410  0.7918
Cf: [[2315   19]
 [  20   29]]
Valid loss:0.0668
Val metric mean prob: 0.2929
Best metric at: 0.6105 0.1890  0.7923
Cf: [[2317   17]
 [  20   29]]
Valid loss:0.0670
Val metric mean prob: 0.2872
Best metric at: 0.5979 0.1710  0.7918
Cf: [[2315   19]
 [  20   29]]
Valid loss:0.0669
Val metric mean prob: 0.2949
Best metric at: 0.6042 0.1880  0.7921
Cf: [[2316   18]
 [  20   29]]
Valid loss:0.0668
Val metric mean prob: 0.2904
Best metric at: 0.6042 0.1750  0.7921
Cf: [[2316   18]
 [  20   29]]
Valid loss:0.0670
Val metric mean prob: 0.2863
Best metric at: 0.6042 0.1890  0.7921
Cf: [[2316   18]
 [  20   29]]
Valid loss:0.0675
Val metric mean prob: 0.2814
Best metric at: 0.6087 0.1760  0.7825
Cf: [[2319   15]
 [  21   28]]
Valid loss:0.0675
Val metric mean prob: 0.2803
Best metric at: 0.6087 0.1750  0.7825
Cf: [[2319   15]
 [  21   28]]
Valid loss:0.0674
Val metric mean prob: 0.2812
Best metric at: 0.5957 0.1680  0.7821
Cf: [[2317   17]
 [  21   28]]
Valid loss:0.0669
Val metric mean prob: 0.2834
Best metric at: 0.5934 0.1890  0.7723
Cf: [[2319   15]
 [  22   27]]
Valid loss:0.0672
Val metric mean prob: 0.2827
Best metric at: 0.6105 0.1680  0.7923
Cf: [[2317   17]
 [  20   29]]
Valid loss:0.0673
Val metric mean prob: 0.2819
Best metric at: 0.6042 0.1640  0.7921
Cf: [[2316   18]
 [  20   29]]
Valid loss:0.0682
Val metric mean prob: 0.2756
Best metric at: 0.5895 0.1560  0.7819
Cf: [[2316   18]
 [  21   28]]
Valid loss:0.0671
Val metric mean prob: 0.2845
Best metric at: 0.6022 0.1780  0.7823
Cf: [[2318   16]
 [  21   28]]
Valid loss:0.0670
Val metric mean prob: 0.2836
Best metric at: 0.5934 0.1920  0.7723
Cf: [[2319   15]
 [  22   27]]
Valid loss:0.0669
Val metric mean prob: 0.2890
Best metric at: 0.5957 0.1880  0.7821
Cf: [[2317   17]
 [  21   28]]
Valid loss:0.0674
Val metric mean prob: 0.2818
Best metric at: 0.6022 0.1770  0.7823
Cf: [[2318   16]
 [  21   28]]
Valid loss:0.0752
Val metric mean prob: 0.3495
Best metric at: 0.5783 0.4180  0.7428
Cf: [[2324   10]
 [  25   24]]
Valid loss:0.0807
Val metric mean prob: 0.3465
Best metric at: 0.5500 0.4880  0.7226
Cf: [[2325    9]
 [  27   22]]
Valid loss:0.0676
Val metric mean prob: 0.3122
Best metric at: 0.6042 0.2300  0.7921
Cf: [[2316   18]
 [  20   29]]
Valid loss:0.0683
Val metric mean prob: 0.3252
Best metric at: 0.6265 0.3310  0.7636
Cf: [[2326    8]
 [  23   26]]
Valid loss:0.0777
Val metric mean prob: 0.3499
Best metric at: 0.5823 0.4800  0.7332
Cf: [[2327    7]
 [  26   23]]
Valid loss:0.0732
Val metric mean prob: 0.3482
Best metric at: 0.5854 0.3850  0.7430
Cf: [[2325    9]
 [  25   24]]
Valid loss:0.0681
Val metric mean prob: 0.3378
Best metric at: 0.6078 0.2200  0.8116
Cf: [[2312   22]
 [  18   31]]
Valid loss:0.0681
Val metric mean prob: 0.2791
Best metric at: 0.5895 0.1590  0.7819
Cf: [[2316   18]
 [  21   28]]
Valid loss:0.0680
Val metric mean prob: 0.3296
Best metric at: 0.6154 0.2230  0.8216
Cf: [[2311   23]
 [  17   32]]
Valid loss:0.0736
Val metric mean prob: 0.3501
Best metric at: 0.5745 0.3680  0.7717
Cf: [[2316   18]
 [  22   27]]
Valid loss:0.0723
Val metric mean prob: 0.3450
Best metric at: 0.5823 0.4330  0.7332
Cf: [[2327    7]
 [  26   23]]
Valid loss:0.0679
Val metric mean prob: 0.3283
Best metric at: 0.6154 0.2170  0.8216
Cf: [[2311   23]
 [  17   32]]
Valid loss:0.0673
Val metric mean prob: 0.3242
Best metric at: 0.6214 0.1990  0.8218
Cf: [[2312   22]
 [  17   32]]
Valid loss:0.0672
Val metric mean prob: 0.3030
Best metric at: 0.6078 0.1700  0.8116
Cf: [[2312   22]
 [  18   31]]
Valid loss:0.0682
Val metric mean prob: 0.3451
Best metric at: 0.6122 0.2260  0.8021
Cf: [[2315   19]
 [  19   30]]
Valid loss:0.0673
Val metric mean prob: 0.3197
Best metric at: 0.6214 0.1960  0.8218
Cf: [[2312   22]
 [  17   32]]
Valid loss:0.0689
Val metric mean prob: 0.3364
Best metric at: 0.6173 0.3680  0.7536
Cf: [[2327    7]
 [  24   25]]
Valid loss:0.0680
Val metric mean prob: 0.2808
Best metric at: 0.5895 0.1590  0.7819
Cf: [[2316   18]
 [  21   28]]
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0771
Val metric mean prob: 0.2377
Best metric at: 0.4878 0.3160  0.7013
Cf: [[2320   13]
 [  29   20]]
Valid loss:0.0771
Val metric mean prob: 0.2377
Best metric at: 0.4878 0.3160  0.7013
Cf: [[2320   13]
 [  29   20]]
Valid loss:0.0776
Val metric mean prob: 0.2402
Best metric at: 0.4810 0.3340  0.6915
Cf: [[2322   11]
 [  30   19]]
Valid loss:0.0774
Val metric mean prob: 0.2327
Best metric at: 0.4762 0.2880  0.7009
Cf: [[2318   15]
 [  29   20]]
Valid loss:0.0797
Val metric mean prob: 0.2351
Best metric at: 0.5128 0.3670  0.7022
Cf: [[2324    9]
 [  29   20]]
Valid loss:0.0895
Val metric mean prob: 0.2068
Best metric at: 0.5060 0.3920  0.7115
Cf: [[2320   13]
 [  28   21]]
Valid loss:0.0935
Val metric mean prob: 0.1961
Best metric at: 0.5000 0.3850  0.7113
Cf: [[2319   14]
 [  28   21]]
Valid loss:0.0858
Val metric mean prob: 0.2176
Best metric at: 0.5122 0.3800  0.7117
Cf: [[2321   12]
 [  28   21]]
Valid loss:0.0872
Val metric mean prob: 0.2134
Best metric at: 0.5060 0.3700  0.7115
Cf: [[2320   13]
 [  28   21]]
Valid loss:0.0774
Val metric mean prob: 0.2400
Best metric at: 0.4810 0.3310  0.6915
Cf: [[2322   11]
 [  30   19]]
Valid loss:0.0834
Val metric mean prob: 0.2245
Best metric at: 0.5128 0.3990  0.7022
Cf: [[2324    9]
 [  29   20]]
Valid loss:0.0802
Val metric mean prob: 0.2336
Best metric at: 0.5067 0.3860  0.6924
Cf: [[2326    7]
 [  30   19]]
Valid loss:0.0803
Val metric mean prob: 0.2333
Best metric at: 0.5067 0.3860  0.6924
Cf: [[2326    7]
 [  30   19]]
Valid loss:0.0832
Val metric mean prob: 0.2251
Best metric at: 0.5122 0.3580  0.7117
Cf: [[2321   12]
 [  28   21]]
Valid loss:0.0824
Val metric mean prob: 0.2275
Best metric at: 0.5122 0.3540  0.7117
Cf: [[2321   12]
 [  28   21]]
Valid loss:0.0789
Val metric mean prob: 0.2372
Best metric at: 0.5063 0.3490  0.7019
Cf: [[2323   10]
 [  29   20]]
Valid loss:0.0832
Val metric mean prob: 0.2251
Best metric at: 0.5122 0.3580  0.7117
Cf: [[2321   12]
 [  28   21]]
seed: 1
10 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Epoch: 2/15
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Epoch: 2/15
Date :02/20/2023, 04:07:59
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(0, 0), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=102, max_w_size=102),
  CLAHE(always_apply=False, p=0.5, clip_limit=(1, 15), tile_grid_size=(8, 8)),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2196, Valid loss:0.1028
Val metric mean prob: 0.0353
Best metric at epoch 1: 0.1138 0.0810  0.5571
Cf: [[2266   67]
 [  42    7]]
Model improve: 0.0000 -> 0.1138
Epoch: 2/15
Train loss:0.1603, Valid loss:0.0971
Val metric mean prob: 0.0962
Best metric at epoch 2: 0.2881 0.1710  0.6623
Cf: [[2281   52]
 [  32   17]]
Model improve: 0.1138 -> 0.2881
Epoch: 3/15
Date :02/20/2023, 05:29:29
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(0, 0), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=3, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2152, Valid loss:0.1040
Val metric mean prob: 0.0513
Best metric at epoch 1: 0.1955 0.1280  0.6174
Cf: [[2262   71]
 [  36   13]]
Model improve: 0.0000 -> 0.1955
Epoch: 2/15
Train loss:0.1540, Valid loss:0.0911
Val metric mean prob: 0.1217
Best metric at epoch 2: 0.2857 0.2750  0.5997
Cf: [[2322   11]
 [  39   10]]
Model improve: 0.1955 -> 0.2857
Epoch: 3/15
Train loss:0.1362, Valid loss:0.0965
Val metric mean prob: 0.1810
Best metric at epoch 3: 0.4783 0.3300  0.7200
Cf: [[2312   21]
 [  27   22]]
Model improve: 0.2857 -> 0.4783
Epoch: 4/15
Date :02/20/2023, 07:22:22
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2154, Valid loss:0.0986
Val metric mean prob: 0.0474
Best metric at epoch 1: 0.1978 0.1110  0.5848
Cf: [[2300   33]
 [  40    9]]
Model improve: 0.0000 -> 0.1978
Epoch: 2/15
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/20/2023, 08:06:10
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 50278
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/20/2023, 08:16:46
Date :02/20/2023, 08:16:46
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
seed: 1
10 fold
10 fold
Fold: 1
Fold: 1
Model name: tf_efficientnetv2_b2
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len train df: 44750
Len valid df: 10879
Len valid df: 10879
Train bs: 16
Train bs: 16
ModelOld
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
total_epoch :15
Warmup: 1
Warmup: 1
Date :02/20/2023, 08:17:33
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Date :02/20/2023, 08:23:27
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0886
Val metric mean prob: 0.2787
Best metric at: 0.4848 0.3420  0.7301
Cf: [[4614   48]
 [  54   48]]
Valid loss:0.0906
Val metric mean prob: 0.2857
Best metric at: 0.4949 0.3820  0.7352
Cf: [[4615   47]
 [  53   49]]
Valid loss:0.0889
Val metric mean prob: 0.2662
Best metric at: 0.4756 0.4140  0.6887
Cf: [[4639   23]
 [  63   39]]
Valid loss:0.0948
Val metric mean prob: 0.2859
Best metric at: 0.4796 0.4150  0.7254
Cf: [[4615   47]
 [  55   47]]
Valid loss:0.1057
Val metric mean prob: 0.2929
Best metric at: 0.4516 0.4480  0.7014
Cf: [[4620   42]
 [  60   42]]
Date :02/20/2023, 08:51:04
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
10 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0970
Val metric mean prob: 0.2767
Best metric at: 0.4643 0.5030  0.6883
Cf: [[4635   27]
 [  63   39]]
Valid loss:0.0935
Val metric mean prob: 0.2745
Best metric at: 0.4819 0.4910  0.6935
Cf: [[4638   24]
 [  62   40]]
Valid loss:0.1059
Val metric mean prob: 0.2932
Best metric at: 0.4516 0.4400  0.7014
Cf: [[4620   42]
 [  60   42]]
Valid loss:0.1035
Val metric mean prob: 0.2904
Best metric at: 0.4456 0.4310  0.7056
Cf: [[4614   48]
 [  59   43]]
Valid loss:0.0948
Val metric mean prob: 0.2792
Best metric at: 0.4778 0.4660  0.7070
Cf: [[4627   35]
 [  59   43]]
Valid loss:0.0993
Val metric mean prob: 0.2837
Best metric at: 0.4375 0.3670  0.7007
Cf: [[4614   48]
 [  60   42]]
Valid loss:0.1034
Val metric mean prob: 0.2884
Best metric at: 0.4492 0.4350  0.7013
Cf: [[4619   43]
 [  60   42]]
Valid loss:0.1212
Val metric mean prob: 0.2946
Best metric at: 0.4162 0.4010  0.6727
Cf: [[4627   35]
 [  66   36]]
Valid loss:0.1037
Val metric mean prob: 0.2898
Best metric at: 0.4468 0.4340  0.7012
Cf: [[4618   44]
 [  60   42]]
Valid loss:0.0981
Val metric mean prob: 0.2790
Best metric at: 0.4615 0.5020  0.6882
Cf: [[4634   28]
 [  63   39]]
Valid loss:0.0875
Val metric mean prob: 0.2722
Best metric at: 0.4787 0.3490  0.7162
Cf: [[4621   41]
 [  57   45]]
Valid loss:0.1154
Val metric mean prob: 0.2960
Best metric at: 0.4339 0.3670  0.6960
Cf: [[4616   46]
 [  61   41]]
Valid loss:0.0952
Val metric mean prob: 0.2735
Best metric at: 0.4691 0.5020  0.6839
Cf: [[4640   22]
 [  64   38]]
Valid loss:0.0986
Val metric mean prob: 0.2801
Best metric at: 0.4615 0.5030  0.6882
Cf: [[4634   28]
 [  63   39]]
Valid loss:0.0956
Val metric mean prob: 0.2744
Best metric at: 0.4663 0.4990  0.6838
Cf: [[4639   23]
 [  64   38]]
Valid loss:0.1122
Val metric mean prob: 0.2954
Best metric at: 0.4301 0.3860  0.6914
Cf: [[4618   44]
 [  62   40]]
Valid loss:0.1032
Val metric mean prob: 0.2883
Best metric at: 0.4497 0.4850  0.6832
Cf: [[4633   29]
 [  64   38]]
seed: 1
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 44699
Len valid df: 10945
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0003
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/20/2023, 09:46:18
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
10 fold
Fold: 4
Model name: tf_efficientnetv2_b2
Len train df: 44699
Len valid df: 10945
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0003
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2200, Valid loss:0.0955
Val metric mean prob: 0.0320
Best metric at epoch 1: 0.1091 0.0670  0.5416
Cf: [[4610   63]
 [  84    9]]
Model improve: 0.0000 -> 0.1091
Epoch: 2/15
Train loss:0.1598, Valid loss:0.0854
Val metric mean prob: 0.0922
Best metric at epoch 2: 0.3308 0.1830  0.6164
Cf: [[4655   18]
 [  71   22]]
Model improve: 0.1091 -> 0.3308
Epoch: 3/15
Train loss:0.1394, Valid loss:0.0855
Val metric mean prob: 0.1472
Best metric at epoch 3: 0.3613 0.2830  0.6469
Cf: [[4639   34]
 [  65   28]]
Model improve: 0.3308 -> 0.3613
Epoch: 4/15
Train loss:0.1296, Valid loss:0.0837
Val metric mean prob: 0.1967
Best metric at epoch 4: 0.3919 0.3580  0.6531
Cf: [[4647   26]
 [  64   29]]
Model improve: 0.3613 -> 0.3919
Epoch: 5/15
Train loss:0.1209, Valid loss:0.1012
Val metric mean prob: 0.1900
Best metric at epoch 5: 0.4096 0.4370  0.6786
Cf: [[4634   39]
 [  59   34]]
Model improve: 0.3919 -> 0.4096
Epoch: 6/15
Train loss:0.1111, Valid loss:0.0807
Val metric mean prob: 0.2089
Best metric at epoch 6: 0.3636 0.2930  0.6470
Cf: [[4640   33]
 [  65   28]]
Epoch: 7/15
Train loss:0.1033, Valid loss:0.0818
Val metric mean prob: 0.2354
Best metric at epoch 7: 0.4125 0.3650  0.6738
Cf: [[4639   34]
 [  60   33]]
Model improve: 0.4096 -> 0.4125
Epoch: 8/15
Train loss:0.0920, Valid loss:0.0841
Val metric mean prob: 0.2515
Best metric at epoch 8: 0.4148 0.5060  0.6490
Cf: [[4659   14]
 [  65   28]]
Model improve: 0.4125 -> 0.4148
Epoch: 9/15
Date :02/20/2023, 14:53:43
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0003
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/20/2023, 14:54:46
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0003
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0003
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/20/2023, 14:55:52
Date :02/20/2023, 14:55:52
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
seed: 1
5 fold
5 fold
Fold: 0
Fold: 0
Model name: tf_efficientnetv2_b3
Model name: tf_efficientnetv2_b3
Len train df: 44652
Len train df: 44652
Len valid df: 10979
Len valid df: 10979
Train bs: 16
Train bs: 16
ModelOld
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
total_epoch :15
Warmup: 1
Warmup: 1
Epoch: 1/15
Epoch: 1/15
Date :02/20/2023, 14:56:13
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/20/2023, 15:04:21
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-30, 30), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=6, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/20/2023, 15:04:40
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/20/2023, 15:13:47
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2176, Valid loss:0.1021
Val metric mean prob: 0.0515
Best metric at epoch 1: 0.1417 0.1060  0.6078
Cf: [[4412  254]
 [  73   27]]
Model improve: 0.0000 -> 0.1417
Epoch: 2/15
Train loss:0.1578, Valid loss:0.0970
Val metric mean prob: 0.1150
Best metric at epoch 2: 0.2877 0.3370  0.6023
Cf: [[4641   25]
 [  79   21]]
Model improve: 0.1417 -> 0.2877
Epoch: 3/15
Train loss:0.1387, Valid loss:0.0850
Val metric mean prob: 0.1970
Best metric at epoch 3: 0.3543 0.2490  0.6503
Cf: [[4622   44]
 [  69   31]]
Model improve: 0.2877 -> 0.3543
Epoch: 4/15
Train loss:0.1264, Valid loss:0.0811
Val metric mean prob: 0.1577
Best metric at epoch 4: 0.4046 0.1540  0.6709
Cf: [[4628   38]
 [  65   35]]
Model improve: 0.3543 -> 0.4046
Epoch: 5/15
Train loss:0.1151, Valid loss:0.0795
Val metric mean prob: 0.2003
Best metric at epoch 5: 0.3710 0.1250  0.6964
Cf: [[4586   80]
 [  59   41]]
Epoch: 6/15
Train loss:0.1001, Valid loss:0.0835
Val metric mean prob: 0.2347
Best metric at epoch 6: 0.4146 0.2520  0.6668
Cf: [[4636   30]
 [  66   34]]
Model improve: 0.4046 -> 0.4146
Epoch: 7/15
Train loss:0.0877, Valid loss:0.1007
Val metric mean prob: 0.2464
Best metric at epoch 7: 0.3615 0.2590  0.7229
Cf: [[4553  113]
 [  53   47]]
Epoch: 8/15
Train loss:0.0753, Valid loss:0.1059
Val metric mean prob: 0.2298
Best metric at epoch 8: 0.3837 0.4550  0.6608
Cf: [[4627   39]
 [  67   33]]
Epoch: 9/15
Train loss:0.0623, Valid loss:0.1016
Val metric mean prob: 0.2414
Best metric at epoch 9: 0.3915 0.3710  0.6794
Cf: [[4614   52]
 [  63   37]]
Epoch: 10/15
Train loss:0.0536, Valid loss:0.0996
Val metric mean prob: 0.2796
Best metric at epoch 10: 0.4260 0.3060  0.6765
Cf: [[4633   33]
 [  64   36]]
Model improve: 0.4146 -> 0.4260
Epoch: 11/15
Train loss:0.0425, Valid loss:0.1112
Val metric mean prob: 0.2882
Best metric at epoch 11: 0.4068 0.2900  0.6756
Cf: [[4625   41]
 [  64   36]]
Epoch: 12/15
Train loss:0.0356, Valid loss:0.1196
Val metric mean prob: 0.2787
Best metric at epoch 12: 0.4211 0.2380  0.6946
Cf: [[4616   50]
 [  60   40]]
Epoch: 13/15
Train loss:0.0306, Valid loss:0.1227
Val metric mean prob: 0.2992
Best metric at epoch 13: 0.4221 0.2460  0.7039
Cf: [[4609   57]
 [  58   42]]
Epoch: 14/15
Date :02/20/2023, 23:50:12
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b3
Len train df: 44652
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2176, Valid loss:0.1025
Val metric mean prob: 0.0472
Best metric at epoch 1: 0.1327 0.0890  0.6155
Cf: [[4344  322]
 [  70   30]]
Model improve: 0.0000 -> 0.1327
Epoch: 2/15
Train loss:0.1570, Valid loss:0.0927
Val metric mean prob: 0.0929
Best metric at epoch 2: 0.3046 0.1800  0.6120
Cf: [[4638   28]
 [  77   23]]
Model improve: 0.1327 -> 0.3046
Epoch: 3/15
Train loss:0.1392, Valid loss:0.0868
Val metric mean prob: 0.1993
Best metric at epoch 3: 0.3438 0.2640  0.6587
Cf: [[4607   59]
 [  67   33]]
Model improve: 0.3046 -> 0.3438
Epoch: 4/15
Train loss:0.1276, Valid loss:0.0791
Val metric mean prob: 0.1905
Best metric at epoch 4: 0.4224 0.2250  0.6671
Cf: [[4639   27]
 [  66   34]]
Model improve: 0.3438 -> 0.4224
Epoch: 5/15
Train loss:0.1150, Valid loss:0.0796
Val metric mean prob: 0.2039
Best metric at epoch 5: 0.3959 0.1560  0.6888
Cf: [[4608   58]
 [  61   39]]
Epoch: 6/15
Train loss:0.1001, Valid loss:0.0847
Val metric mean prob: 0.2179
Best metric at epoch 6: 0.4167 0.2410  0.6715
Cf: [[4633   33]
 [  65   35]]
Epoch: 7/15
Train loss:0.0890, Valid loss:0.0945
Val metric mean prob: 0.2465
Best metric at epoch 7: 0.4146 0.2560  0.7448
Cf: [[4571   95]
 [  49   51]]
Epoch: 8/15
Train loss:0.0777, Valid loss:0.0972
Val metric mean prob: 0.2509
Best metric at epoch 8: 0.4114 0.3600  0.6758
Cf: [[4627   39]
 [  64   36]]
Date :02/21/2023, 04:57:33
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
New dataset
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44699
Len valid df: 10935
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/21/2023, 05:02:48
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
New dataset
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 44699
Len valid df: 10935
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2178, Valid loss:0.1001
Val metric mean prob: 0.0296
Best metric at epoch 1: 0.1079 0.0510  0.5582
Cf: [[4501  164]
 [  84   15]]
Model improve: 0.0000 -> 0.1079
Epoch: 2/15
Train loss:0.1578, Valid loss:0.0896
Val metric mean prob: 0.1087
Best metric at epoch 2: 0.3176 0.1960  0.6316
Cf: [[4621   44]
 [  72   27]]
Model improve: 0.1079 -> 0.3176
Epoch: 3/15
Train loss:0.1374, Valid loss:0.0844
Val metric mean prob: 0.1424
Best metric at epoch 3: 0.2857 0.2450  0.5988
Cf: [[4644   21]
 [  79   20]]
Epoch: 4/15
Train loss:0.1263, Valid loss:0.0855
Val metric mean prob: 0.1808
Best metric at epoch 4: 0.3439 0.3040  0.6330
Cf: [[4634   31]
 [  72   27]]
Model improve: 0.3176 -> 0.3439
Epoch: 5/15
Train loss:0.1146, Valid loss:0.0922
Val metric mean prob: 0.1827
Best metric at epoch 5: 0.3824 0.2800  0.6899
Cf: [[4599   66]
 [  60   39]]
Model improve: 0.3439 -> 0.3824
Epoch: 6/15
Date :02/21/2023, 07:57:55
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 44603
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/21/2023, 08:00:39
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/21/2023, 08:07:02
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.3055, Valid loss:0.1198
Val metric mean prob: 0.0694
Best metric at epoch 1: 0.1882 0.2050  0.6108
Cf: [[4508  154]
 [  79   27]]
Model improve: 0.0000 -> 0.1882
Epoch: 2/15
Train loss:0.2256, Valid loss:0.1174
Val metric mean prob: 0.1412
Best metric at epoch 2: 0.4311 0.3690  0.6671
Cf: [[4637   25]
 [  70   36]]
Model improve: 0.1882 -> 0.4311
Epoch: 3/15
Train loss:0.1870, Valid loss:0.0969
Val metric mean prob: 0.2504
Best metric at epoch 3: 0.4670 0.4050  0.7122
Cf: [[4617   45]
 [  60   46]]
Model improve: 0.4311 -> 0.4670
Epoch: 4/15
Train loss:0.1578, Valid loss:0.0914
Val metric mean prob: 0.2292
Best metric at epoch 4: 0.4767 0.3230  0.6907
Cf: [[4637   25]
 [  65   41]]
Model improve: 0.4670 -> 0.4767
Epoch: 5/15
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Flip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Date :02/21/2023, 06:03:57
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
Fold: 2
Len train df: 44603
Train bs: 12
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Train loss:0.1314, Valid loss:0.1088
Val metric mean prob: 0.2688
Best metric at epoch 5: 0.4479 0.4250  0.6982
Cf: [[4619   43]
 [  63   43]]
Epoch: 6/15
Train loss:0.1060, Valid loss:0.1112
Val metric mean prob: 0.2753
Best metric at epoch 6: 0.4211 0.4390  0.6667
Cf: [[4633   29]
 [  70   36]]
Epoch: 7/15
Train loss:0.0842, Valid loss:0.1225
Val metric mean prob: 0.2689
Best metric at epoch 7: 0.3865 0.3100  0.6821
Cf: [[4601   61]
 [  66   40]]
Epoch: 8/15
Train loss:0.0669, Valid loss:0.1387
Val metric mean prob: 0.2566
Best metric at epoch 8: 0.3529 0.2620  0.6505
Cf: [[4614   48]
 [  73   33]]
Epoch: 9/15
Date :02/21/2023, 12:53:18
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 47330
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.3367, Valid loss:0.1090
Val metric mean prob: 0.1138
Best metric at epoch 1: 0.3099 0.2430  0.6932
Cf: [[4528  134]
 [  62   44]]
Model improve: 0.0000 -> 0.3099
Epoch: 2/15
Train loss:0.2426, Valid loss:0.0988
Val metric mean prob: 0.1850
Best metric at epoch 2: 0.3902 0.3270  0.6824
Cf: [[4603   59]
 [  66   40]]
Model improve: 0.3099 -> 0.3902
Epoch: 3/15
Train loss:0.1944, Valid loss:0.0949
Val metric mean prob: 0.2217
Best metric at epoch 3: 0.4659 0.3750  0.6903
Cf: [[4633   29]
 [  65   41]]
Model improve: 0.3902 -> 0.4659
Epoch: 4/15
Train loss:0.1563, Valid loss:0.1142
Val metric mean prob: 0.2485
Best metric at epoch 4: 0.4725 0.4700  0.6993
Cf: [[4629   33]
 [  63   43]]
Model improve: 0.4659 -> 0.4725
Epoch: 5/15
Train loss:0.1214, Valid loss:0.1204
Val metric mean prob: 0.2598
Best metric at epoch 5: 0.4520 0.4740  0.6854
Cf: [[4631   31]
 [  66   40]]
Epoch: 6/15
Date :02/21/2023, 15:56:05
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.3047, Valid loss:0.1376
Val metric mean prob: 0.0798
Best metric at epoch 1: 0.2394 0.4040  0.5898
Cf: [[4637   34]
 [  74   17]]
Model improve: 0.0000 -> 0.2394
Epoch: 2/15
Train loss:0.2156, Valid loss:0.0819
Val metric mean prob: 0.1822
Best metric at epoch 2: 0.4189 0.3030  0.6675
Cf: [[4645   26]
 [  60   31]]
Model improve: 0.2394 -> 0.4189
Epoch: 3/15
Train loss:0.1826, Valid loss:0.0900
Val metric mean prob: 0.1930
Best metric at epoch 3: 0.3882 0.3850  0.6764
Cf: [[4625   46]
 [  58   33]]
Epoch: 4/15
Train loss:0.1554, Valid loss:0.0919
Val metric mean prob: 0.1891
Best metric at epoch 4: 0.4311 0.3610  0.6935
Cf: [[4631   40]
 [  55   36]]
Model improve: 0.4189 -> 0.4311
Epoch: 5/15
Train loss:0.1302, Valid loss:0.1129
Val metric mean prob: 0.1935
Best metric at epoch 5: 0.3636 0.4170  0.6902
Cf: [[4600   71]
 [  55   36]]
Epoch: 6/15
Train loss:0.1025, Valid loss:0.0935
Val metric mean prob: 0.2527
Best metric at epoch 6: 0.4304 0.3320  0.6833
Cf: [[4638   33]
 [  57   34]]
Epoch: 7/15
Train loss:0.0809, Valid loss:0.1064
Val metric mean prob: 0.2394
Best metric at epoch 7: 0.4000 0.2120  0.6871
Cf: [[4622   49]
 [  56   35]]
Epoch: 8/15
Train loss:0.0691, Valid loss:0.1207
Val metric mean prob: 0.2590
Best metric at epoch 8: 0.4129 0.3480  0.6724
Cf: [[4639   32]
 [  59   32]]
Epoch: 9/15
Train loss:0.0513, Valid loss:0.1192
Val metric mean prob: 0.2605
Best metric at epoch 9: 0.4000 0.4110  0.6567
Cf: [[4646   25]
 [  62   29]]
Epoch: 10/15
Date :02/21/2023, 21:24:15
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.3055, Valid loss:0.1283
Val metric mean prob: 0.0740
Best metric at epoch 1: 0.1846 0.4230  0.5630
Cf: [[4644   27]
 [  79   12]]
Model improve: 0.0000 -> 0.1846
Epoch: 2/15
Train loss:0.2272, Valid loss:0.0891
Val metric mean prob: 0.1681
Best metric at epoch 2: 0.4528 0.3200  0.6944
Cf: [[4639   32]
 [  55   36]]
Model improve: 0.1846 -> 0.4528
Epoch: 3/15
Train loss:0.1947, Valid loss:0.0815
Val metric mean prob: 0.1899
Best metric at epoch 3: 0.4086 0.2230  0.7027
Cf: [[4614   57]
 [  53   38]]
Epoch: 4/15
Train loss:0.1704, Valid loss:0.1013
Val metric mean prob: 0.1998
Best metric at epoch 4: 0.4295 0.4970  0.6730
Cf: [[4645   26]
 [  59   32]]
Epoch: 5/15
Train loss:0.1539, Valid loss:0.1124
Val metric mean prob: 0.1934
Best metric at epoch 5: 0.4192 0.4790  0.6879
Cf: [[4630   41]
 [  56   35]]
Epoch: 6/15
Date :02/22/2023, 00:45:01
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 47563
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.3381, Valid loss:0.1018
Val metric mean prob: 0.1023
Best metric at epoch 1: 0.3286 0.3170  0.6236
Cf: [[4645   26]
 [  68   23]]
Model improve: 0.0000 -> 0.3286
Epoch: 2/15
Train loss:0.2507, Valid loss:0.1701
Val metric mean prob: 0.1317
Best metric at epoch 2: 0.3923 0.5180  0.7170
Cf: [[4594   77]
 [  50   41]]
Model improve: 0.3286 -> 0.3923
Epoch: 3/15
Train loss:0.2095, Valid loss:0.0822
Val metric mean prob: 0.2027
Best metric at epoch 3: 0.4317 0.3640  0.6629
Cf: [[4653   18]
 [  61   30]]
Model improve: 0.3923 -> 0.4317
Epoch: 4/15
Train loss:0.1752, Valid loss:0.0989
Val metric mean prob: 0.2148
Best metric at epoch 4: 0.4027 0.4770  0.6618
Cf: [[4643   28]
 [  61   30]]
Epoch: 5/15
Date :02/22/2023, 03:12:15
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 53185
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0005
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.4582, Valid loss:0.1240
Val metric mean prob: 0.1121
Best metric at epoch 1: 0.3289 0.4250  0.6335
Cf: [[4635   36]
 [  66   25]]
Model improve: 0.0000 -> 0.3289
Epoch: 2/15
Train loss:0.3235, Valid loss:0.1476
Val metric mean prob: 0.1347
Best metric at epoch 2: 0.3469 0.4880  0.6792
Cf: [[4600   71]
 [  57   34]]
Model improve: 0.3289 -> 0.3469
Epoch: 3/15
Train loss:0.2302, Valid loss:0.1271
Val metric mean prob: 0.1739
Best metric at epoch 3: 0.3692 0.4760  0.6905
Cf: [[4603   68]
 [  55   36]]
Model improve: 0.3469 -> 0.3692
Epoch: 4/15
Train loss:0.1684, Valid loss:0.1114
Val metric mean prob: 0.2220
Best metric at epoch 4: 0.3784 0.3570  0.6860
Cf: [[4612   59]
 [  56   35]]
Model improve: 0.3692 -> 0.3784
Epoch: 5/15
Train loss:0.1276, Valid loss:0.1314
Val metric mean prob: 0.2246
Best metric at epoch 5: 0.3562 0.4710  0.6398
Cf: [[4642   29]
 [  65   26]]
Epoch: 6/15
Date :02/22/2023, 06:39:40
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 44752
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2187, Valid loss:0.1185
Val metric mean prob: 0.0400
Best metric at epoch 1: 0.0913 0.2060  0.5423
Cf: [[4553  118]
 [  81   10]]
Model improve: 0.0000 -> 0.0913
Epoch: 2/15
Train loss:0.1593, Valid loss:0.0903
Val metric mean prob: 0.0669
Best metric at epoch 2: 0.2805 0.1320  0.6210
Cf: [[4621   50]
 [  68   23]]
Model improve: 0.0913 -> 0.2805
Epoch: 3/15
Train loss:0.1441, Valid loss:0.0912
Val metric mean prob: 0.1507
Best metric at epoch 3: 0.4224 0.2880  0.6830
Cf: [[4635   36]
 [  57   34]]
Model improve: 0.2805 -> 0.4224
Epoch: 4/15
Train loss:0.1338, Valid loss:0.0836
Val metric mean prob: 0.1766
Best metric at epoch 4: 0.4148 0.3940  0.6521
Cf: [[4655   16]
 [  63   28]]
Epoch: 5/15
Date :02/22/2023, 09:00:12
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/22/2023, 09:03:58
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/22/2023, 09:07:18
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2159, Valid loss:0.1024
Val metric mean prob: 0.0446
Best metric at epoch 1: 0.1473 0.0820  0.6211
Cf: [[4374  288]
 [  71   31]]
Model improve: 0.0000 -> 0.1473
Epoch: 2/15
Train loss:0.1578, Valid loss:0.0886
Val metric mean prob: 0.1226
Best metric at epoch 2: 0.3026 0.2140  0.6098
Cf: [[4635   27]
 [  79   23]]
Model improve: 0.1473 -> 0.3026
Epoch: 3/15
Train loss:0.1429, Valid loss:0.0930
Val metric mean prob: 0.1683
Best metric at epoch 3: 0.3442 0.2540  0.6732
Cf: [[4586   76]
 [  65   37]]
Model improve: 0.3026 -> 0.3442
Epoch: 4/15
Train loss:0.1308, Valid loss:0.0867
Val metric mean prob: 0.1795
Best metric at epoch 4: 0.3679 0.2190  0.6836
Cf: [[4591   71]
 [  63   39]]
Model improve: 0.3442 -> 0.3679
Epoch: 5/15
Train loss:0.1210, Valid loss:0.1011
Val metric mean prob: 0.2013
Best metric at epoch 5: 0.4444 0.4090  0.6920
Cf: [[4624   38]
 [  62   40]]
Model improve: 0.3679 -> 0.4444
Epoch: 6/15
Train loss:0.1116, Valid loss:0.0854
Val metric mean prob: 0.2412
Best metric at epoch 6: 0.4403 0.4220  0.6692
Cf: [[4640   22]
 [  67   35]]
Epoch: 7/15
Train loss:0.1019, Valid loss:0.0924
Val metric mean prob: 0.2490
Best metric at epoch 7: 0.4430 0.4740  0.6693
Cf: [[4641   21]
 [  67   35]]
Epoch: 8/15
Train loss:0.0909, Valid loss:0.0901
Val metric mean prob: 0.2768
Best metric at epoch 8: 0.4569 0.2640  0.7152
Cf: [[4612   50]
 [  57   45]]
Model improve: 0.4444 -> 0.4569
Epoch: 9/15
Train loss:0.0810, Valid loss:0.0952
Val metric mean prob: 0.2681
Best metric at epoch 9: 0.4200 0.3040  0.6999
Cf: [[4606   56]
 [  60   42]]
Epoch: 10/15
Train loss:0.0700, Valid loss:0.0993
Val metric mean prob: 0.2912
Best metric at epoch 10: 0.4432 0.3460  0.6965
Cf: [[4620   42]
 [  61   41]]
Epoch: 11/15
Train loss:0.0653, Valid loss:0.1068
Val metric mean prob: 0.2722
Best metric at epoch 11: 0.4231 0.4190  0.6595
Cf: [[4641   21]
 [  69   33]]
Epoch: 12/15
Date :02/22/2023, 15:45:05
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/22/2023, 15:56:14
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/22/2023, 16:00:46
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/22/2023, 16:01:16
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/22/2023, 16:18:31
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.3049, Valid loss:0.1588
Val metric mean prob: 0.0739
Best metric at epoch 1: 0.2286 0.4310  0.5844
Cf: [[4638   33]
 [  75   16]]
Model improve: 0.0000 -> 0.2286
Epoch: 2/15
Date :02/23/2023, 03:53:16
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Date :02/23/2023, 03:55:13
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.3049, Valid loss:0.1588
Val metric mean prob: 0.0739
Best metric at epoch 1: 0.2286 0.4310  0.5844
Cf: [[4638   33]
 [  75   16]]
Model improve: 0.0000 -> 0.2286
Epoch: 2/15
Train loss:0.2172, Valid loss:0.0874
Val metric mean prob: 0.1722
Best metric at epoch 2: 0.3600 0.3590  0.6449
Cf: [[4639   32]
 [  64   27]]
Model improve: 0.2286 -> 0.3600
Epoch: 3/15
Train loss:0.1843, Valid loss:0.0866
Val metric mean prob: 0.1754
Best metric at epoch 3: 0.3596 0.2490  0.6699
Cf: [[4616   55]
 [  59   32]]
Epoch: 4/15
Train loss:0.1581, Valid loss:0.0945
Val metric mean prob: 0.2057
Best metric at epoch 4: 0.4379 0.3920  0.6989
Cf: [[4630   41]
 [  54   37]]
Model improve: 0.3600 -> 0.4379
Epoch: 5/15
Train loss:0.1322, Valid loss:0.1162
Val metric mean prob: 0.1803
Best metric at epoch 5: 0.3899 0.4750  0.6664
Cf: [[4634   37]
 [  60   31]]
Epoch: 6/15
Train loss:0.1041, Valid loss:0.0995
Val metric mean prob: 0.2540
Best metric at epoch 6: 0.4172 0.3140  0.6827
Cf: [[4633   38]
 [  57   34]]
Epoch: 7/15
Train loss:0.0811, Valid loss:0.1091
Val metric mean prob: 0.2815
Best metric at epoch 7: 0.4545 0.3540  0.6893
Cf: [[4643   28]
 [  56   35]]
Model improve: 0.4379 -> 0.4545
Epoch: 8/15
Train loss:0.0687, Valid loss:0.1174
Val metric mean prob: 0.2646
Best metric at epoch 8: 0.4246 0.2940  0.7034
Cf: [[4621   50]
 [  53   38]]
Epoch: 9/15
Train loss:0.0515, Valid loss:0.1187
Val metric mean prob: 0.2688
Best metric at epoch 9: 0.4118 0.4490  0.6520
Cf: [[4654   17]
 [  63   28]]
Epoch: 10/15
Date :02/23/2023, 10:08:33
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2159, Valid loss:0.1024
Val metric mean prob: 0.0446
Best metric at epoch 1: 0.1473 0.0820  0.6211
Cf: [[4374  288]
 [  71   31]]
Model improve: 0.0000 -> 0.1473
Epoch: 2/15
Train loss:0.1578, Valid loss:0.0886
Val metric mean prob: 0.1226
Best metric at epoch 2: 0.3026 0.2140  0.6098
Cf: [[4635   27]
 [  79   23]]
Model improve: 0.1473 -> 0.3026
Epoch: 3/15
Train loss:0.1429, Valid loss:0.0930
Val metric mean prob: 0.1683
Best metric at epoch 3: 0.3442 0.2540  0.6732
Cf: [[4586   76]
 [  65   37]]
Model improve: 0.3026 -> 0.3442
Epoch: 4/15
Train loss:0.1308, Valid loss:0.0867
Val metric mean prob: 0.1795
Best metric at epoch 4: 0.3679 0.2190  0.6836
Cf: [[4591   71]
 [  63   39]]
Model improve: 0.3442 -> 0.3679
Epoch: 5/15
Train loss:0.1210, Valid loss:0.1011
Val metric mean prob: 0.2013
Best metric at epoch 5: 0.4444 0.4090  0.6920
Cf: [[4624   38]
 [  62   40]]
Model improve: 0.3679 -> 0.4444
Epoch: 6/15
Date :02/23/2023, 13:07:07
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0003
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2179, Valid loss:0.0990
Val metric mean prob: 0.0426
Best metric at epoch 1: 0.1529 0.0620  0.6047
Cf: [[4450  212]
 [  76   26]]
Model improve: 0.0000 -> 0.1529
Epoch: 2/15
Train loss:0.1568, Valid loss:0.0914
Val metric mean prob: 0.1647
Best metric at epoch 2: 0.3562 0.2210  0.6828
Cf: [[4584   78]
 [  63   39]]
Model improve: 0.1529 -> 0.3562
Epoch: 3/15
Train loss:0.1382, Valid loss:0.0938
Val metric mean prob: 0.1747
Best metric at epoch 3: 0.4242 0.2940  0.7001
Cf: [[4608   54]
 [  60   42]]
Model improve: 0.3562 -> 0.4242
Epoch: 4/15
Train loss:0.1269, Valid loss:0.0814
Val metric mean prob: 0.1877
Best metric at epoch 4: 0.3977 0.2100  0.6674
Cf: [[4623   39]
 [  67   35]]
Epoch: 5/15
Train loss:0.1140, Valid loss:0.0922
Val metric mean prob: 0.2154
Best metric at epoch 5: 0.4342 0.3990  0.6599
Cf: [[4645   17]
 [  69   33]]
Model improve: 0.4242 -> 0.4342
Epoch: 6/15
Train loss:0.1049, Valid loss:0.0973
Val metric mean prob: 0.2298
Best metric at epoch 6: 0.4444 0.3920  0.6920
Cf: [[4624   38]
 [  62   40]]
Model improve: 0.4342 -> 0.4444
Epoch: 7/15
Train loss:0.0925, Valid loss:0.0930
Val metric mean prob: 0.2443
Best metric at epoch 7: 0.4364 0.4110  0.6736
Cf: [[4635   27]
 [  66   36]]
Epoch: 8/15
Train loss:0.0828, Valid loss:0.0977
Val metric mean prob: 0.2438
Best metric at epoch 8: 0.3975 0.3300  0.6540
Cf: [[4635   27]
 [  70   32]]
Epoch: 9/15
Train loss:0.0717, Valid loss:0.1017
Val metric mean prob: 0.2645
Best metric at epoch 9: 0.4141 0.2790  0.6951
Cf: [[4607   55]
 [  61   41]]
Epoch: 10/15
Train loss:0.0613, Valid loss:0.1072
Val metric mean prob: 0.3018
Best metric at epoch 10: 0.4494 0.3130  0.6922
Cf: [[4626   36]
 [  62   40]]
Model improve: 0.4444 -> 0.4494
Epoch: 11/15
Train loss:0.0522, Valid loss:0.1188
Val metric mean prob: 0.2789
Best metric at epoch 11: 0.4211 0.2980  0.6729
Cf: [[4629   33]
 [  66   36]]
Epoch: 12/15
Date :02/23/2023, 19:26:16
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=102, max_w_size=102),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 44750
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.001
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.2178, Valid loss:0.0995
Val metric mean prob: 0.0454
Best metric at epoch 1: 0.1566 0.0720  0.6238
Cf: [[4399  263]
 [  71   31]]
Model improve: 0.0000 -> 0.1566
Epoch: 2/15
Train loss:0.1556, Valid loss:0.0889
Val metric mean prob: 0.1092
Best metric at epoch 2: 0.3455 0.1230  0.6558
Cf: [[4606   56]
 [  69   33]]
Model improve: 0.1566 -> 0.3455
Epoch: 3/15
Train loss:0.1368, Valid loss:0.0890
Val metric mean prob: 0.1949
Best metric at epoch 3: 0.4231 0.3930  0.6595
Cf: [[4641   21]
 [  69   33]]
Model improve: 0.3455 -> 0.4231
Epoch: 4/15
Train loss:0.1282, Valid loss:0.0814
Val metric mean prob: 0.1983
Best metric at epoch 4: 0.4115 0.1860  0.7039
Cf: [[4598   64]
 [  59   43]]
Epoch: 5/15
Train loss:0.1163, Valid loss:0.0855
Val metric mean prob: 0.2023
Best metric at epoch 5: 0.4271 0.2600  0.6957
Cf: [[4613   49]
 [  61   41]]
Model improve: 0.4231 -> 0.4271
Epoch: 6/15
Train loss:0.1045, Valid loss:0.0906
Val metric mean prob: 0.2578
Best metric at epoch 6: 0.4530 0.2740  0.7513
Cf: [[4583   79]
 [  49   53]]
Model improve: 0.4271 -> 0.4530
Epoch: 7/15
Train loss:0.0927, Valid loss:0.0891
Val metric mean prob: 0.2558
Best metric at epoch 7: 0.4382 0.3840  0.6872
Cf: [[4625   37]
 [  63   39]]
Epoch: 8/15
Train loss:0.0823, Valid loss:0.0952
Val metric mean prob: 0.2566
Best metric at epoch 8: 0.3902 0.2730  0.6536
Cf: [[4632   30]
 [  70   32]]
Epoch: 9/15
Date :02/24/2023, 00:06:32
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Train loss:0.3055, Valid loss:0.1237
Val metric mean prob: 0.0631
Best metric at epoch 1: 0.1803 0.1960  0.5877
Cf: [[4556  106]
 [  85   21]]
Model improve: 0.0000 -> 0.1803
Epoch: 2/15
Train loss:0.2346, Valid loss:0.1153
Val metric mean prob: 0.1111
Best metric at epoch 2: 0.3727 0.2990  0.6388
Cf: [[4637   25]
 [  76   30]]
Model improve: 0.1803 -> 0.3727
Epoch: 3/15
Train loss:0.2007, Valid loss:0.0966
Val metric mean prob: 0.1959
Best metric at epoch 3: 0.4083 0.2530  0.7220
Cf: [[4577   85]
 [  57   49]]
Model improve: 0.3727 -> 0.4083
Epoch: 4/15
Train loss:0.1739, Valid loss:0.0935
Val metric mean prob: 0.2125
Best metric at epoch 4: 0.4246 0.3130  0.6755
Cf: [[4627   35]
 [  68   38]]
Model improve: 0.4083 -> 0.4246
Epoch: 5/15
Train loss:0.1521, Valid loss:0.1012
Val metric mean prob: 0.2289
Best metric at epoch 5: 0.4455 0.4020  0.7068
Cf: [[4611   51]
 [  61   45]]
Model improve: 0.4246 -> 0.4455
Epoch: 6/15
Train loss:0.1260, Valid loss:0.1087
Val metric mean prob: 0.2462
Best metric at epoch 6: 0.3977 0.4560  0.6613
Cf: [[4627   35]
 [  71   35]]
Epoch: 7/15
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0913
Val metric mean prob: 0.2782
Best metric at: 0.4920 0.3980  0.7132
Cf: [[4627   35]
 [  60   46]]
Valid loss:0.0922
Val metric mean prob: 0.2172
Best metric at: 0.4938 0.3790  0.6870
Cf: [[4646   16]
 [  66   40]]
Valid loss:0.0915
Val metric mean prob: 0.2782
Best metric at: 0.4900 0.3820  0.7263
Cf: [[4617   45]
 [  57   49]]
Valid loss:0.1205
Val metric mean prob: 0.1558
Best metric at: 0.4835 0.4020  0.7041
Cf: [[4630   32]
 [  62   44]]
Valid loss:0.0947
Val metric mean prob: 0.2453
Best metric at: 0.4918 0.4290  0.7088
Cf: [[4630   32]
 [  61   45]]
Valid loss:0.0949
Val metric mean prob: 0.2050
Best metric at: 0.4878 0.3950  0.6867
Cf: [[4644   18]
 [  66   40]]
Valid loss:0.0952
Val metric mean prob: 0.2442
Best metric at: 0.4870 0.4010  0.7174
Cf: [[4622   40]
 [  59   47]]
Valid loss:0.0944
Val metric mean prob: 0.2575
Best metric at: 0.4957 0.3420  0.7617
Cf: [[4595   67]
 [  49   57]]
Valid loss:0.1046
Val metric mean prob: 0.2054
Best metric at: 0.4787 0.4220  0.7083
Cf: [[4625   37]
 [  61   45]]
Valid loss:0.0927
Val metric mean prob: 0.2606
Best metric at: 0.4921 0.4090  0.7176
Cf: [[4624   38]
 [  59   47]]
Valid loss:0.0918
Val metric mean prob: 0.2204
Best metric at: 0.5000 0.3640  0.7004
Cf: [[4639   23]
 [  63   43]]
Valid loss:0.1361
Val metric mean prob: 0.1366
Best metric at: 0.4929 0.3850  0.7396
Cf: [[4609   53]
 [  54   52]]
Valid loss:0.1155
Val metric mean prob: 0.1629
Best metric at: 0.4819 0.4210  0.6865
Cf: [[4642   20]
 [  66   40]]
Valid loss:0.1284
Val metric mean prob: 0.1590
Best metric at: 0.4729 0.4190  0.7212
Cf: [[4613   49]
 [  58   48]]
Valid loss:0.0942
Val metric mean prob: 0.2085
Best metric at: 0.4908 0.4000  0.6869
Cf: [[4645   17]
 [  66   40]]
Valid loss:0.1197
Val metric mean prob: 0.1718
Best metric at: 0.4824 0.4160  0.7216
Cf: [[4617   45]
 [  58   48]]
Valid loss:0.1244
Val metric mean prob: 0.1653
Best metric at: 0.4851 0.3810  0.7611
Cf: [[4590   72]
 [  49   57]]
Valid loss:0.1256
Val metric mean prob: 0.1580
Best metric at: 0.4742 0.4180  0.7125
Cf: [[4620   42]
 [  60   46]]
Valid loss:0.1151
Val metric mean prob: 0.1815
Best metric at: 0.4813 0.3620  0.7653
Cf: [[4585   77]
 [  48   58]]
Valid loss:0.1020
Val metric mean prob: 0.1942
Best metric at: 0.4953 0.3280  0.7441
Cf: [[4607   55]
 [  53   53]]
Valid loss:0.1239
Val metric mean prob: 0.1551
Best metric at: 0.4712 0.4070  0.7080
Cf: [[4622   40]
 [  61   45]]
Valid loss:0.1101
Val metric mean prob: 0.1693
Best metric at: 0.4884 0.4030  0.6955
Cf: [[4638   24]
 [  64   42]]
Valid loss:0.1284
Val metric mean prob: 0.1377
Best metric at: 0.4949 0.3600  0.7265
Cf: [[4619   43]
 [  57   49]]
Valid loss:0.0986
Val metric mean prob: 0.2049
Best metric at: 0.5000 0.4200  0.7048
Cf: [[4636   26]
 [  62   44]]
Valid loss:0.1176
Val metric mean prob: 0.1590
Best metric at: 0.4828 0.4120  0.6953
Cf: [[4636   26]
 [  64   42]]
Valid loss:0.1254
Val metric mean prob: 0.1471
Best metric at: 0.4831 0.3630  0.7304
Cf: [[4611   51]
 [  56   50]]
Valid loss:0.1125
Val metric mean prob: 0.1726
Best metric at: 0.4953 0.3590  0.7441
Cf: [[4607   55]
 [  53   53]]
Valid loss:0.1199
Val metric mean prob: 0.1557
Best metric at: 0.4809 0.4030  0.7040
Cf: [[4629   33]
 [  62   44]]
Valid loss:0.1213
Val metric mean prob: 0.1604
Best metric at: 0.4975 0.4100  0.7266
Cf: [[4620   42]
 [  57   49]]
Valid loss:0.0911
Val metric mean prob: 0.2353
Best metric at: 0.5060 0.3810  0.6962
Cf: [[4644   18]
 [  64   42]]
Valid loss:0.0919
Val metric mean prob: 0.2220
Best metric at: 0.4918 0.3250  0.7088
Cf: [[4630   32]
 [  61   45]]
Valid loss:0.0921
Val metric mean prob: 0.2230
Best metric at: 0.5000 0.3660  0.7048
Cf: [[4636   26]
 [  62   44]]
Valid loss:0.0942
Val metric mean prob: 0.2129
Best metric at: 0.4944 0.3720  0.7045
Cf: [[4634   28]
 [  62   44]]
Valid loss:0.0957
Val metric mean prob: 0.2071
Best metric at: 0.4916 0.3750  0.7044
Cf: [[4633   29]
 [  62   44]]
Valid loss:0.1356
Val metric mean prob: 0.1333
Best metric at: 0.5053 0.3870  0.7226
Cf: [[4626   36]
 [  58   48]]
Valid loss:0.1380
Val metric mean prob: 0.1280
Best metric at: 0.5027 0.3790  0.7181
Cf: [[4628   34]
 [  59   47]]
Valid loss:0.1389
Val metric mean prob: 0.1285
Best metric at: 0.5000 0.3790  0.7223
Cf: [[4624   38]
 [  58   48]]
Valid loss:0.0970
Val metric mean prob: 0.2046
Best metric at: 0.4944 0.3870  0.7045
Cf: [[4634   28]
 [  62   44]]
Valid loss:0.0914
Val metric mean prob: 0.2272
Best metric at: 0.4855 0.3310  0.6954
Cf: [[4637   25]
 [  64   42]]
Valid loss:0.1085
Val metric mean prob: 0.1915
Best metric at: 0.4818 0.3690  0.7435
Cf: [[4601   61]
 [  53   53]]
Valid loss:0.0949
Val metric mean prob: 0.3004
Best metric at: 0.4817 0.3860  0.7128
Cf: [[4623   39]
 [  60   46]]
Valid loss:0.1298
Val metric mean prob: 0.1402
Best metric at: 0.5052 0.3810  0.7269
Cf: [[4623   39]
 [  57   49]]
Valid loss:0.1189
Val metric mean prob: 0.1589
Best metric at: 0.5055 0.4130  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1145
Val metric mean prob: 0.1670
Best metric at: 0.4972 0.4070  0.7090
Cf: [[4632   30]
 [  61   45]]
Valid loss:0.1027
Val metric mean prob: 0.1901
Best metric at: 0.4971 0.4090  0.7003
Cf: [[4638   24]
 [  63   43]]
Valid loss:0.1258
Val metric mean prob: 0.1460
Best metric at: 0.5081 0.3950  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1290
Val metric mean prob: 0.1416
Best metric at: 0.5055 0.4000  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1121
Val metric mean prob: 0.1686
Best metric at: 0.5056 0.3990  0.7094
Cf: [[4635   27]
 [  61   45]]
Valid loss:0.1093
Val metric mean prob: 0.1745
Best metric at: 0.4944 0.4010  0.7045
Cf: [[4634   28]
 [  62   44]]
Valid loss:0.0938
Val metric mean prob: 0.2187
Best metric at: 0.5000 0.4030  0.7004
Cf: [[4639   23]
 [  63   43]]
Valid loss:0.1253
Val metric mean prob: 0.1459
Best metric at: 0.5081 0.3910  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1048
Val metric mean prob: 0.1851
Best metric at: 0.4920 0.3860  0.7132
Cf: [[4627   35]
 [  60   46]]
Valid loss:0.1305
Val metric mean prob: 0.1363
Best metric at: 0.5027 0.3770  0.7181
Cf: [[4628   34]
 [  59   47]]
Valid loss:0.1101
Val metric mean prob: 0.1736
Best metric at: 0.4972 0.4040  0.7047
Cf: [[4635   27]
 [  62   44]]
Valid loss:0.0992
Val metric mean prob: 0.1993
Best metric at: 0.4971 0.4040  0.7003
Cf: [[4638   24]
 [  63   43]]
Valid loss:0.1261
Val metric mean prob: 0.1433
Best metric at: 0.5027 0.3890  0.7137
Cf: [[4631   31]
 [  60   46]]
Valid loss:0.1136
Val metric mean prob: 0.1654
Best metric at: 0.5028 0.3990  0.7093
Cf: [[4634   28]
 [  61   45]]
Valid loss:0.1340
Val metric mean prob: 0.1340
Best metric at: 0.5079 0.3820  0.7227
Cf: [[4627   35]
 [  58   48]]
Valid loss:0.1329
Val metric mean prob: 0.1374
Best metric at: 0.5000 0.3910  0.7179
Cf: [[4627   35]
 [  59   47]]
Valid loss:0.1249
Val metric mean prob: 0.1478
Best metric at: 0.5081 0.3980  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1257
Val metric mean prob: 0.1462
Best metric at: 0.5081 0.3950  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1221
Val metric mean prob: 0.1522
Best metric at: 0.5081 0.4000  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1239
Val metric mean prob: 0.1488
Best metric at: 0.5055 0.3970  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1170
Val metric mean prob: 0.1604
Best metric at: 0.5000 0.4050  0.7092
Cf: [[4633   29]
 [  61   45]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0784
Val metric mean prob: 0.2206
Best metric at: 0.4896 0.2180  0.7302
Cf: [[4621   45]
 [  53   47]]
Valid loss:0.1074
Val metric mean prob: 0.1923
Best metric at: 0.4972 0.4680  0.7165
Cf: [[4633   33]
 [  56   44]]
Valid loss:0.0830
Val metric mean prob: 0.2011
Best metric at: 0.4974 0.2880  0.7352
Cf: [[4621   45]
 [  52   48]]
Valid loss:0.1030
Val metric mean prob: 0.1927
Best metric at: 0.5140 0.4340  0.7265
Cf: [[4633   33]
 [  54   46]]
Valid loss:0.1032
Val metric mean prob: 0.1825
Best metric at: 0.5146 0.4380  0.7171
Cf: [[4639   27]
 [  56   44]]
Valid loss:0.0815
Val metric mean prob: 0.2299
Best metric at: 0.4973 0.3010  0.7258
Cf: [[4627   39]
 [  54   46]]
Valid loss:0.1018
Val metric mean prob: 0.1778
Best metric at: 0.5114 0.4100  0.7217
Cf: [[4635   31]
 [  55   45]]
Valid loss:0.0815
Val metric mean prob: 0.2100
Best metric at: 0.4762 0.2850  0.7203
Cf: [[4622   44]
 [  55   45]]
Valid loss:0.0975
Val metric mean prob: 0.1843
Best metric at: 0.5137 0.3860  0.7311
Cf: [[4630   36]
 [  53   47]]
Valid loss:0.0983
Val metric mean prob: 0.1778
Best metric at: 0.5000 0.3660  0.7400
Cf: [[4619   47]
 [  51   49]]
Valid loss:0.1080
Val metric mean prob: 0.1986
Best metric at: 0.5000 0.5010  0.7025
Cf: [[4643   23]
 [  59   41]]
Valid loss:0.1060
Val metric mean prob: 0.1899
Best metric at: 0.5257 0.4610  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1051
Val metric mean prob: 0.1890
Best metric at: 0.5111 0.4470  0.7264
Cf: [[4632   34]
 [  54   46]]
Valid loss:0.1124
Val metric mean prob: 0.2038
Best metric at: 0.4865 0.4830  0.7207
Cf: [[4626   40]
 [  55   45]]
Valid loss:0.1049
Val metric mean prob: 0.1898
Best metric at: 0.5198 0.4480  0.7267
Cf: [[4635   31]
 [  54   46]]
Valid loss:0.0869
Val metric mean prob: 0.2066
Best metric at: 0.4951 0.3030  0.7491
Cf: [[4611   55]
 [  49   51]]
Valid loss:0.1058
Val metric mean prob: 0.1907
Best metric at: 0.5227 0.4580  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.0831
Val metric mean prob: 0.2559
Best metric at: 0.4785 0.2620  0.7437
Cf: [[4607   59]
 [  50   50]]
Valid loss:0.1066
Val metric mean prob: 0.1925
Best metric at: 0.5000 0.4750  0.7119
Cf: [[4637   29]
 [  57   43]]
Valid loss:0.0921
Val metric mean prob: 0.1977
Best metric at: 0.5106 0.3660  0.7357
Cf: [[4626   40]
 [  52   48]]
Valid loss:0.1045
Val metric mean prob: 0.1907
Best metric at: 0.5172 0.4520  0.7219
Cf: [[4637   29]
 [  55   45]]
Valid loss:0.1056
Val metric mean prob: 0.1906
Best metric at: 0.5172 0.4590  0.7219
Cf: [[4637   29]
 [  55   45]]
Valid loss:0.1048
Val metric mean prob: 0.1873
Best metric at: 0.5169 0.4430  0.7266
Cf: [[4634   32]
 [  54   46]]
Valid loss:0.1020
Val metric mean prob: 0.1884
Best metric at: 0.5140 0.4280  0.7265
Cf: [[4633   33]
 [  54   46]]
Valid loss:0.1073
Val metric mean prob: 0.1934
Best metric at: 0.5000 0.4870  0.7072
Cf: [[4640   26]
 [  58   42]]
Valid loss:0.1048
Val metric mean prob: 0.1909
Best metric at: 0.5146 0.4640  0.7171
Cf: [[4639   27]
 [  56   44]]
Valid loss:0.1006
Val metric mean prob: 0.1903
Best metric at: 0.5056 0.4230  0.7215
Cf: [[4633   33]
 [  55   45]]
Valid loss:0.1019
Val metric mean prob: 0.1883
Best metric at: 0.5056 0.4270  0.7215
Cf: [[4633   33]
 [  55   45]]
Valid loss:0.1058
Val metric mean prob: 0.1903
Best metric at: 0.4945 0.4480  0.7210
Cf: [[4629   37]
 [  55   45]]
Valid loss:0.1082
Val metric mean prob: 0.1977
Best metric at: 0.4970 0.4990  0.7024
Cf: [[4642   24]
 [  59   41]]
Valid loss:0.1060
Val metric mean prob: 0.1903
Best metric at: 0.5054 0.4450  0.7308
Cf: [[4627   39]
 [  53   47]]
Valid loss:0.1044
Val metric mean prob: 0.1896
Best metric at: 0.5172 0.4500  0.7219
Cf: [[4637   29]
 [  55   45]]
Valid loss:0.1034
Val metric mean prob: 0.1872
Best metric at: 0.5111 0.4300  0.7264
Cf: [[4632   34]
 [  54   46]]
Valid loss:0.1005
Val metric mean prob: 0.1908
Best metric at: 0.5109 0.4170  0.7310
Cf: [[4629   37]
 [  53   47]]
Valid loss:0.1047
Val metric mean prob: 0.1889
Best metric at: 0.5169 0.4450  0.7266
Cf: [[4634   32]
 [  54   46]]
Valid loss:0.1025
Val metric mean prob: 0.1866
Best metric at: 0.5111 0.4270  0.7264
Cf: [[4632   34]
 [  54   46]]
Valid loss:0.1058
Val metric mean prob: 0.1887
Best metric at: 0.5083 0.4460  0.7262
Cf: [[4631   35]
 [  54   46]]
Valid loss:0.0995
Val metric mean prob: 0.1878
Best metric at: 0.5083 0.4110  0.7262
Cf: [[4631   35]
 [  54   46]]
Valid loss:0.1040
Val metric mean prob: 0.1861
Best metric at: 0.5146 0.4470  0.7171
Cf: [[4639   27]
 [  56   44]]
Valid loss:0.0962
Val metric mean prob: 0.2067
Best metric at: 0.5056 0.4250  0.7215
Cf: [[4633   33]
 [  55   45]]
Valid loss:0.1016
Val metric mean prob: 0.1854
Best metric at: 0.5140 0.4220  0.7265
Cf: [[4633   33]
 [  54   46]]
Valid loss:0.1055
Val metric mean prob: 0.1905
Best metric at: 0.5172 0.4580  0.7219
Cf: [[4637   29]
 [  55   45]]
Valid loss:0.1050
Val metric mean prob: 0.1880
Best metric at: 0.5165 0.4380  0.7312
Cf: [[4631   35]
 [  53   47]]
Valid loss:0.1068
Val metric mean prob: 0.1904
Best metric at: 0.5027 0.4480  0.7307
Cf: [[4626   40]
 [  53   47]]
Valid loss:0.1078
Val metric mean prob: 0.1951
Best metric at: 0.4971 0.4850  0.7118
Cf: [[4636   30]
 [  57   43]]
Valid loss:0.1053
Val metric mean prob: 0.1891
Best metric at: 0.5257 0.4540  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1067
Val metric mean prob: 0.1923
Best metric at: 0.4970 0.4820  0.7071
Cf: [[4639   27]
 [  58   42]]
Valid loss:0.0967
Val metric mean prob: 0.1932
Best metric at: 0.4976 0.3580  0.7492
Cf: [[4612   54]
 [  49   51]]
Valid loss:0.1015
Val metric mean prob: 0.1860
Best metric at: 0.5140 0.4210  0.7265
Cf: [[4633   33]
 [  54   46]]
Valid loss:0.1099
Val metric mean prob: 0.1993
Best metric at: 0.4881 0.5050  0.7021
Cf: [[4639   27]
 [  59   41]]
Valid loss:0.1060
Val metric mean prob: 0.1892
Best metric at: 0.5140 0.4510  0.7265
Cf: [[4633   33]
 [  54   46]]
Valid loss:0.1043
Val metric mean prob: 0.1888
Best metric at: 0.5169 0.4430  0.7266
Cf: [[4634   32]
 [  54   46]]
Valid loss:0.1060
Val metric mean prob: 0.1907
Best metric at: 0.5227 0.4580  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1073
Val metric mean prob: 0.1920
Best metric at: 0.5000 0.4510  0.7306
Cf: [[4625   41]
 [  53   47]]
Valid loss:0.1028
Val metric mean prob: 0.1863
Best metric at: 0.5111 0.4260  0.7264
Cf: [[4632   34]
 [  54   46]]
Date :02/24/2023, 10:32:04
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0840
Val metric mean prob: 0.2637
Best metric at: 0.5207 0.3710  0.7173
Cf: [[4641   25]
 [  56   44]]
Valid loss:0.0851
Val metric mean prob: 0.2432
Best metric at: 0.5029 0.3850  0.7120
Cf: [[4638   28]
 [  57   43]]
Valid loss:0.0847
Val metric mean prob: 0.2745
Best metric at: 0.5207 0.3610  0.7173
Cf: [[4641   25]
 [  56   44]]
Valid loss:0.0890
Val metric mean prob: 0.2216
Best metric at: 0.4970 0.4200  0.7024
Cf: [[4642   24]
 [  59   41]]
Valid loss:0.0988
Val metric mean prob: 0.1998
Best metric at: 0.5054 0.4140  0.7308
Cf: [[4627   39]
 [  53   47]]
Valid loss:0.0810
Val metric mean prob: 0.2310
Best metric at: 0.4811 0.2240  0.7485
Cf: [[4605   61]
 [  49   51]]
Valid loss:0.0892
Val metric mean prob: 0.2931
Best metric at: 0.5000 0.3780  0.7072
Cf: [[4640   26]
 [  58   42]]
Valid loss:0.0829
Val metric mean prob: 0.2492
Best metric at: 0.4834 0.2610  0.7486
Cf: [[4606   60]
 [  49   51]]
Valid loss:0.0930
Val metric mean prob: 0.2170
Best metric at: 0.4972 0.4190  0.7165
Cf: [[4633   33]
 [  56   44]]
Valid loss:0.1016
Val metric mean prob: 0.1953
Best metric at: 0.5222 0.4330  0.7315
Cf: [[4633   33]
 [  53   47]]
Valid loss:0.0815
Val metric mean prob: 0.2395
Best metric at: 0.4831 0.2450  0.7439
Cf: [[4609   57]
 [  50   50]]
Valid loss:0.0881
Val metric mean prob: 0.2369
Best metric at: 0.4805 0.4620  0.6832
Cf: [[4649   17]
 [  63   37]]
Valid loss:0.0844
Val metric mean prob: 0.2692
Best metric at: 0.4906 0.2580  0.7536
Cf: [[4606   60]
 [  48   52]]
Valid loss:0.0826
Val metric mean prob: 0.2329
Best metric at: 0.4804 0.2900  0.7391
Cf: [[4611   55]
 [  51   49]]
Valid loss:0.0930
Val metric mean prob: 0.2166
Best metric at: 0.4972 0.4180  0.7165
Cf: [[4633   33]
 [  56   44]]
Valid loss:0.0832
Val metric mean prob: 0.2562
Best metric at: 0.4785 0.2640  0.7437
Cf: [[4607   59]
 [  50   50]]
Valid loss:0.0867
Val metric mean prob: 0.2676
Best metric at: 0.5000 0.4710  0.6885
Cf: [[4652   14]
 [  62   38]]
Valid loss:0.0838
Val metric mean prob: 0.2513
Best metric at: 0.4839 0.3490  0.7206
Cf: [[4625   41]
 [  55   45]]
Valid loss:0.0841
Val metric mean prob: 0.2641
Best metric at: 0.4757 0.3460  0.7156
Cf: [[4625   41]
 [  56   44]]
Valid loss:0.0917
Val metric mean prob: 0.2851
Best metric at: 0.4686 0.3630  0.7014
Cf: [[4632   34]
 [  59   41]]
Valid loss:0.0858
Val metric mean prob: 0.2657
Best metric at: 0.4972 0.3780  0.7165
Cf: [[4633   33]
 [  56   44]]
Valid loss:0.0881
Val metric mean prob: 0.2685
Best metric at: 0.4967 0.4820  0.6884
Cf: [[4651   15]
 [  62   38]]
Valid loss:0.0857
Val metric mean prob: 0.2828
Best metric at: 0.4949 0.2900  0.7397
Cf: [[4617   49]
 [  51   49]]
Valid loss:0.0871
Val metric mean prob: 0.2295
Best metric at: 0.4925 0.3390  0.7396
Cf: [[4616   50]
 [  51   49]]
Valid loss:0.0870
Val metric mean prob: 0.2664
Best metric at: 0.5000 0.4730  0.6885
Cf: [[4652   14]
 [  62   38]]
Valid loss:0.0883
Val metric mean prob: 0.2482
Best metric at: 0.4935 0.4800  0.6883
Cf: [[4650   16]
 [  62   38]]
Valid loss:0.0872
Val metric mean prob: 0.2295
Best metric at: 0.4900 0.3350  0.7395
Cf: [[4615   51]
 [  51   49]]
Valid loss:0.0911
Val metric mean prob: 0.2352
Best metric at: 0.4903 0.4870  0.6882
Cf: [[4649   17]
 [  62   38]]
Valid loss:0.0913
Val metric mean prob: 0.2973
Best metric at: 0.4776 0.2910  0.7343
Cf: [[4613   53]
 [  52   48]]
Valid loss:0.0887
Val metric mean prob: 0.2168
Best metric at: 0.4948 0.3510  0.7351
Cf: [[4620   46]
 [  52   48]]
Valid loss:0.0875
Val metric mean prob: 0.2647
Best metric at: 0.4967 0.4750  0.6884
Cf: [[4651   15]
 [  62   38]]
Valid loss:0.0860
Val metric mean prob: 0.2583
Best metric at: 0.5057 0.3750  0.7168
Cf: [[4636   30]
 [  56   44]]
Valid loss:0.1085
Val metric mean prob: 0.1980
Best metric at: 0.5087 0.4910  0.7169
Cf: [[4637   29]
 [  56   44]]
Valid loss:0.0890
Val metric mean prob: 0.2453
Best metric at: 0.5029 0.4090  0.7167
Cf: [[4635   31]
 [  56   44]]
Valid loss:0.1018
Val metric mean prob: 0.2059
Best metric at: 0.5056 0.4610  0.7215
Cf: [[4633   33]
 [  55   45]]
Valid loss:0.1059
Val metric mean prob: 0.1942
Best metric at: 0.5257 0.4710  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.0872
Val metric mean prob: 0.2559
Best metric at: 0.5087 0.3910  0.7169
Cf: [[4637   29]
 [  56   44]]
Valid loss:0.1037
Val metric mean prob: 0.2006
Best metric at: 0.5202 0.4650  0.7220
Cf: [[4638   28]
 [  55   45]]
Valid loss:0.0880
Val metric mean prob: 0.2651
Best metric at: 0.5032 0.4750  0.6933
Cf: [[4650   16]
 [  61   39]]
Valid loss:0.0996
Val metric mean prob: 0.2084
Best metric at: 0.5085 0.4490  0.7216
Cf: [[4634   32]
 [  55   45]]
Valid loss:0.1004
Val metric mean prob: 0.2088
Best metric at: 0.5085 0.4500  0.7216
Cf: [[4634   32]
 [  55   45]]
Valid loss:0.1097
Val metric mean prob: 0.1979
Best metric at: 0.4970 0.4970  0.7071
Cf: [[4639   27]
 [  58   42]]
Valid loss:0.1065
Val metric mean prob: 0.1910
Best metric at: 0.5165 0.4500  0.7312
Cf: [[4631   35]
 [  53   47]]
Valid loss:0.1067
Val metric mean prob: 0.1921
Best metric at: 0.5165 0.4550  0.7312
Cf: [[4631   35]
 [  53   47]]
Valid loss:0.1126
Val metric mean prob: 0.2039
Best metric at: 0.4884 0.5050  0.7068
Cf: [[4636   30]
 [  58   42]]
Valid loss:0.0932
Val metric mean prob: 0.2292
Best metric at: 0.4938 0.4780  0.6976
Cf: [[4644   22]
 [  60   40]]
Valid loss:0.0924
Val metric mean prob: 0.2271
Best metric at: 0.4969 0.4660  0.6977
Cf: [[4645   21]
 [  60   40]]
Valid loss:0.1019
Val metric mean prob: 0.1907
Best metric at: 0.5028 0.4310  0.7214
Cf: [[4632   34]
 [  55   45]]
Valid loss:0.0918
Val metric mean prob: 0.2963
Best metric at: 0.4815 0.4210  0.6925
Cf: [[4643   23]
 [  61   39]]
Valid loss:0.1081
Val metric mean prob: 0.1943
Best metric at: 0.5089 0.4920  0.7122
Cf: [[4640   26]
 [  57   43]]
Valid loss:0.1039
Val metric mean prob: 0.1955
Best metric at: 0.5143 0.4590  0.7218
Cf: [[4636   30]
 [  55   45]]
Valid loss:0.0952
Val metric mean prob: 0.2170
Best metric at: 0.5085 0.4310  0.7216
Cf: [[4634   32]
 [  55   45]]
Valid loss:0.1067
Val metric mean prob: 0.1931
Best metric at: 0.5169 0.4700  0.7266
Cf: [[4634   32]
 [  54   46]]
Valid loss:0.1067
Val metric mean prob: 0.1936
Best metric at: 0.5227 0.4730  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1016
Val metric mean prob: 0.1975
Best metric at: 0.5085 0.4440  0.7216
Cf: [[4634   32]
 [  55   45]]
Valid loss:0.1045
Val metric mean prob: 0.1943
Best metric at: 0.5169 0.4560  0.7266
Cf: [[4634   32]
 [  54   46]]
Valid loss:0.1082
Val metric mean prob: 0.1936
Best metric at: 0.5119 0.4970  0.7123
Cf: [[4641   25]
 [  57   43]]
Valid loss:0.1056
Val metric mean prob: 0.1927
Best metric at: 0.5227 0.4660  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.0972
Val metric mean prob: 0.2101
Best metric at: 0.5169 0.4330  0.7266
Cf: [[4634   32]
 [  54   46]]
Valid loss:0.1060
Val metric mean prob: 0.1923
Best metric at: 0.5198 0.4630  0.7267
Cf: [[4635   31]
 [  54   46]]
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Date :02/24/2023, 14:16:56
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Val metric mean prob: 0.2763
Best metric at epoch 1: 0.4853 0.4540  0.6849
Val metric mean prob: 0.2763
Val metric mean prob: 0.2763
Val metric mean prob: 0.2763
Val metric mean prob: 0.2763
Val metric mean prob: 0.2763
Best metric at epoch 1: 0.4853 0.4540  0.6849
Val metric mean prob: 0.2763
Best metric at epoch 1: 0.4853 0.4535  0.6849
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0860
Val metric mean prob: 0.2583
Best metric at: 0.5057 0.3750  0.7168
Cf: [[4636   30]
 [  56   44]]
Valid loss:0.1085
Val metric mean prob: 0.1980
Best metric at: 0.5087 0.4910  0.7169
Cf: [[4637   29]
 [  56   44]]
Valid loss:0.0890
Val metric mean prob: 0.2453
Best metric at: 0.5029 0.4090  0.7167
Cf: [[4635   31]
 [  56   44]]
Valid loss:0.1018
Val metric mean prob: 0.2059
Best metric at: 0.5056 0.4610  0.7215
Cf: [[4633   33]
 [  55   45]]
Valid loss:0.1059
Val metric mean prob: 0.1942
Best metric at: 0.5257 0.4710  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.0872
Val metric mean prob: 0.2559
Best metric at: 0.5087 0.3910  0.7169
Cf: [[4637   29]
 [  56   44]]
Valid loss:0.1037
Val metric mean prob: 0.2006
Best metric at: 0.5202 0.4650  0.7220
Cf: [[4638   28]
 [  55   45]]
Valid loss:0.0880
Val metric mean prob: 0.2651
Best metric at: 0.5032 0.4750  0.6933
Cf: [[4650   16]
 [  61   39]]
Valid loss:0.0996
Val metric mean prob: 0.2084
Best metric at: 0.5085 0.4490  0.7216
Cf: [[4634   32]
 [  55   45]]
Valid loss:0.1004
Val metric mean prob: 0.2088
Best metric at: 0.5085 0.4500  0.7216
Cf: [[4634   32]
 [  55   45]]
Valid loss:0.1097
Val metric mean prob: 0.1979
Best metric at: 0.4970 0.4970  0.7071
Cf: [[4639   27]
 [  58   42]]
Valid loss:0.1065
Val metric mean prob: 0.1910
Best metric at: 0.5165 0.4500  0.7312
Cf: [[4631   35]
 [  53   47]]
Valid loss:0.1067
Val metric mean prob: 0.1921
Best metric at: 0.5165 0.4550  0.7312
Cf: [[4631   35]
 [  53   47]]
Valid loss:0.1126
Val metric mean prob: 0.2039
Best metric at: 0.4884 0.5050  0.7068
Cf: [[4636   30]
 [  58   42]]
Valid loss:0.0932
Val metric mean prob: 0.2292
Best metric at: 0.4938 0.4780  0.6976
Cf: [[4644   22]
 [  60   40]]
Valid loss:0.0924
Val metric mean prob: 0.2271
Best metric at: 0.4969 0.4660  0.6977
Cf: [[4645   21]
 [  60   40]]
Valid loss:0.1019
Val metric mean prob: 0.1907
Best metric at: 0.5028 0.4310  0.7214
Cf: [[4632   34]
 [  55   45]]
Valid loss:0.0918
Val metric mean prob: 0.2963
Best metric at: 0.4815 0.4210  0.6925
Cf: [[4643   23]
 [  61   39]]
Valid loss:0.1081
Val metric mean prob: 0.1943
Best metric at: 0.5089 0.4920  0.7122
Cf: [[4640   26]
 [  57   43]]
Valid loss:0.1039
Val metric mean prob: 0.1955
Best metric at: 0.5143 0.4590  0.7218
Cf: [[4636   30]
 [  55   45]]
Valid loss:0.0952
Val metric mean prob: 0.2170
Best metric at: 0.5085 0.4310  0.7216
Cf: [[4634   32]
 [  55   45]]
Valid loss:0.1067
Val metric mean prob: 0.1931
Best metric at: 0.5169 0.4700  0.7266
Cf: [[4634   32]
 [  54   46]]
Valid loss:0.1067
Val metric mean prob: 0.1936
Best metric at: 0.5227 0.4730  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1016
Val metric mean prob: 0.1975
Best metric at: 0.5085 0.4440  0.7216
Cf: [[4634   32]
 [  55   45]]
Valid loss:0.1045
Val metric mean prob: 0.1943
Best metric at: 0.5169 0.4560  0.7266
Cf: [[4634   32]
 [  54   46]]
Valid loss:0.1082
Val metric mean prob: 0.1936
Best metric at: 0.5119 0.4970  0.7123
Cf: [[4641   25]
 [  57   43]]
Valid loss:0.1056
Val metric mean prob: 0.1927
Best metric at: 0.5227 0.4660  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.0972
Val metric mean prob: 0.2101
Best metric at: 0.5169 0.4330  0.7266
Cf: [[4634   32]
 [  54   46]]
Valid loss:0.1060
Val metric mean prob: 0.1923
Best metric at: 0.5198 0.4630  0.7267
Cf: [[4635   31]
 [  54   46]]
Valid loss:0.1080
Val metric mean prob: 0.1939
Best metric at: 0.5119 0.4960  0.7123
Cf: [[4641   25]
 [  57   43]]
Valid loss:0.1091
Val metric mean prob: 0.1952
Best metric at: 0.5087 0.4870  0.7169
Cf: [[4637   29]
 [  56   44]]
Valid loss:0.1054
Val metric mean prob: 0.1952
Best metric at: 0.5227 0.4680  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1071
Val metric mean prob: 0.1932
Best metric at: 0.5146 0.4880  0.7171
Cf: [[4639   27]
 [  56   44]]
Valid loss:0.1055
Val metric mean prob: 0.1944
Best metric at: 0.5227 0.4670  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1026
Val metric mean prob: 0.1981
Best metric at: 0.5109 0.4390  0.7310
Cf: [[4629   37]
 [  53   47]]
Valid loss:0.1049
Val metric mean prob: 0.1940
Best metric at: 0.5227 0.4620  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1014
Val metric mean prob: 0.1976
Best metric at: 0.5143 0.4460  0.7218
Cf: [[4636   30]
 [  55   45]]
Valid loss:0.1075
Val metric mean prob: 0.1942
Best metric at: 0.5114 0.4800  0.7217
Cf: [[4635   31]
 [  55   45]]
Valid loss:0.1087
Val metric mean prob: 0.1957
Best metric at: 0.5146 0.4920  0.7171
Cf: [[4639   27]
 [  56   44]]
Valid loss:0.1059
Val metric mean prob: 0.1930
Best metric at: 0.5227 0.4670  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1037
Val metric mean prob: 0.1966
Best metric at: 0.5143 0.4610  0.7218
Cf: [[4636   30]
 [  55   45]]
Valid loss:0.1056
Val metric mean prob: 0.1940
Best metric at: 0.5227 0.4670  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1073
Val metric mean prob: 0.1932
Best metric at: 0.5114 0.4770  0.7217
Cf: [[4635   31]
 [  55   45]]
Valid loss:0.1045
Val metric mean prob: 0.1951
Best metric at: 0.5143 0.4600  0.7218
Cf: [[4636   30]
 [  55   45]]
Valid loss:0.1011
Val metric mean prob: 0.2011
Best metric at: 0.5111 0.4420  0.7264
Cf: [[4632   34]
 [  54   46]]
Valid loss:0.1058
Val metric mean prob: 0.1931
Best metric at: 0.5227 0.4680  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.0987
Val metric mean prob: 0.2070
Best metric at: 0.5085 0.4410  0.7216
Cf: [[4634   32]
 [  55   45]]
Valid loss:0.1030
Val metric mean prob: 0.1952
Best metric at: 0.5165 0.4440  0.7312
Cf: [[4631   35]
 [  53   47]]
Valid loss:0.1068
Val metric mean prob: 0.1931
Best metric at: 0.5227 0.4720  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1076
Val metric mean prob: 0.1940
Best metric at: 0.5114 0.4800  0.7217
Cf: [[4635   31]
 [  55   45]]
Valid loss:0.1084
Val metric mean prob: 0.1957
Best metric at: 0.5116 0.4890  0.7170
Cf: [[4638   28]
 [  56   44]]
Valid loss:0.1061
Val metric mean prob: 0.1936
Best metric at: 0.5257 0.4720  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1067
Val metric mean prob: 0.1939
Best metric at: 0.5227 0.4740  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1052
Val metric mean prob: 0.1947
Best metric at: 0.5227 0.4650  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1039
Val metric mean prob: 0.1968
Best metric at: 0.5143 0.4640  0.7218
Cf: [[4636   30]
 [  55   45]]
Valid loss:0.1066
Val metric mean prob: 0.1938
Best metric at: 0.5227 0.4740  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1023
Val metric mean prob: 0.1963
Best metric at: 0.5140 0.4470  0.7265
Cf: [[4633   33]
 [  54   46]]
Valid loss:0.1047
Val metric mean prob: 0.1944
Best metric at: 0.5227 0.4600  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.0999
Val metric mean prob: 0.2050
Best metric at: 0.5111 0.4410  0.7264
Cf: [[4632   34]
 [  54   46]]
Valid loss:0.1079
Val metric mean prob: 0.1953
Best metric at: 0.5087 0.4870  0.7169
Cf: [[4637   29]
 [  56   44]]
Valid loss:0.1094
Val metric mean prob: 0.1977
Best metric at: 0.5059 0.4970  0.7121
Cf: [[4639   27]
 [  57   43]]
Valid loss:0.1050
Val metric mean prob: 0.1949
Best metric at: 0.5198 0.4630  0.7267
Cf: [[4635   31]
 [  54   46]]
Valid loss:0.1060
Val metric mean prob: 0.1932
Best metric at: 0.5257 0.4710  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1062
Val metric mean prob: 0.1938
Best metric at: 0.5257 0.4730  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1065
Val metric mean prob: 0.1931
Best metric at: 0.5227 0.4700  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1072
Val metric mean prob: 0.1939
Best metric at: 0.5146 0.4870  0.7171
Cf: [[4639   27]
 [  56   44]]
Valid loss:0.1082
Val metric mean prob: 0.1950
Best metric at: 0.5116 0.4880  0.7170
Cf: [[4638   28]
 [  56   44]]
Valid loss:0.1034
Val metric mean prob: 0.1960
Best metric at: 0.5143 0.4580  0.7218
Cf: [[4636   30]
 [  55   45]]
Valid loss:0.1070
Val metric mean prob: 0.1941
Best metric at: 0.5176 0.4900  0.7172
Cf: [[4640   26]
 [  56   44]]
Valid loss:0.1063
Val metric mean prob: 0.1941
Best metric at: 0.5257 0.4740  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1063
Val metric mean prob: 0.1943
Best metric at: 0.5257 0.4750  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1062
Val metric mean prob: 0.1941
Best metric at: 0.5257 0.4740  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1065
Val metric mean prob: 0.1940
Best metric at: 0.5227 0.4720  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1083
Val metric mean prob: 0.1966
Best metric at: 0.5146 0.4960  0.7171
Cf: [[4639   27]
 [  56   44]]
Valid loss:0.1074
Val metric mean prob: 0.1958
Best metric at: 0.5172 0.4840  0.7219
Cf: [[4637   29]
 [  55   45]]
Valid loss:0.1061
Val metric mean prob: 0.1942
Best metric at: 0.5257 0.4720  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1062
Val metric mean prob: 0.1942
Best metric at: 0.5257 0.4720  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1042
Val metric mean prob: 0.1964
Best metric at: 0.5143 0.4660  0.7218
Cf: [[4636   30]
 [  55   45]]
Valid loss:0.1070
Val metric mean prob: 0.1945
Best metric at: 0.5176 0.4900  0.7172
Cf: [[4640   26]
 [  56   44]]
Valid loss:0.1061
Val metric mean prob: 0.1946
Best metric at: 0.5257 0.4720  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1083
Val metric mean prob: 0.1967
Best metric at: 0.5116 0.4910  0.7170
Cf: [[4638   28]
 [  56   44]]
Valid loss:0.1058
Val metric mean prob: 0.1946
Best metric at: 0.5257 0.4740  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1047
Val metric mean prob: 0.1943
Best metric at: 0.5227 0.4600  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1062
Val metric mean prob: 0.1936
Best metric at: 0.5257 0.4720  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1074
Val metric mean prob: 0.1956
Best metric at: 0.5143 0.4820  0.7218
Cf: [[4636   30]
 [  55   45]]
Valid loss:0.1068
Val metric mean prob: 0.1938
Best metric at: 0.5227 0.4740  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1078
Val metric mean prob: 0.1957
Best metric at: 0.5087 0.4870  0.7169
Cf: [[4637   29]
 [  56   44]]
Valid loss:0.1050
Val metric mean prob: 0.1935
Best metric at: 0.5198 0.4600  0.7267
Cf: [[4635   31]
 [  54   46]]
Valid loss:0.1071
Val metric mean prob: 0.1948
Best metric at: 0.5176 0.4900  0.7172
Cf: [[4640   26]
 [  56   44]]
Valid loss:0.1036
Val metric mean prob: 0.1966
Best metric at: 0.5143 0.4610  0.7218
Cf: [[4636   30]
 [  55   45]]
Valid loss:0.1062
Val metric mean prob: 0.1946
Best metric at: 0.5257 0.4730  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1054
Val metric mean prob: 0.1947
Best metric at: 0.5227 0.4670  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1059
Val metric mean prob: 0.1945
Best metric at: 0.5257 0.4730  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1069
Val metric mean prob: 0.1942
Best metric at: 0.5227 0.4760  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1046
Val metric mean prob: 0.1954
Best metric at: 0.5198 0.4600  0.7267
Cf: [[4635   31]
 [  54   46]]
Valid loss:0.1059
Val metric mean prob: 0.1951
Best metric at: 0.5257 0.4740  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1065
Val metric mean prob: 0.1940
Best metric at: 0.5257 0.4750  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1076
Val metric mean prob: 0.1955
Best metric at: 0.5172 0.4840  0.7219
Cf: [[4637   29]
 [  55   45]]
Valid loss:0.1036
Val metric mean prob: 0.1948
Best metric at: 0.5165 0.4470  0.7312
Cf: [[4631   35]
 [  53   47]]
Valid loss:0.1024
Val metric mean prob: 0.1975
Best metric at: 0.5109 0.4380  0.7310
Cf: [[4629   37]
 [  53   47]]
Valid loss:0.1051
Val metric mean prob: 0.1953
Best metric at: 0.5227 0.4660  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1056
Val metric mean prob: 0.1950
Best metric at: 0.5227 0.4700  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1067
Val metric mean prob: 0.1944
Best metric at: 0.5257 0.4770  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1069
Val metric mean prob: 0.1945
Best metric at: 0.5227 0.4780  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1056
Val metric mean prob: 0.1946
Best metric at: 0.5227 0.4680  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1073
Val metric mean prob: 0.1955
Best metric at: 0.5172 0.4860  0.7219
Cf: [[4637   29]
 [  55   45]]
Valid loss:0.1048
Val metric mean prob: 0.1930
Best metric at: 0.5198 0.4570  0.7267
Cf: [[4635   31]
 [  54   46]]
Valid loss:0.1065
Val metric mean prob: 0.1937
Best metric at: 0.5257 0.4750  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1081
Val metric mean prob: 0.1966
Best metric at: 0.5116 0.4940  0.7170
Cf: [[4638   28]
 [  56   44]]
Valid loss:0.1054
Val metric mean prob: 0.1949
Best metric at: 0.5227 0.4680  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1041
Val metric mean prob: 0.1952
Best metric at: 0.5169 0.4560  0.7266
Cf: [[4634   32]
 [  54   46]]
Valid loss:0.1062
Val metric mean prob: 0.1935
Best metric at: 0.5257 0.4710  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1068
Val metric mean prob: 0.1945
Best metric at: 0.5227 0.4760  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1073
Val metric mean prob: 0.1946
Best metric at: 0.5146 0.4880  0.7171
Cf: [[4639   27]
 [  56   44]]
Valid loss:0.1063
Val metric mean prob: 0.1933
Best metric at: 0.5257 0.4730  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1048
Val metric mean prob: 0.1939
Best metric at: 0.5169 0.4590  0.7266
Cf: [[4634   32]
 [  54   46]]
Valid loss:0.1068
Val metric mean prob: 0.1944
Best metric at: 0.5227 0.4760  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1078
Val metric mean prob: 0.1955
Best metric at: 0.5087 0.4860  0.7169
Cf: [[4637   29]
 [  56   44]]
Valid loss:0.1058
Val metric mean prob: 0.1926
Best metric at: 0.5198 0.4630  0.7267
Cf: [[4635   31]
 [  54   46]]
Valid loss:0.1033
Val metric mean prob: 0.1978
Best metric at: 0.5114 0.4600  0.7217
Cf: [[4635   31]
 [  55   45]]
Valid loss:0.1047
Val metric mean prob: 0.1950
Best metric at: 0.5198 0.4600  0.7267
Cf: [[4635   31]
 [  54   46]]
Valid loss:0.1062
Val metric mean prob: 0.1947
Best metric at: 0.5257 0.4730  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1064
Val metric mean prob: 0.1943
Best metric at: 0.5257 0.4750  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1071
Val metric mean prob: 0.1949
Best metric at: 0.5198 0.4760  0.7267
Cf: [[4635   31]
 [  54   46]]
Valid loss:0.1054
Val metric mean prob: 0.1950
Best metric at: 0.5227 0.4670  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1061
Val metric mean prob: 0.1940
Best metric at: 0.5257 0.4720  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1042
Val metric mean prob: 0.1962
Best metric at: 0.5143 0.4660  0.7218
Cf: [[4636   30]
 [  55   45]]
Valid loss:0.1068
Val metric mean prob: 0.1945
Best metric at: 0.5257 0.4790  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1073
Val metric mean prob: 0.1950
Best metric at: 0.5176 0.4910  0.7172
Cf: [[4640   26]
 [  56   44]]
Valid loss:0.1054
Val metric mean prob: 0.1943
Best metric at: 0.5227 0.4650  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1076
Val metric mean prob: 0.1958
Best metric at: 0.5087 0.4860  0.7169
Cf: [[4637   29]
 [  56   44]]
Valid loss:0.1057
Val metric mean prob: 0.1948
Best metric at: 0.5227 0.4690  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1062
Val metric mean prob: 0.1938
Best metric at: 0.5257 0.4740  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1069
Val metric mean prob: 0.1949
Best metric at: 0.5287 0.4820  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1069
Val metric mean prob: 0.1951
Best metric at: 0.5287 0.4820  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1072
Val metric mean prob: 0.1949
Best metric at: 0.5176 0.4900  0.7172
Cf: [[4640   26]
 [  56   44]]
Valid loss:0.1068
Val metric mean prob: 0.1951
Best metric at: 0.5287 0.4810  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1067
Val metric mean prob: 0.1948
Best metric at: 0.5287 0.4790  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1069
Val metric mean prob: 0.1951
Best metric at: 0.5287 0.4820  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1069
Val metric mean prob: 0.1951
Best metric at: 0.5287 0.4810  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1078
Val metric mean prob: 0.1962
Best metric at: 0.5116 0.4900  0.7170
Cf: [[4638   28]
 [  56   44]]
Valid loss:0.1069
Val metric mean prob: 0.1951
Best metric at: 0.5287 0.4810  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1068
Val metric mean prob: 0.1951
Best metric at: 0.5287 0.4810  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1069
Val metric mean prob: 0.1951
Best metric at: 0.5287 0.4830  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1073
Val metric mean prob: 0.1961
Best metric at: 0.5172 0.4850  0.7219
Cf: [[4637   29]
 [  55   45]]
Valid loss:0.1069
Val metric mean prob: 0.1950
Best metric at: 0.5257 0.4800  0.7269
Cf: [[4637   29]
 [  54   46]]
Valid loss:0.1084
Val metric mean prob: 0.1967
Best metric at: 0.5116 0.4930  0.7170
Cf: [[4638   28]
 [  56   44]]
Valid loss:0.1070
Val metric mean prob: 0.1957
Best metric at: 0.5287 0.4840  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1074
Val metric mean prob: 0.1963
Best metric at: 0.5202 0.4900  0.7220
Cf: [[4638   28]
 [  55   45]]
Valid loss:0.1080
Val metric mean prob: 0.1965
Best metric at: 0.5116 0.4930  0.7170
Cf: [[4638   28]
 [  56   44]]
Valid loss:0.1070
Val metric mean prob: 0.1955
Best metric at: 0.5287 0.4840  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1069
Val metric mean prob: 0.1954
Best metric at: 0.5287 0.4820  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1070
Val metric mean prob: 0.1955
Best metric at: 0.5287 0.4830  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1070
Val metric mean prob: 0.1956
Best metric at: 0.5287 0.4830  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1071
Val metric mean prob: 0.1956
Best metric at: 0.5227 0.4810  0.7268
Cf: [[4636   30]
 [  54   46]]
Valid loss:0.1070
Val metric mean prob: 0.1957
Best metric at: 0.5287 0.4830  0.7270
Cf: [[4638   28]
 [  54   46]]
Valid loss:0.1074
Val metric mean prob: 0.1962
Best metric at: 0.5172 0.4850  0.7219
Cf: [[4637   29]
 [  55   45]]
Valid loss:0.1068
Val metric mean prob: 0.1957
Best metric at: 0.5287 0.4820  0.7270
Cf: [[4638   28]
 [  54   46]]
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1020
Val metric mean prob: 0.1942
Best metric at: 0.4953 0.3280  0.7441
Cf: [[4607   55]
 [  53   53]]
Valid loss:0.1239
Val metric mean prob: 0.1551
Best metric at: 0.4712 0.4070  0.7080
Cf: [[4622   40]
 [  61   45]]
Valid loss:0.1101
Val metric mean prob: 0.1693
Best metric at: 0.4884 0.4030  0.6955
Cf: [[4638   24]
 [  64   42]]
Valid loss:0.1284
Val metric mean prob: 0.1377
Best metric at: 0.4949 0.3600  0.7265
Cf: [[4619   43]
 [  57   49]]
Valid loss:0.0986
Val metric mean prob: 0.2049
Best metric at: 0.5000 0.4200  0.7048
Cf: [[4636   26]
 [  62   44]]
Valid loss:0.1176
Val metric mean prob: 0.1590
Best metric at: 0.4828 0.4120  0.6953
Cf: [[4636   26]
 [  64   42]]
Valid loss:0.1254
Val metric mean prob: 0.1471
Best metric at: 0.4831 0.3630  0.7304
Cf: [[4611   51]
 [  56   50]]
Valid loss:0.1125
Val metric mean prob: 0.1726
Best metric at: 0.4953 0.3590  0.7441
Cf: [[4607   55]
 [  53   53]]
Valid loss:0.1199
Val metric mean prob: 0.1557
Best metric at: 0.4809 0.4030  0.7040
Cf: [[4629   33]
 [  62   44]]
Valid loss:0.1213
Val metric mean prob: 0.1604
Best metric at: 0.4975 0.4100  0.7266
Cf: [[4620   42]
 [  57   49]]
Valid loss:0.0911
Val metric mean prob: 0.2353
Best metric at: 0.5060 0.3810  0.6962
Cf: [[4644   18]
 [  64   42]]
Valid loss:0.0919
Val metric mean prob: 0.2220
Best metric at: 0.4918 0.3250  0.7088
Cf: [[4630   32]
 [  61   45]]
Valid loss:0.0921
Val metric mean prob: 0.2230
Best metric at: 0.5000 0.3660  0.7048
Cf: [[4636   26]
 [  62   44]]
Valid loss:0.0942
Val metric mean prob: 0.2129
Best metric at: 0.4944 0.3720  0.7045
Cf: [[4634   28]
 [  62   44]]
Valid loss:0.0957
Val metric mean prob: 0.2071
Best metric at: 0.4916 0.3750  0.7044
Cf: [[4633   29]
 [  62   44]]
Valid loss:0.1356
Val metric mean prob: 0.1333
Best metric at: 0.5053 0.3870  0.7226
Cf: [[4626   36]
 [  58   48]]
Valid loss:0.1380
Val metric mean prob: 0.1280
Best metric at: 0.5027 0.3790  0.7181
Cf: [[4628   34]
 [  59   47]]
Valid loss:0.1389
Val metric mean prob: 0.1285
Best metric at: 0.5000 0.3790  0.7223
Cf: [[4624   38]
 [  58   48]]
Valid loss:0.0970
Val metric mean prob: 0.2046
Best metric at: 0.4944 0.3870  0.7045
Cf: [[4634   28]
 [  62   44]]
Valid loss:0.0914
Val metric mean prob: 0.2272
Best metric at: 0.4855 0.3310  0.6954
Cf: [[4637   25]
 [  64   42]]
Valid loss:0.1085
Val metric mean prob: 0.1915
Best metric at: 0.4818 0.3690  0.7435
Cf: [[4601   61]
 [  53   53]]
Valid loss:0.0949
Val metric mean prob: 0.3004
Best metric at: 0.4817 0.3860  0.7128
Cf: [[4623   39]
 [  60   46]]
Valid loss:0.1298
Val metric mean prob: 0.1402
Best metric at: 0.5052 0.3810  0.7269
Cf: [[4623   39]
 [  57   49]]
Valid loss:0.1189
Val metric mean prob: 0.1589
Best metric at: 0.5055 0.4130  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1145
Val metric mean prob: 0.1670
Best metric at: 0.4972 0.4070  0.7090
Cf: [[4632   30]
 [  61   45]]
Valid loss:0.1027
Val metric mean prob: 0.1901
Best metric at: 0.4971 0.4090  0.7003
Cf: [[4638   24]
 [  63   43]]
Valid loss:0.1258
Val metric mean prob: 0.1460
Best metric at: 0.5081 0.3950  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1290
Val metric mean prob: 0.1416
Best metric at: 0.5055 0.4000  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1121
Val metric mean prob: 0.1686
Best metric at: 0.5056 0.3990  0.7094
Cf: [[4635   27]
 [  61   45]]
Valid loss:0.1093
Val metric mean prob: 0.1745
Best metric at: 0.4944 0.4010  0.7045
Cf: [[4634   28]
 [  62   44]]
Valid loss:0.0938
Val metric mean prob: 0.2187
Best metric at: 0.5000 0.4030  0.7004
Cf: [[4639   23]
 [  63   43]]
Valid loss:0.1253
Val metric mean prob: 0.1459
Best metric at: 0.5081 0.3910  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1048
Val metric mean prob: 0.1851
Best metric at: 0.4920 0.3860  0.7132
Cf: [[4627   35]
 [  60   46]]
Valid loss:0.1305
Val metric mean prob: 0.1363
Best metric at: 0.5027 0.3770  0.7181
Cf: [[4628   34]
 [  59   47]]
Valid loss:0.1101
Val metric mean prob: 0.1736
Best metric at: 0.4972 0.4040  0.7047
Cf: [[4635   27]
 [  62   44]]
Valid loss:0.0992
Val metric mean prob: 0.1993
Best metric at: 0.4971 0.4040  0.7003
Cf: [[4638   24]
 [  63   43]]
Valid loss:0.1261
Val metric mean prob: 0.1433
Best metric at: 0.5027 0.3890  0.7137
Cf: [[4631   31]
 [  60   46]]
Valid loss:0.1136
Val metric mean prob: 0.1654
Best metric at: 0.5028 0.3990  0.7093
Cf: [[4634   28]
 [  61   45]]
Valid loss:0.1340
Val metric mean prob: 0.1340
Best metric at: 0.5079 0.3820  0.7227
Cf: [[4627   35]
 [  58   48]]
Valid loss:0.1329
Val metric mean prob: 0.1374
Best metric at: 0.5000 0.3910  0.7179
Cf: [[4627   35]
 [  59   47]]
Valid loss:0.1249
Val metric mean prob: 0.1478
Best metric at: 0.5081 0.3980  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1257
Val metric mean prob: 0.1462
Best metric at: 0.5081 0.3950  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1221
Val metric mean prob: 0.1522
Best metric at: 0.5081 0.4000  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1239
Val metric mean prob: 0.1488
Best metric at: 0.5055 0.3970  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1170
Val metric mean prob: 0.1604
Best metric at: 0.5000 0.4050  0.7092
Cf: [[4633   29]
 [  61   45]]
Valid loss:0.1214
Val metric mean prob: 0.1542
Best metric at: 0.5081 0.4040  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1146
Val metric mean prob: 0.1649
Best metric at: 0.5028 0.4060  0.7093
Cf: [[4634   28]
 [  61   45]]
Valid loss:0.1230
Val metric mean prob: 0.1524
Best metric at: 0.5081 0.4100  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1390
Val metric mean prob: 0.1235
Best metric at: 0.4851 0.3490  0.7261
Cf: [[4615   47]
 [  57   49]]
Valid loss:0.1265
Val metric mean prob: 0.1444
Best metric at: 0.5027 0.3870  0.7181
Cf: [[4628   34]
 [  59   47]]
Valid loss:0.1255
Val metric mean prob: 0.1488
Best metric at: 0.5081 0.4080  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1232
Val metric mean prob: 0.1511
Best metric at: 0.5081 0.4020  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1099
Val metric mean prob: 0.1746
Best metric at: 0.5000 0.4100  0.7048
Cf: [[4636   26]
 [  62   44]]
Valid loss:0.1214
Val metric mean prob: 0.1536
Best metric at: 0.5081 0.4000  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1354
Val metric mean prob: 0.1339
Best metric at: 0.5026 0.3850  0.7224
Cf: [[4625   37]
 [  58   48]]
Valid loss:0.1178
Val metric mean prob: 0.1599
Best metric at: 0.5055 0.4060  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1141
Val metric mean prob: 0.1656
Best metric at: 0.5056 0.4040  0.7094
Cf: [[4635   27]
 [  61   45]]
Valid loss:0.1250
Val metric mean prob: 0.1487
Best metric at: 0.5081 0.4030  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1369
Val metric mean prob: 0.1329
Best metric at: 0.5053 0.3880  0.7226
Cf: [[4626   36]
 [  58   48]]
Valid loss:0.1378
Val metric mean prob: 0.1276
Best metric at: 0.4974 0.3750  0.7178
Cf: [[4626   36]
 [  59   47]]
Valid loss:0.1230
Val metric mean prob: 0.1508
Best metric at: 0.5081 0.4000  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1262
Val metric mean prob: 0.1473
Best metric at: 0.5109 0.4060  0.7184
Cf: [[4631   31]
 [  59   47]]
Valid loss:0.1280
Val metric mean prob: 0.1438
Best metric at: 0.5081 0.4000  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1341
Val metric mean prob: 0.1361
Best metric at: 0.5026 0.3810  0.7268
Cf: [[4622   40]
 [  57   49]]
Valid loss:0.1178
Val metric mean prob: 0.1596
Best metric at: 0.5000 0.4020  0.7135
Cf: [[4630   32]
 [  60   46]]
Valid loss:0.1199
Val metric mean prob: 0.1565
Best metric at: 0.5081 0.4040  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1086
Val metric mean prob: 0.1765
Best metric at: 0.4972 0.4030  0.7090
Cf: [[4632   30]
 [  61   45]]
Valid loss:0.1210
Val metric mean prob: 0.1555
Best metric at: 0.5000 0.3940  0.7223
Cf: [[4624   38]
 [  58   48]]
Valid loss:0.1212
Val metric mean prob: 0.1545
Best metric at: 0.5081 0.4020  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1000
Val metric mean prob: 0.1973
Best metric at: 0.5000 0.4000  0.7048
Cf: [[4636   26]
 [  62   44]]
Valid loss:0.1388
Val metric mean prob: 0.1158
Best metric at: 0.4828 0.3180  0.7260
Cf: [[4614   48]
 [  57   49]]
Valid loss:0.1265
Val metric mean prob: 0.1464
Best metric at: 0.5055 0.4040  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1290
Val metric mean prob: 0.1435
Best metric at: 0.5027 0.4000  0.7181
Cf: [[4628   34]
 [  59   47]]
Valid loss:0.1133
Val metric mean prob: 0.1680
Best metric at: 0.5000 0.4080  0.7092
Cf: [[4633   29]
 [  61   45]]
Valid loss:0.1338
Val metric mean prob: 0.1338
Best metric at: 0.4974 0.3780  0.7222
Cf: [[4623   39]
 [  58   48]]
Valid loss:0.1244
Val metric mean prob: 0.1478
Best metric at: 0.5109 0.3940  0.7184
Cf: [[4631   31]
 [  59   47]]
Valid loss:0.1130
Val metric mean prob: 0.1677
Best metric at: 0.5029 0.4050  0.7049
Cf: [[4637   25]
 [  62   44]]
Valid loss:0.1269
Val metric mean prob: 0.1428
Best metric at: 0.5055 0.3950  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1046
Val metric mean prob: 0.1855
Best metric at: 0.4920 0.3880  0.7132
Cf: [[4627   35]
 [  60   46]]
Valid loss:0.1151
Val metric mean prob: 0.1643
Best metric at: 0.4972 0.4040  0.7090
Cf: [[4632   30]
 [  61   45]]
Valid loss:0.1313
Val metric mean prob: 0.1356
Best metric at: 0.5027 0.3790  0.7181
Cf: [[4628   34]
 [  59   47]]
Valid loss:0.1246
Val metric mean prob: 0.1488
Best metric at: 0.5081 0.4020  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1301
Val metric mean prob: 0.1399
Best metric at: 0.5052 0.3810  0.7269
Cf: [[4623   39]
 [  57   49]]
Valid loss:0.1407
Val metric mean prob: 0.1172
Best metric at: 0.4862 0.3210  0.7437
Cf: [[4603   59]
 [  53   53]]
Valid loss:0.1223
Val metric mean prob: 0.1520
Best metric at: 0.5081 0.3980  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1124
Val metric mean prob: 0.1695
Best metric at: 0.5000 0.4090  0.7048
Cf: [[4636   26]
 [  62   44]]
Valid loss:0.1208
Val metric mean prob: 0.1544
Best metric at: 0.5081 0.4000  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1365
Val metric mean prob: 0.1271
Best metric at: 0.4950 0.3540  0.7309
Cf: [[4616   46]
 [  56   50]]
Valid loss:0.1276
Val metric mean prob: 0.1437
Best metric at: 0.5055 0.4000  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1148
Val metric mean prob: 0.1654
Best metric at: 0.5000 0.4060  0.7092
Cf: [[4633   29]
 [  61   45]]
Valid loss:0.1082
Val metric mean prob: 0.1776
Best metric at: 0.4971 0.4110  0.7003
Cf: [[4638   24]
 [  63   43]]
Valid loss:0.1304
Val metric mean prob: 0.1411
Best metric at: 0.5000 0.3970  0.7179
Cf: [[4627   35]
 [  59   47]]
Valid loss:0.1299
Val metric mean prob: 0.1409
Best metric at: 0.5055 0.4020  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1319
Val metric mean prob: 0.1394
Best metric at: 0.4974 0.3940  0.7178
Cf: [[4626   36]
 [  59   47]]
Valid loss:0.1267
Val metric mean prob: 0.1460
Best metric at: 0.5081 0.4020  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1267
Val metric mean prob: 0.1441
Best metric at: 0.5055 0.3970  0.7138
Cf: [[4632   30]
 [  60   46]]
Valid loss:0.1337
Val metric mean prob: 0.1365
Best metric at: 0.5000 0.3850  0.7223
Cf: [[4624   38]
 [  58   48]]
Valid loss:0.1099
Val metric mean prob: 0.1743
Best metric at: 0.5028 0.4080  0.7093
Cf: [[4634   28]
 [  61   45]]
Valid loss:0.1229
Val metric mean prob: 0.1508
Best metric at: 0.5081 0.3980  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1239
Val metric mean prob: 0.1501
Best metric at: 0.5081 0.4020  0.7183
Cf: [[4630   32]
 [  59   47]]
Valid loss:0.1156
Val metric mean prob: 0.1629
Best metric at: 0.5000 0.4060  0.7092
Cf: [[4633   29]
 [  61   45]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1921
Best metric at epoch 1: 0.0000 0.0000  0.0000
Cf: None
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1921
Best metric at epoch 1: 0.0000 0.0000  0.0000
Cf: None
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1921
Best metric at epoch 1: 0.0000 0.0000  0.0000
Cf: None
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1921
Best metric at epoch 1: 0.4851 0.0010  0.7393
Cf: [[4613   53]
 [  51   49]]
Model improve: 0.0000 -> 0.4851
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0950
Val metric mean prob: 0.2769
Best metric at epoch 1: 0.4486 0.0010  0.7200
Cf: [[4602   60]
 [  58   48]]
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0950
Val metric mean prob: 0.2769
Best metric at epoch 1: 0.4653 0.0010  0.7164
Cf: [[4613   49]
 [  59   47]]
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0950
Val metric mean prob: 0.2769
Best metric at epoch 1: 0.4286 0.0010  0.6541
Cf: [[4647   15]
 [  73   33]]
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0950
Val metric mean prob: 0.2769
Best metric at epoch 1: 0.4896 0.0010  0.7175
Cf: [[4623   39]
 [  59   47]]
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0950
Val metric mean prob: 0.2769
Best metric at epoch 1: 0.5281 0.0010  0.7190
Cf: [[4637   25]
 [  59   47]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0859
Val metric mean prob: 0.2801
Best metric at epoch 1: 0.5116 0.0010  0.7170
Cf: [[4638   28]
 [  56   44]]
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Date :02/25/2023, 08:35:06
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2931
Best metric at epoch 1: 0.5031 0.0010  0.7220
Cf: [[4640   31]
 [  50   41]]
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2931
Best metric at epoch 1: 0.5290 0.0010  0.7228
Cf: [[4648   23]
 [  50   41]]
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0950
Val metric mean prob: 0.2769
Best metric at epoch 1: 0.5222 0.0010  0.7188
Cf: [[4635   27]
 [  59   47]]
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 46596
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0812
Val metric mean prob: 0.2533
Best metric at epoch 1: 0.4588 0.0010  0.6881
Cf: [[4633   29]
 [  63   39]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1914
Best metric at epoch 1: 0.4819 0.0010  0.6972
Cf: [[4640   26]
 [  60   40]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1914
Best metric at epoch 1: 0.4881 0.0010  0.7021
Cf: [[4639   27]
 [  59   41]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1914
Best metric at epoch 1: 0.5202 0.0010  0.7220
Cf: [[4638   28]
 [  55   45]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1914
Best metric at epoch 1: 0.5029 0.0010  0.7120
Cf: [[4638   28]
 [  57   43]]
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0950
Val metric mean prob: 0.2769
Best metric at epoch 1: 0.5281 0.0010  0.7190
Cf: [[4637   25]
 [  59   47]]
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2931
Best metric at epoch 1: 0.5031 0.0010  0.7220
Cf: [[4640   31]
 [  50   41]]
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 46596
Len valid df: 10879
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0812
Val metric mean prob: 0.2533
Best metric at epoch 1: 0.4598 0.0010  0.6926
Cf: [[4630   32]
 [  62   40]]
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 1000
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 1000
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 1000
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0750
Val metric mean prob: 0.3599
Best metric at epoch 1: 0.5263 0.0010  0.7060
Cf: [[425   2]
 [  7   5]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 1000
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0750
Val metric mean prob: 0.3599
Best metric at epoch 1: 0.7500 0.2860  0.8715
Cf: [[424   3]
 [  3   9]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0859
Val metric mean prob: 0.2676
Best metric at epoch 1: 0.4941 0.3360  0.7070
Cf: [[4638   28]
 [  58   42]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 1000
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 1000
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 1000
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 1000
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 1000
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 400
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0859
Val metric mean prob: 0.2676
Best metric at epoch 1: 0.4941 0.3360  0.7070
Cf: [[4638   28]
 [  58   42]]
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2905
Best metric at epoch 1: 0.5248 0.4750  0.7019
Cf: [[4658   13]
 [  54   37]]
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2931
Best metric at epoch 1: 0.5325 0.4270  0.7229
Cf: [[4649   22]
 [  50   41]]
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2931
Best metric at epoch 1: 0.5031 0.0010  0.7220
Cf: [[4640   31]
 [  50   41]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0859
Val metric mean prob: 0.2801
Best metric at epoch 1: 0.5116 0.0010  0.7170
Cf: [[4638   28]
 [  56   44]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1914
Best metric at epoch 1: 0.5029 0.0010  0.7120
Cf: [[4638   28]
 [  57   43]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1914
Best metric at epoch 1: 0.5029 0.0010  0.7120
Cf: [[4638   28]
 [  57   43]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1876
Best metric at epoch 1: 0.4651 0.0010  0.6966
Cf: [[4634   32]
 [  60   40]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1876
Best metric at epoch 1: 0.4773 0.4460  0.7064
Cf: [[4632   34]
 [  58   42]]
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0950
Val metric mean prob: 0.2665
Best metric at epoch 1: 0.4925 0.3950  0.7264
Cf: [[4618   44]
 [  57   49]]
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2905
Best metric at epoch 1: 0.5248 0.4750  0.7019
Cf: [[4658   13]
 [  54   37]]
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2931
Best metric at epoch 1: 0.5325 0.4270  0.7229
Cf: [[4649   22]
 [  50   41]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1914
Best metric at epoch 1: 0.5287 0.4610  0.7270
Cf: [[4638   28]
 [  54   46]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1914
Best metric at epoch 1: 0.5029 0.0010  0.7120
Cf: [[4638   28]
 [  57   43]]
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0950
Val metric mean prob: 0.2769
Best metric at epoch 1: 0.5222 0.0010  0.7188
Cf: [[4635   27]
 [  59   47]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1914
Best metric at epoch 1: 0.5287 0.0010  0.7270
Cf: [[4638   28]
 [  54   46]]
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2931
Best metric at epoch 1: 0.5091 0.0010  0.7273
Cf: [[4639   32]
 [  49   42]]
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2905
Best metric at epoch 1: 0.4970 0.0010  0.7217
Cf: [[4638   33]
 [  50   41]]
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2931
Best metric at epoch 1: 0.5031 0.0010  0.7220
Cf: [[4640   31]
 [  50   41]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1914
Best metric at epoch 1: 0.5202 0.0010  0.7220
Cf: [[4638   28]
 [  55   45]]
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0950
Val metric mean prob: 0.2769
Best metric at epoch 1: 0.5251 0.0010  0.7189
Cf: [[4636   26]
 [  59   47]]
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2931
Best metric at epoch 1: 0.5122 0.0010  0.7275
Cf: [[4640   31]
 [  49   42]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0859
Val metric mean prob: 0.2801
Best metric at epoch 1: 0.5087 0.0010  0.7169
Cf: [[4637   29]
 [  56   44]]
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 46502
Len valid df: 10979
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.1057
Val metric mean prob: 0.1914
Best metric at epoch 1: 0.5202 0.0010  0.7220
Cf: [[4638   28]
 [  55   45]]
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0950
Val metric mean prob: 0.2769
Best metric at epoch 1: 0.5251 0.0010  0.7189
Cf: [[4636   26]
 [  59   47]]
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0893
Val metric mean prob: 0.2931
Best metric at epoch 1: 0.5122 0.0010  0.7275
Cf: [[4640   31]
 [  49   42]]
Date :02/26/2023, 01:42:59
Date :02/26/2023, 01:42:59
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
seed: 1
5 fold
5 fold
Fold: 0
Fold: 0
Model name: tf_efficientnetv2_b2
Model name: tf_efficientnetv2_b2
Len train df: 52364
Len train df: 52364
Len valid df: 5471
Len valid df: 5471
Date :02/26/2023, 01:43:09
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 52364
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0937
Val metric mean prob: 0.3532
Best metric at epoch 1: 0.5349 0.0010  0.7317
Cf: [[2320   14]
 [  26   23]]
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 52358
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 52364
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0683
Val metric mean prob: 0.3252
Best metric at epoch 1: 0.6047 0.0010  0.7629
Cf: [[2323   11]
 [  23   26]]
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 52358
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0870
Val metric mean prob: 0.2690
Best metric at epoch 1: 0.4368 0.0010  0.6861
Cf: [[2315   18]
 [  31   19]]
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 52358
Len valid df: 5471
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 52358
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0887
Val metric mean prob: 0.2603
Best metric at epoch 1: 0.4828 0.0010  0.7066
Cf: [[2317   16]
 [  29   21]]
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 52362
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 52362
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0791
Val metric mean prob: 0.2574
Best metric at epoch 1: 0.4651 0.0010  0.7004
Cf: [[2316   17]
 [  29   20]]
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 52362
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0791
Val metric mean prob: 0.2620
Best metric at epoch 1: 0.4651 0.0010  0.7004
Cf: [[2316   17]
 [  29   20]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 52364
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0937
Val metric mean prob: 0.3531
Best metric at epoch 1: 0.5116 0.0010  0.7213
Cf: [[2319   15]
 [  27   22]]
seed: 1
5 fold
Fold: 0
Model name: tf_efficientnetv2_b2
Len train df: 52364
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Valid loss:0.0937
Val metric mean prob: 0.3531
Best metric at epoch 1: 0.5570 0.4400  0.7228
Cf: [[2326    8]
 [  27   22]]
Date :02/26/2023, 02:39:10
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 3
Model name: tf_efficientnetv2_b2
Len train df: 46626
Len valid df: 10891
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
tta with quantile
Valid loss:0.0893
Val metric mean prob: 0.2905
Best metric at epoch 1: 0.5248 0.4750  0.7019
Cf: [[4658   13]
 [  54   37]]
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len valid df: 11012
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Date :02/26/2023, 02:46:47
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 1
Model name: tf_efficientnetv2_b2
Len train df: 52362
Len valid df: 5470
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
tta with quantile
Valid loss:0.0791
Val metric mean prob: 0.2620
Best metric at epoch 1: 0.4815 0.2380  0.7582
Cf: [[2300   33]
 [  23   26]]
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 52358
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 52358
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
tta with quantile
Valid loss:0.0887
Val metric mean prob: 0.2559
Best metric at epoch 1: 0.4948 0.2450  0.7351
Cf: [[2310   23]
 [  26   24]]
Date :02/27/2023, 00:58:50
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 52358
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
tta with quantile
seed: 1
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 52358
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
tta with quantile
5 fold
Fold: 2
Model name: tf_efficientnetv2_b2
Len train df: 52358
Len valid df: 5471
Train bs: 16
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
Warmup: 1
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Date :02/27/2023, 01:10:43
Date :02/27/2023, 01:10:43
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
train transformCompose([
  VerticalFlip(always_apply=False, p=0.5),
  ColorJitter(always_apply=False, p=0.5, brightness=[0.8, 1.2], contrast=[0.8, 1.2], saturation=[0.8, 1.2], hue=[-0.2, 0.2]),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit_x=(-0.0625, 0.0625), shift_limit_y=(-0.0625, 0.0625), scale_limit=(-0.050000000000000044, 0.050000000000000044), rotate_limit=(-10, 10), interpolation=1, border_mode=4, value=None, mask_value=None, rotate_method='largest_box'),
  HorizontalFlip(always_apply=False, p=0.5),
  Cutout(always_apply=False, p=0.5, num_holes=1, max_h_size=409, max_w_size=409),
  ToTensorV2(always_apply=True, p=1.0, transpose_mask=False),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})
seed: 1
seed: 1
5 fold
5 fold
Fold: 2
Fold: 2
Model name: tf_efficientnetv2_b2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len train df: 46421
Len valid df: 11012
Len valid df: 11012
Train bs: 16
Train bs: 16
ModelOld
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
total_epoch :15
Warmup: 1
Warmup: 1
tta with quantile
tta with quantile
5 fold
5 fold
Fold: 2
Fold: 2
Model name: tf_efficientnetv2_b2
Model name: tf_efficientnetv2_b2
Len train df: 46421
Len train df: 46421
Len valid df: 11012
Len valid df: 11012
Train bs: 16
Train bs: 16
ModelOld
ModelOld
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0004
)
total_epoch :15
total_epoch :15
Warmup: 1
Warmup: 1
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
Epoch: 1/15
